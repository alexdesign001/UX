<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Custom Controls in Win32 API: Encapsulation of Customized Controls - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/Main.css">

    <script src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/amp4ads-host-v0.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/osd.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pubads_impl_modern_rendering_2019112101.js"></script><script async="" type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/jquery-2.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Few techniques for getting rid of customized-control-specific code from parent window procedure.">
<meta name="Keywords" content="C, Windows, Win32, Win64, Dev,Windows API,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Martin Mitáš">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/Custom-Controls-in-Win-API-Encapsulation-of-Cust.htm">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">
<meta property="og:title" content="Custom Controls in Win32 API: Encapsulation of Customized Controls">
<meta property="og:description" content="Few techniques for getting rid of customized-control-specific code from parent window procedure.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust"
   },
  "headline": "Custom Controls in Win32 API: Encapsulation of Customized Controls",
  "url": "https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust",
  "discussionUrl": "https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C,Windows,Win32,Win64,Dev",
  "commentCount": "4",
  "editor" : {
    "@type" : "Person",
    "name" : "Martin Mitáš",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Few techniques for getting rid of customized-control-specific code from parent window procedure.",
  "articleSection": "Windows API",
  "author" : [{
      "@type" : "Person",
      "name" : "Martin Mitáš",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
    }],
  "datePublished": "2014-12-11",
  "dateCreated": "2014-12-11",
  "dateModified": "2014-12-11"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.87,
    "ratingCount" : 22,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/vista/",
      "name" : "Windows API"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/ga.js"></script>


<style type="text/css"></style><link rel="preload" href="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/integrator.js" as="script"><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/integrator.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pubads_impl_modern_2019112101.js" async=""></script><link rel="prefetch" href="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/container.htm"></head>	

<body class="firefox firefox0">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,379,797 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 817" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">817</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e5d2e6ae-036a-48c4-9374-8e897a099dbe">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Dev,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=947154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=947154"  width="728px" height="90px" target="_blank"/></a></noscript><div style="height: 90px; width: 728px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-1" data-google-query-id="CJi398LLmuYCFcR8wQodeqENaA"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe style="border: 0px none; vertical-align: bottom;" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/container.htm" id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" data-is-safeframe="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/undo.png" title="Report Ad" style="z-index: 1000; position: relative; left: 0px; top: -90px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px none; padding: 0px; height: 14px; width: 14px;" align="left"></div><div style="display: none; width: 728px; height: 90px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px none;"><div class="sendReportContainer" style="padding-left: 2px; display:block; line-height:initial !important"><div style="display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial"><b>Don't like this Ad?</b></div><div class="dropzone" style="margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal" contenteditable="true">1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here</div><div style="margin-left:10px; display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option selected="selected">Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select> &nbsp;<input type="button" disabled="disabled" class="reportButton" style="padding: 0px !important" value="Report"></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/dm-logo-150x23.png" style="max-width:100%;position:absolute; right:10px; top:10px;"></a></div></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search  subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/vista/">Windows API</a> » <a href="https://www.codeproject.com/KB/vista/#General">General</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_744603_3" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?display=Print" class="tooltip" title="">
   <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="EyBH/Trbpxj5aP2LGkvGb2j8Ll5/UbHhAVEAm9eSEg0XuzfJIAFSIGio4lVt6ZAzpWPekyVR3X1qg1D+NLQPlXLkC8WPlEts1Lv5ntfESk+W66CkK33OpAsMeA+1IGear7bPtSQFokav2bVPX1sfDRFAnbpzMcnhUJoZktHvdy3WdvvnuIgOmLSmIbsZWoO4pAH+cTUtWUDh0BP5roYb2OJcyEDYaB/pxhZSVdn27xFpEzO871nm4wGlLklDWTuAorHa63oujEP3HuVBR/VQANHMq06xNmBMXNpcGhhQHciuQx4Ck9rDl7pDOVud0m5AraU4TSbKBflI7xFwjF3SpvUvSrsPTv87F1J5uLohMvQ+mNINBoLvP4M4xe9bJKgYriWGW6veOBsQPv148kCtgsW1KyQiOsgpaB3HvLwqaM9GWmgeVml24jlbmEcIXQRh1njqi2RGVPwH7ndSQqKFVZDalzM8l51shUGELrgb3fJzyBAgd5bLwFl5Z0BpDmay8i7TxSDWdeUdeC7VzQPex+ELc767IiIcErE13syHuqcaHGe25PPs8y1OSIg0E+xfjzbLN6C2ObJBzwe40jS59E4GLhIlXKqgmaxYIqRdDcutHqzXIMbddQJ1yO9Px4i9uGcaZEX/P2ldzHA4kaOekQhye4m8HzGGrtwpb0e/57K3Nh+xZaDDgJvN15F5Z6TYnCiIXtTffvIWXUJBhSP90mlIy/Ah74m5willZ+KPgDkM2v5ZVjFrzrfqWwJvJ5Q+KGvo3E1TnkQQ4hoiq++kYW27Ci0NRBdL/5kTT3Rq9MyIJKK56CSKnjo57NQK8eUUsxbJOchYnUPHpxPNquJBwV/egQn99pt8KBYEYaBU1xDEDZW7HvFgrPxm5g1ie1Sw7FfeSJeshe+fWaow07J8fs5/TTd7+ASSjFHM3T+YQwkB3G5WtbmgLztf8pYFlq/OB0GjYQolQwV5UzQ8k74bH8oPjYPsVb9FOERR3Puhm1nSS6ETZYTICtStdiKow1kYY+9DFJflt9k2ENfaqd03SDHbH9XtZDbip1VNtx4DKzM6Sjdu29EScwhTvWljhFw5/z3YU5qa6oNqpxIn0wCXGJioLlmUzIfPVlHctKfwlLg5YJ8gP8xn++0p/BqQlCul/fDB+lfVi37GBx5NgN7Jn0bF9LV/2rU6hzrIjMUuNB0Ql0XPooOAoBZAyWLbRhlBSWCCA/rbuSr8E5kP8J3KIzd7pewIXziiJyIsFKqXmZngVvyv9EoPDnKlmpgr60plrbCbrKZoJMxZA/MEAWRsAmo0uGM4l/Zvbjqaeex/Py9IQtigD6RTt13L311K2pT6Hkd/p+H17CH9H8DoQQLgBNvhIMKnaKQzwm883X2Ivzn4rx3YsQOpn/XnzrWAjKTJ8Em8RPM6cq5vVDdJp2Nu7QkSDgOeMiXmGDFouAIx90Yv9/g1oaIxBGMxU1GQHK/XSpj+EUprkrMMWgBSEGKoLL73g/yfuWf/EgJXHRaIWzDkxYeKlvSh+tDw6I3cAZkzzXcQTpu2tleAaP4AU0FsYjD7soFS/lRmL7SLS5jgmqATYqBy2aJaIwKKVf5l98mnxMjRTFHV94dr2n5JVdp7cs/O5aZAVKSavn7h2K8WHgOtRuIAtalfSmUle6pI0YDwBQUmFn4ou7Dy+2kqW8saWvDXRHGteWwXOO0yfzahnEuNMum4aDYGeIPCk6TOZtSvnKOpBEPyCsmM3IUAh2euxP8U9RZZrq4uVVOX+LJ7S+lohimYoJZFechhEmu5VCSDIkt5w6bqZgkU+uevds/oCvaJcED2gKyPIkACcD0EBizWP0XmkMiQjGusp870KczYTLqmx4PN1ocjphUUvjbOvaUy1QpMmuNUr9mQDpFajJBczqmsIkC+nDtPmxZ8yqIZU+1ib94OZcraW8XuzdVkM5o9cX1fPzyMVMVNdM6Fuv5NTVGkb1h3qd2U4azbX2gHMldX6fjOMsT3wh9TK2WuNe+2YI6rWGPX2mMB3vQM96bnTLG4owlFZxjeJYOjsjOFxv7YF2Fm2nw1MyvVzbnDLZACYoRFF2YQ7tTrOlfX+vkIJWKH/28DUVT6xltTtVrbOLq+PupJ5mCUD3wOiX53zBjxU7uTV21+9+IgFx6oToj4GXxgnXONhBZw5I9aAJot8m+zQej29KWVpVuZk+8eWk8xLCHQeZzDBcHIQFckTq2++aC3hSCo/IJ5LfQBpUG3vrumUtue836uiwaLapTWVxbJ0bx3TcnFhjKFdp5+9Yr36QoxWpNR9ykeS7bOpS1mMeFbgYG0aySiRaWrVT54O6sgkZhh88DwH1PiEQbuTIXWvGKctSHR92G7AG2fQhjKHnUkFujJ/V3+cLsSXQA0kSJnh14I9ut5heD0DagZXt8R24TBXTsmiR/KZT6P+F44byFOp0Vi9S8IEsF7CT2Nzt6K6jI2KyfkaCF4ORX4OXFoCjP8C4W090zrH/NP6aJ+bilQyx90wiNiMnqkP6Q6heCIMMLdqWgygUPngsmAc5xyT/nnUPi4nq73zyZgXWjCuyjS1y9LAwyNkrqi1zk15fGZn63boREX/PWf1ogYov98tAT0R4GUR0Mns/7622qPFK8SAJqsH5f1EB6yK9cVt13eo8cXnbwM/KuDGr2l8uHiwmpn7GCxxeMBKMrYsmO5Vp4ADP+JzRc5lMvD1uAqVL8XmEn0pHKUyQnMDnghx/8qZXS1ohW11ac1CWzlNUaCWnqNsmrCuv6kHHkSfbN/BynsCrpdr15QUnUxltTwsLYAaoMKS7Lj/9TGR9KMR9HaKec1bs3PjhU6ou6xgP6oXe9Adc/h5iyq3V7Mkefvwxf4BzvL">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Custom Controls in Win32 API: Encapsulation of Customized Controls</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" id="ctl00_avatar" class="avatar">

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385" rel="author">Martin Mitáš</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_744603">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="22">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:116px;height:24px;" class="clipped align-left float-left"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:4px;height:24px;position:relative" class="clipped"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.87  (22 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.87  (22 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">11 Dec 2014</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Few techniques for getting rid of customized-control-specific code from parent window procedure.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<h2>Articles in this series</h2>

<ul>
	<li><a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">Custom Controls in Win32 API: The Basics</a></li>	<li><a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">Custom Controls in Win32 API: The Painting</a></li>	<li><a href="http://www.codeproject.com/Articles/620045/Custom-Controls-in-Win32-API-Visual-Styles">Custom Controls in Win32 API: Visual Styles</a></li>	<li><a href="http://www.codeproject.com/Articles/624495/Custom-Controls-in-Win32-API-Standard-Messages">Custom Controls in Win32 API: Standard Messages</a></li>	<li><a href="http://www.codeproject.com/Articles/646482/Custom-Controls-in-Win-API-Control-Customization">Custom Controls in Win32 API: Control Customization</a></li>	<li>Custom Controls in Win32 API: Encapsulation of Customized Controls</li>	<li><a href="http://www.codeproject.com/Articles/1042516/Custom-Controls-in-Win-API-Scrolling">Custom Controls in Win32 API: Scrolling</a></li></ul>

<h2>Introduction</h2>

<p><a href="http://www.codeproject.com/Articles/646482/Custom-Controls-in-Win-API-Control-Customization">The last time</a>,
 we have discussed some techniques for customization of controls. 
However we saw that more or less all the techniques require some level 
of direct cooperation between the code customizing the control and the 
procedure of the parent window (usually the dialog or top-level window).
 If you briefly take a look on the customization techniques presented in
 the previous article, you can see that owner drawing, custom drawing 
and notifications even require by design an active cooperation of the 
parent window procedure.</p>

<p>At the first glance, superclassing and subclassing look better from 
this point of view. But in practice, complex customization need to 
follow changes in the underlying control logic. For example, if the 
superclassed or subclassed control overrides <code>WM_PAINT</code>, it 
may need to be informed when internal state of the control changes so it
 can paint the control in the right way. Usually the underlying control 
informs the world by sending the notification to its parent window, so 
the easiest solution is to catch the notification in the parent and 
resend it back to the customized control so it's customized window 
procedure can handle it. Hence even superclassing and subclassing share 
the problem as well.</p>

<p>That has a fundamental impact: Reuse of such controls in other 
dialogs or applications is more complicated, as the logic from the 
parent window needs to be reimplemented in new one. Hence, we will try 
to address this problem in this article.</p>

<p>Software engineers already recognized many years ago that 
encapsulation of logically related code is a desired property of a 
reusable code. In OOP (object-oriented programming) paradigm, the 
encapsulation is even one of the most important and central points. The 
encapsulation allows to easily take the reusable code and reuse it in 
other module of the application, or even outside of it (e.g. to a 
standalone library, so it can even be reused in other applications). It 
is also much easier to read, review and maintain such code, as it allows
 a reader to mentally split the application code into smaller, palatable
 bits.</p>

<p>Although OOP guides and manuals speak mainly about classes, I believe
 the concept is very valuable on all application design levels: When 
breaking the application into the core program and set of libraries, 
when splitting the code into source files with understandable public 
interface and, in our context, also the customized controls.</p>

<p>I do not say that encapsulating every Win32 control you ever 
customize is a good idea. If you have a single instance of a customized 
control in your application, the given control is logically bound to the
 parent window and you know you will never need to reuse the control 
elsewhere, feel free to be lazy. Actually the encapsulation code could 
be more complex then the customization itself and it may not be worth of
 the gains.</p>

<p>But if your customized control needs to be reused in multiple 
dialogs, if its handling in parent window's code is complex, if the 
dialog procedure is complicated on its own, if your dialog procedure 
needs to understand internal details of logic in the control although it
 has nothing to do with the higher logic of the application, then the 
encapsulation may provide you interesting benefits.</p>

<p>So, what does the encapsulation for the customized control actually 
means? It means that every logic we want to mentally understand as an 
implementation of the control, goes out from the parent window 
procedure, that it is separated from it. If you once more take a look on
 all customization techniques presented in the previous article, you may
 notice that the parent window procedure actually has to handle some 
notifications sent by the customized control.</p>

<h2>Wrapper Window</h2>

<p>The obvious solution of the problem is to wrap the customized control
 in another window, wrapping the control to the outside world.</p>

<p>The wrapper window is parent of the core control we customize and it 
implements all the stuff which has to be in parent window procedure of a
 customized control. I.e. it tracks the notifications from the 
customized control (the original control procedure) and it can also 
cooperate tightly with the subclass or superclass procedure.</p>

<p>To the outside world, the wrapper simply <b>is</b> the control. From 
point of the view if the application, the child of the wrapper which 
does majority of the work is just an implementation detail of the 
control and the application should not care about it at all.</p>

<p>So the wrapper actually serves as a proxy between the application 
(the dialog procedure) and the core control (the child window). I.e. the
 wrapper has to understand all messages which constitute the public API 
of the customized control and (in most cases) it re-sends them to the 
child. Similarly, the wrapper resends all publicly visible notifications
 sent by the child up to application.</p>

<p>As straightforward as this approach is, it is also somewhat clumsy 
and inelegant: The existence of the wrapper just means an unnecessary 
layer of indirection in your application, which eats some system 
resources associated with <code>HWND</code> handle, yet it actually does
 no useful work with the exception of some wiring. Additionally it makes
 the tree hierarchy of all windows one level deeper, which may impose 
some negative implications for utilities looking at the hierarchy via 
Windows Automation API or Accessibility API.</p>

<h2>Message Reflection</h2>

<p>Better way how to deal with that problem is resending the 
notifications (and other notification-like messages) from the dialog 
procedure back to the control itself and handle them directly in 
superclass or subclass procedure instead of the wrapper window. In the 
world of Win32 development, this technique is so common that it has its 
own name: message reflection.</p>

<p>The Win32API header <tt>olectl.h</tt> contains the following preprocessor macro definitions:</p>

<div class="pre-action-link" id="premain818427" style="width:100%;display:block;"><span id="prehide818427" onclick="processCodeBlocks.togglePre(818427);">Hide</span>  &nbsp; <span id="copycode818427" onclick="return processCodeBlocks.copyCode(818427);">Copy Code</span></div><pre id="pre818427" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-preprocessor">#define OCM__BASE             (WM_USER+0x1c00)
</span><span class="code-preprocessor">#define OCM_COMMAND           (OCM__BASE + WM_COMMAND)
</span> 
<span class="code-preprocessor">#define OCM_CTLCOLORBTN       (OCM__BASE + WM_CTLCOLORBTN)
</span><span class="code-preprocessor">#define OCM_CTLCOLOREDIT      (OCM__BASE + WM_CTLCOLOREDIT)
</span><span class="code-preprocessor">#define OCM_CTLCOLORDLG       (OCM__BASE + WM_CTLCOLORDLG)
</span><span class="code-preprocessor">#define OCM_CTLCOLORLISTBOX   (OCM__BASE + WM_CTLCOLORLISTBOX)
</span><span class="code-preprocessor">#define OCM_CTLCOLORMSGBOX    (OCM__BASE + WM_CTLCOLORMSGBOX)
</span><span class="code-preprocessor">#define OCM_CTLCOLORSCROLLBAR (OCM__BASE + WM_CTLCOLORSCROLLBAR)
</span><span class="code-preprocessor">#define OCM_CTLCOLORSTATIC    (OCM__BASE + WM_CTLCOLORSTATIC)
</span> 
<span class="code-preprocessor">#define OCM_DRAWITEM          (OCM__BASE + WM_DRAWITEM)
</span><span class="code-preprocessor">#define OCM_MEASUREITEM       (OCM__BASE + WM_MEASUREITEM)
</span><span class="code-preprocessor">#define OCM_DELETEITEM        (OCM__BASE + WM_DELETEITEM)
</span><span class="code-preprocessor">#define OCM_VKEYTOITEM        (OCM__BASE + WM_VKEYTOITEM)
</span><span class="code-preprocessor">#define OCM_CHARTOITEM        (OCM__BASE + WM_CHARTOITEM)
</span><span class="code-preprocessor">#define OCM_COMPAREITEM       (OCM__BASE + WM_COMPAREITEM)
</span><span class="code-preprocessor">#define OCM_HSCROLL           (OCM__BASE + WM_HSCROLL)
</span><span class="code-preprocessor">#define OCM_VSCROLL           (OCM__BASE + WM_VSCROLL)
</span><span class="code-preprocessor">#define OCM_PARENTNOTIFY      (OCM__BASE + WM_PARENTNOTIFY)
</span><span class="code-preprocessor">#define OCM_NOTIFY            (OCM__BASE + WM_NOTIFY)</span></pre>

<p>As you can see, all Win32API notification and notification-like messages do have its counterpart with the <tt>OCM_</tt> prefix, whose numeric ID is increased by <code>OCM__BASE</code>.</p>

<p>Using these macros, implementing the message reflection in your parent window procedure is then quite straightforward:</p>

<ol>
	<li>The parent window's code needs to handle the standard <code>WM_xxxx</code> messages in the list above.</li>	<li>If
 the message is sent by a customized control who wants to handle the 
message itself, the parent window needs to send the corresponding <code>OCM_xxxx</code> message (with the original <code>WPARAM</code> and <code>LPARAM</code> values) to the control.</li>	<li>The superclass or subclass procedure of the control should handle the <code>OCM_xxxx</code> message, or just return zero.</li></ol>

<p>The only unclear thing may be the point 2: How can the parent know 
which controls expect some messages to be reflected? In simple dialogs 
with few controls, you can simply know IDs of few controls which need 
such treatment and hardcode them in the parent's procedure.</p>

<p>But there is also simple generic way: Assuming all the control are well-designed and they reserve the range of listed <code>OCM_xxxx</code>
 for the purpose of message reflection, the parent may by default resend
 all such messages to any control when it has no better idea what to do 
with the message. (Note that reserving the range 0x2000 (<code>OCM_BASE</code>) through 0x23ff (<code>OCM_BASE+WM_USER-1</code>) was suggested in <a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">Custom Controls in Win32 API: The Basics</a>.)</p>

<p>When sent to such polite uncustomized control which does not handle the <code>OCM_xxxx</code> messages, it is just passed to <code>DefWindowProc()</code>. That function has no idea what to do with <code>OCM_xxxx</code> messages, so it does nothing and just returns zero.</p>

<p>Below is a code snippet showing how the reflection can be handled. 
Surely, the reflection could be scattered in all relevant message 
handlers directly, but the code below isolates the reflection to a 
single place, the <code>DefParentProc()</code>, which is our wrapper of standard <code>DefWindowProc()</code>, and which can be reused by all parent window procedures in your application.</p>

<div class="pre-action-link" id="premain982196" style="width:100%;display:block;"><span id="prehide982196" onclick="processCodeBlocks.togglePre(982196);">Hide</span>  &nbsp; <span id="preShrink982196" onclick="processCodeBlocks.shrinkExpand(982196);">Shrink</span> <img id="preimg982196" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(982196);">  &nbsp; <span id="copycode982196" onclick="return processCodeBlocks.copyCode(982196);">Copy Code</span></div><pre id="pre982196" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">olectl.h</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-keyword">static</span> LRESULT
DefParentProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-keyword">case</span> WM_NOTIFY:
        {
            NMHDR* nmhdr = (NMHDR*) lParam;
            <span class="code-keyword">if</span>(nmhdr-&gt;hwndFrom != NULL)
                <span class="code-keyword">return</span> SendMessage(nmhdr-&gt;hwndFrom, uMsg + OCM__BASE, wParam, lParam);
            <span class="code-keyword">break</span>;
        }

        <span class="code-comment">//</span><span class="code-comment"> All of these provide the control's HHWND in LPARAM</span>
        <span class="code-keyword">case</span> WM_COMMAND:
        <span class="code-keyword">case</span> WM_CTLCOLORBTN:
        <span class="code-keyword">case</span> WM_CTLCOLOREDIT:
        <span class="code-keyword">case</span> WM_CTLCOLORDLG:
        <span class="code-keyword">case</span> WM_CTLCOLORLISTBOX:
        <span class="code-keyword">case</span> WM_CTLCOLORMSGBOX:
        <span class="code-keyword">case</span> WM_CTLCOLORSCROLLBAR:
        <span class="code-keyword">case</span> WM_CTLCOLORSTATIC:
        <span class="code-keyword">case</span> WM_VKEYTOITEM:
        <span class="code-keyword">case</span> WM_CHARTOITEM:
            <span class="code-keyword">if</span>(lParam != <span class="code-digit">0</span>)
               <span class="code-keyword">return</span> SendMessage((HWND) lParam, uMsg + OCM__BASE, wParam, lParam);
            <span class="code-keyword">break</span>;

        <span class="code-comment">//</span><span class="code-comment"> All of these provide ID of the control in WPARAM:</span>
        <span class="code-keyword">case</span> WM_DRAWITEM:
        <span class="code-keyword">case</span> WM_MEASUREITEM:
        <span class="code-keyword">case</span> WM_DELETEITEM:
        <span class="code-keyword">case</span> WM_COMPAREITEM:
            <span class="code-keyword">if</span>(wParam != <span class="code-digit">0</span>) {
                HWND hwndControl = GetDlgItem(hwnd, wParam);
                <span class="code-keyword">if</span>(hwndControl)
                    <span class="code-keyword">return</span> SendMessage(hwndControl, uMsg + OCM__BASE, wParam, lParam);
            }
            <span class="code-keyword">break</span>;

         <span class="code-comment">//</span><span class="code-comment"> Note we do not reflect WM_PARENTNOTIFY -&gt; OCM_PARENTNOTIFY as that </span>
         <span class="code-comment">//</span><span class="code-comment"> usually does not make much sense.</span>
     }
     
     <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}

LRESULT CALLBACK
MainWinProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-keyword">case</span> WM_COMMAND:
            <span class="code-keyword">switch</span>(HIWORD(wParam)) {
                <span class="code-keyword">case</span> ID_SOMECONTROL:
                    ...  <span class="code-comment">//</span><span class="code-comment"> Handle some control explicitly</span>
                    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
                <span class="code-keyword">case</span> ID_OTHERCONTROL:
                    ...  <span class="code-comment">//</span><span class="code-comment"> Handle other control explicitly</span>
                    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
            }
            <span class="code-keyword">break</span>;  <span class="code-comment">//</span><span class="code-comment"> Propagate the message into DefParentProc() below.</span>

        <span class="code-keyword">case</span> WM_NOTIFY:
            <span class="code-keyword">switch</span>(wParam) {
                <span class="code-keyword">case</span> ID_SOMECONTROL:
                    ...  <span class="code-comment">//</span><span class="code-comment"> Handle some control explicitly</span>
                    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
                <span class="code-keyword">case</span> ID_OTHERCONTROL:
                    ...  <span class="code-comment">//</span><span class="code-comment"> Handle other control explicitly</span>
                    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
            }
            <span class="code-keyword">break</span>;  <span class="code-comment">//</span><span class="code-comment"> Propagate the message into DefParentProc() below.</span>

    
        ... <span class="code-comment">//</span><span class="code-comment"> and so one for all messages the parent needs to handle explicitly</span>
    }

    <span class="code-comment">//</span><span class="code-comment"> Pass unhandled messages into DefParentProc()</span>
    <span class="code-keyword">return</span> DefParentProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Injected Message Reflection</h2>

<p>Strictly speaking, the message reflection, as presented in the 
previous section, does not reach full code encapsulation. Although it 
can be realized in a generic way, the parent still has to provide some 
cooperation with the child controls (i.e. perform the reflection).</p>

<p>When the parent window procedure is not under our direct control, or 
when requirements for re-usability of the control are so high you want 
to avoid need for any special treatment of the control in parent window 
procedure, we ned to be able to get the notifications from the original 
control procedure in the customization (superclass or subclass) 
procedure.</p>

<p>With some more work, that can be achieved. And it may be achieved 
with technique you should already know from the previous article: The 
subclassing. The control may, during its creation (<code>WM_NCCREATE</code>), customize its parent window and force it to do the reflection.</p>

<p>However we need to be careful: We cannot blindly reflect messages for
 all child controls as we do not have any idea what the parent procedure
 handles and what it does not as we do not want to clash with it. In 
example below, we solve this by keeping a list of controls for which to 
do the reflection. The parent subclass procedure consults the list and 
if the <code>HWND</code> is present, it does the reflection instead of calling the original window procedure.</p>

<p>This has one side effect: The parent window cannot override the 
behavior, but arguably, it may even be an advantage: The customized 
control sees the notifications sent by the underlying original control 
and parent cannot break its logic in any way.</p>

<div class="pre-action-link" id="premain706827" style="width:100%;display:block;"><span id="prehide706827" onclick="processCodeBlocks.togglePre(706827);">Hide</span>  &nbsp; <span id="preShrink706827" onclick="processCodeBlocks.shrinkExpand(706827);">Shrink</span> <img id="preimg706827" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(706827);">  &nbsp; <span id="copycode706827" onclick="return processCodeBlocks.copyCode(706827);">Copy Code</span></div><pre id="pre706827" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">olectl.h</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-comment">//</span><span class="code-comment"> A container keeping list of the HWND handles for controls which need the message reflection.</span>
<span class="code-comment">//</span><span class="code-comment"> (Its implementation is left to the reader as an exercise.)</span>
<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> { ... } CONTROL_LIST;

CONTROL_LIST* ControlListCreate(<span class="code-keyword">void</span>);
<span class="code-keyword">void</span> ControlListDestroy(CONTROL_LIST* pList);
BOOL ControlListAppend(CONTROL_LIST* pList, HWND hWnd);
<span class="code-keyword">void</span> ControlListRemove(CONTROL_LIST* pList, HWND hWnd);
BOOL ControlListContains(CONTROL_LIST* pList, HWND hWnd);
BOOL ControlListEmpty(CONTROL_LIST* pList);

<span class="code-comment">//</span><span class="code-comment"> Parent window subclass procedure. For messages which may need the reflection, it consults</span>
<span class="code-comment">//</span><span class="code-comment"> the list of controls and, according to the result, it either does the reflection or calls</span>
<span class="code-comment">//</span><span class="code-comment"> the original parent window procedure.</span>
<span class="code-keyword">static</span> LRESULT CALLBACK
ParentSubclassProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam, UINT_PTR uIdSubclass, DWORD_PTR dwData)
{
    CONTROL_LIST* pControlList = (CONTROL_LIST*) dwData;
    UINT i;

    <span class="code-comment">//</span><span class="code-comment"> Reflect the message (if needed):</span>
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-keyword">case</span> WM_NOTIFY:
        {
            NMHDR* nmhdr = (NMHDR*) lParam;

            <span class="code-keyword">if</span>(ControlListContains(pControlList, nmhdr-&gt;hwndFrom))
                <span class="code-keyword">return</span> SendMessage(nmhdr-&gt;hwndFrom, uMsg + OCM__BASE, wParam, lParam);
            <span class="code-keyword">break</span>;
        }

        <span class="code-comment">//</span><span class="code-comment"> All of these provide the control's HHWND in LPARAM</span>
        <span class="code-keyword">case</span> WM_COMMAND:
        <span class="code-keyword">case</span> WM_CTLCOLORBTN:
        <span class="code-keyword">case</span> WM_CTLCOLOREDIT:
        <span class="code-keyword">case</span> WM_CTLCOLORDLG:
        <span class="code-keyword">case</span> WM_CTLCOLORLISTBOX:
        <span class="code-keyword">case</span> WM_CTLCOLORMSGBOX:
        <span class="code-keyword">case</span> WM_CTLCOLORSCROLLBAR:
        <span class="code-keyword">case</span> WM_CTLCOLORSTATIC:
        <span class="code-keyword">case</span> WM_VKEYTOITEM:
        <span class="code-keyword">case</span> WM_CHARTOITEM:
            <span class="code-keyword">if</span>(ControlListContains(pControlList, (HWND) lParam)
                <span class="code-keyword">return</span> SendMessage((HWND) lParam, uMsg + OCM__BASE, wParam, lParam);
            <span class="code-keyword">break</span>;

        <span class="code-comment">//</span><span class="code-comment"> All of these provide ID of the control in WPARAM:</span>
        <span class="code-keyword">case</span> WM_DRAWITEM:
        <span class="code-keyword">case</span> WM_MEASUREITEM:
        <span class="code-keyword">case</span> WM_DELETEITEM:
        <span class="code-keyword">case</span> WM_COMPAREITEM:
            <span class="code-keyword">if</span>(wParam != <span class="code-digit">0</span>) {
                HWND hwndControl = GetDlgItem(hwnd, wParam);
                <span class="code-keyword">if</span>(ControlListContains(pControlList, hwndControl)
                    <span class="code-keyword">return</span> SendMessage(hwndControl, uMsg + OCM__BASE, wParam, lParam);
            }
            <span class="code-keyword">break</span>;

        <span class="code-comment">//</span><span class="code-comment"> Note we do not reflect WM_PARENTNOTIFY -&gt; OCM_PARENTNOTIFY as that </span>
        <span class="code-comment">//</span><span class="code-comment"> usually does not make much sense.</span>
    }

    <span class="code-comment">//</span><span class="code-comment"> If not reflected, call the original parent procedure:</span>
    <span class="code-keyword">return</span> DefSubclassProc(hWnd, uMsg, wParam, lParam);
}

<span class="code-comment">//</span><span class="code-comment"> The implementation of the customized control. </span>
<span class="code-comment">//</span><span class="code-comment"> Note that on creation/destruction we update the list of controls that need the message</span>
<span class="code-comment">//</span><span class="code-comment"> reflection and also we make sure that the parent is subclassed for the lifetime</span>
<span class="code-comment">//</span><span class="code-comment"> of the control. The subclass then does the reflection for us.</span>
<span class="code-keyword">static</span> LRESULT CALLBACK
ControlSuperclassProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-keyword">case</span> WM_NCCREATE:
        {
            CREATESTRUCT* pCs = (CREATESTRUCT*) lParam;
            CONTROL_LIST* pControlList;

            <span class="code-comment">//</span><span class="code-comment"> Ensure the parent window shall reflect notification to us:</span>
            <span class="code-keyword">if</span>(GetWindowSubclass(hWnd, ParentSubclassProc, <span class="code-digit">0</span>, (DWORD_PTR*) &amp;pControlList)) {
                <span class="code-keyword">if</span>(!ControlListAppend(pControlList, hWnd))
                    <span class="code-keyword">return</span> -<span class="code-digit">1</span>;
            } <span class="code-keyword">else</span> {
                pControlList = ControlListCreate();
                <span class="code-keyword">if</span>(pControlList == NULL)
                    <span class="code-keyword">return</span> -<span class="code-digit">1</span>;
                ControlListAppend(pControlList, hWnd);
                SetWindowSubclass(hWnd, ParentSubclassProc, <span class="code-digit">0</span>, (DWORD_PTR) pControlList);
            }

            <span class="code-comment">//</span><span class="code-comment"> Break to CallWindowProc() so the underlying control is properly </span>
            <span class="code-comment">//</span><span class="code-comment"> created and initialized:</span>
            <span class="code-keyword">break</span>;  
        }

        <span class="code-keyword">case</span> WM_NCDESTROY:
        {
            LRESULT lRes;
            CONTROL_LIST* pControlList;

            lRes = CallWindowProc(lpfnOriginalProc, hWnd, uMsg, wParam, lParam);

            GetWindowSubclass(hWnd, ParentSubclassProc, <span class="code-digit">0</span>, (DWORD_PTR*) &amp;pControlList);
            ControlListRemove(pControlList, hWnd);
            <span class="code-keyword">if</span>(ControlListEmpty(pControlList)) {
                ControlListDestroy(pControlList);
                RemoveWindowSubclass(GetParent(hWnd, ParentSubclassProc, <span class="code-digit">0</span>));
            }
            <span class="code-keyword">return</span> lRes;
        }

        <span class="code-comment">//</span><span class="code-comment"> Customize the underlying control as desired. We may handle the reflected </span>
        <span class="code-comment">//</span><span class="code-comment"> messages (OCM__xxx) as needed.</span>
        ....  
    }

    <span class="code-comment">//</span><span class="code-comment"> By default, propagate the message to the underlying control procedure:</span>
    <span class="code-keyword">return</span> CallWindowProc(lpfnOriginalProc, hWnd, uMsg, wParam, lParam);
}</pre>

<p>Obviously, the presented code fails if you ever attempt to reparent the control to another parent window with <code>SetWindowParent()</code>.
 Such support could be added at the cost of more complexity but, 
arguably, it is not worth of it. Especially when taking into account 
that most standard controls do not support it as explained in Raymond 
Chen's blog post <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/03/16/9979112.aspx">Why does my control send its notifications to the wrong window after I reparent it?</a>.</p>

<h2>Next Time: Scrolling Support and Non-client Area</h2>

<p>With this article we leave the topic of the control customization finally behind.</p>

<p>Next time we will take a look how to add a scrollbar support into 
your controland how to paint in a non-client area (especially with the 
respect to the visual styles). At first it may seem as two quite 
unrelated topics, but the connection does make a sense if you realize 
the scrollbars are part of the non-client area.</p>

<p>So stay tuned, this series is not yet coming to an end although the 
delay since the previous article took much more time then I anticipated.
 Hopefully the delay of the next article will be much shorter <img alt="Smile | :)" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/smiley_smile.gif" style="width: 16px; height: 16px" align="top"></p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Dev,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=947154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=947154"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Custom%20Controls%20in%20Win32%20API%3a%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Custom+Controls+in+Win32+API%3a+Encapsulation+of+Customized+Controls+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust&amp;title=Custom+Controls+in+Win32+API%3a+Encapsulation+of+Customized+Controls+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust&amp;title=Custom+Controls+in+Win32+API%3a+Encapsulation+of+Customized+Controls+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust&amp;description=Custom+Controls+in+Win32+API%3a+Encapsulation+of+Customized+Controls+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Martin-Mitas">Martin Mitáš</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            <div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowOn" class="follow">
	            
	            
	            <a href="https://www.linkedin.com/profile/view?id=88607525"><img style="vertical-align:middle;border:0;height:24px;width:24px" alt="LinkedIn" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/linkedin-32.png"></a> 
            </div>
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Team Leader</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Czech Republic <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/CZ.gif" alt="Czech Republic" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Dev,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=947154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=947154"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1874983"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust&amp;fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1874983"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f744603%2fCustom-Controls-in-Win-API-Encapsulation-of-Cust&amp;fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F5436431_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5436431xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5436431" parent="0" thread="5436431" href="https://www.codeproject.com/Messages/5436431/How-to-create-a-control-like-windows-standard-cont.aspx">How to create a control like windows standard control which can be shown on the toolbox pannel</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">viqfoai</span><span class="date">19-Sep-17  23:59</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5525897">viqfoai</a></span></td><td class="date"><span>19-Sep-17  23:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5436431_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5525897" msgid="5436431" votingtype="GoodOrBad" done="true"><a href="#xx5436431xx" onclick="return rateItem(5, 5436431,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5525897);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5436431xx" onclick="return rateItem(1, 5436431,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5525897);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I implemented my control like a table, I can create it 
with CreateCindow function like other windows standard control, but the 
class name is in the local name space. To use it with dialog, I need to 
put this control in the toolbox and drag it to the desired position on 
the dialog. Do you have some further hints on this. I looked up such 
information all over the internet, but I can not find any related 
information on such requirement<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=5436431&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=5436431&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5436431" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5436431" data-ref="3_5436431" class="rating-label" name="RateItem_5436431"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5436431/How-to-create-a-control-like-windows-standard-cont.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5436431"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5525897" msgid="5436431"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4963968_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4963968xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4963968" parent="0" thread="4963968" href="https://www.codeproject.com/Messages/4963968/How-much-do-you-use-Custom-Controls-in-Win32.aspx">How much do you use Custom Controls in Win32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ToothRobber</span><span class="date">15-Dec-14  17:22</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=193687">ToothRobber</a></span></td><td class="date"><span>15-Dec-14  17:22&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4963968_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="193687" msgid="4963968" votingtype="GoodOrBad" done="true"><a href="#xx4963968xx" onclick="return rateItem(5, 4963968,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',193687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4963968xx" onclick="return rateItem(1, 4963968,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',193687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I am interested in how much you use custom controls.<br>
<br>
Do you see people developing new Custom Controls in Win32?<br>
<br>
Robert<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4963968&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4963968&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4963968" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4963968" data-ref="3_4963968" class="rating-label" name="RateItem_4963968"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4963968/How-much-do-you-use-Custom-Controls-in-Win32.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4963968"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="193687" msgid="4963968"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4964098_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4964098xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4964098" parent="4963968" thread="4963968" href="https://www.codeproject.com/Messages/4964098/Re-How-much-do-you-use-Custom-Controls-in-Win32.aspx">Re: How much do you use Custom Controls in Win32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">16-Dec-14  5:56</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>16-Dec-14  5:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4964098_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4964098" votingtype="GoodOrBad" done="true"><a href="#xx4964098xx" onclick="return rateItem(5, 4964098,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4964098xx" onclick="return rateItem(1, 4964098,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4963968);" href="https://www.codeproject.com/Messages/4963968/How-much-do-you-use-Custom-Controls-in-Win32.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It's
 true it depends. Commercial/proprietary applications probably use more 
often some more recent technologies like MFC, ATL, WPF or Windows Forms.
 But that said, there is at least one domain where Win32 AFAIK still 
rules: Many open source project which want to provide native GUI stick 
with Win32. There are many (mutually related) reasons for that:<br>
<ul><br>
<li>Independence on single vendor of language (C#, .Net), IDE and all 
development tools: Microsoft made more capable versions of MSVC free for
 open-source development only recently and it can stop to provide it any
 time it wants. This goes that far that many projects adopt CMake so 
each developer can use other development/build tools then the others in 
the team.</li><li>Continuity: There is much lower pressure in open 
source projects to switch to "modern look" then in commercial apps who 
often have to release one major version every year (and it has to be 
visual different from older versions), on the other side it's more 
important to not waste time of participating developers. The result is 
to stick with technology the project already uses.</li><li>Ideology: 
Many open source developers believe that open source projects should be 
buildable with open source toolchain (e.g. mingw or mingw-w64).</li><li>Compatibility:
 They consider likely that whenever MS comes with yet another new 
technology, Win32 will still just work. But all .Net projects will have 
to migrate to newer and newer run-time versions and eventually perhaps 
to completely another next-generation technology.</li><li>The lowest 
possible denominator: When multiple open-source C/C++ contributors with 
different history and experience meet, it's just matter of fact (for all
 the reasons above) that likely most of them know C/C++ and Win32 API, 
rather then C#, .Net or any API which was pushed by Microsoft for few 
years.</li></ul><br>
<br>
(Please do not take this as a cause for flame war. I use all the words 
which may have negative connotation like "ideology" in strictly neutral 
meaning.)<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4964098&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4964098&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4963968" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4964098" data-ref="3_4964098" class="rating-label" name="RateItem_4964098"><span class="rating-result"><span>5.00/5 (2 votes)</span></span></span><a href="https://www.codeproject.com/Messages/4964098/Re-How-much-do-you-use-Custom-Controls-in-Win32.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4964098"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4964098"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4968200_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx4968200xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4968200" parent="4964098" thread="4963968" href="https://www.codeproject.com/Messages/4968200/Re-How-much-do-you-use-Custom-Controls-in-Win32.aspx">Re: How much do you use Custom Controls in Win32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">ToothRobber</span><span class="date">22-Dec-14  13:24</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=193687">ToothRobber</a></span></td><td class="date"><span>22-Dec-14  13:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4968200_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="193687" msgid="4968200" votingtype="GoodOrBad" done="true"><a href="#xx4968200xx" onclick="return rateItem(5, 4968200,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',193687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4968200xx" onclick="return rateItem(1, 4968200,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',193687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4964098);" href="https://www.codeproject.com/Messages/4964098/Re-How-much-do-you-use-Custom-Controls-in-Win32.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>(history)
 Just before your post came out. I was contemplating building a Common 
Control (Native GUI with Win32). The reason for this was I had several 
dialog box's with a common section. It makes sense to build one 
component for this functionality a common code base for the control. 
Then each of the Dialog box's would contain the common control. On 
investigating the development of a "Windows Common" control, it was 
evident that most native GUI with Win32 common controls had gone out of 
style in the mid 1990's. This is when Microsoft started to focus on VBX 
or (Visual Controls) and Microsoft has continue to move into the new 
languages and tools (C#, .Net) this includes the new WFL (Windows Form 
Libraries). <br>
<br>
 This is why I asked the question for Native GUI and Win32.<br>
<br>
 Is there an understanding of custom controls?<br>
 Would this even be supportable by the current crop of programmers?<br>
<br>
 •Independence the use of a Custom Control would add complexity to the 
project but not make any issues with independence of the tools.<br>
<br>
 •Continuity: The issues are the ability of new programmers to even 
understand the creation of a custom control and then support such a 
construct. Given that Microsoft stopped publishing material on Win32 
controls in the 1990's does not provide any confidence in their use or 
development.<br>
<br>
 •Compatibility: As controls are just Win32 DLL's or Libraries compatibility is not an issue.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4968200&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1874983&amp;select=4968200&amp;floc=/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4963968" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4968200" data-ref="3_4968200" class="rating-label" name="RateItem_4968200"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4968200/Re-How-much-do-you-use-Custom-Controls-in-Win32.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4968200"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="193687" msgid="4968200"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 3-Dec-19  18:57 &nbsp; &nbsp; Last Update: 3-Dec-19  19:04</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?fid=1874983&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=5"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=744603">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=744603">Revisions (3)</a></div>
<div><a href="#_comments">Comments (4)</a></div>
<div>Posted 11 Dec 2014</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win32" data-id="99">Win32</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win64" data-id="100">Win64</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>20.5K views</div><div>25 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-showindicator="true" data-tags="C, Windows, Win32, Win64, Dev,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=103325"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=103325"  width="160px" height="200px" target="_blank"/></a></noscript><div style="height: 0px; width: 0px; box-sizing: border-box; border: 0px none; font-size: 0px; display: none;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-4" data-google-query-id="CKy098LLmuYCFQ9owQodq5wE0Q"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_1__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Dev,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=103325"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=103325"  width="160px" height="600px" target="_blank"/></a></noscript><div style="height: 600px; width: 160px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-5" data-google-query-id="CPHV98LLmuYCFcV8wQodukUM5w"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="3" data-load-complete="true" width="160" height="600" frameborder="0"></iframe></div></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2014 by Martin Mitáš<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2019 <br>
                <br>
				Web04 
				2.8.191122.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="Custom%20Controls%20in%20Win32%20API%20%20Encapsulation%20of%20Customized%20Controls%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 744603,2,1,true,true,0,'LargeStars', null, 5807385);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1874983,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 744603
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(744603,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 5807385
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : false,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><iframe id="google_osd_static_frame_6652037563749" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe></body></html>