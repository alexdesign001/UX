<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Custom Controls in Win32 API: Visual Styles - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/Main.css">

    <script src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/amp4ads-host-v0.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pubads_impl_modern_rendering_2019112101.js"></script><script async="" type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/jquery-2.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Paint your control consistently with standard/common controls, using the visual styles API.">
<meta name="Keywords" content="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,Windows API,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Martin Mitáš">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/Custom-Controls-in-Win-API-Visual-Styles_002.htm">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles">
<meta property="og:title" content="Custom Controls in Win32 API: Visual Styles">
<meta property="og:description" content="Paint your control consistently with standard/common controls, using the visual styles API.">
<meta property="og:image" content="https://www.codeproject.com/KB/vista/620045/Thumbnail.png">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles"
   },
  "headline": "Custom Controls in Win32 API: Visual Styles",
  "url": "https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles",
  "discussionUrl": "https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/vista/620045/Thumbnail.png",
  "keywords": "C,Windows,Win32,Win64,Visual-Studio,VS2010,custom-controls",
  "commentCount": "21",
  "editor" : {
    "@type" : "Person",
    "name" : "Martin Mitáš",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Paint your control consistently with standard/common controls, using the visual styles API.",
  "articleSection": "Windows API",
  "author" : [{
      "@type" : "Person",
      "name" : "Martin Mitáš",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
    }],
  "datePublished": "2013-07-21",
  "dateCreated": "2013-07-21",
  "dateModified": "2014-03-17"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.97,
    "ratingCount" : 59,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/vista/",
      "name" : "Windows API"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/ga.js"></script>


<style type="text/css"></style><link rel="preload" href="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/integrator.js" as="script"><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/integrator.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pubads_impl_modern_2019112101.js" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-36/html/container.html"></head>	

<body class="firefox firefox0">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,379,797 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 813" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">813</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e5d2e6ae-036a-48c4-9374-8e897a099dbe">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=883547"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=883547"  width="728px" height="90px" target="_blank"/></a></noscript><div style="height: 90px; width: 728px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-1" data-google-query-id="COjn1qvLmuYCFQXH4wcdveUDvw"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="1" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/undo.png" title="Report Ad" style="z-index: 1000; position: relative; left: 0px; top: -90px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px none; padding: 0px; height: 14px; width: 14px;" align="left"></div><div style="display: none; width: 728px; height: 90px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px none;"><div class="sendReportContainer" style="padding-left: 2px; display:block; line-height:initial !important"><div style="display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial"><b>Don't like this Ad?</b></div><div class="dropzone" style="margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal" contenteditable="true">1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here</div><div style="margin-left:10px; display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option selected="selected">Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select> &nbsp;<input type="button" disabled="disabled" class="reportButton" style="padding: 0px !important" value="Report"></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/dm-logo-150x23.png" style="max-width:100%;position:absolute; right:10px; top:10px;"></a></div></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search  subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/vista/">Windows API</a> » <a href="https://www.codeproject.com/KB/vista/#General">General</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_620045_30" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?display=Print" class="tooltip" title="">
   <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="339UXVb9aIvfP0ooAmCvY11A8C7xn7OJPB3TIlqTzcFzpzqQBf75pKSRb/VqeJmapdGKvTFB5qtUfVoCvvdPTM1lVzwhcfRLpQGcN7c0NYcdn/KU+8leUMAgN7MmKC6tI8ZJ530noYycTsnj9x4dwV5vXY2wA3ey3EQ9LXIsiGcHUE08nbatfHz70Osp3RkQO8q5D2GHePcxwiQsLQ8zaVOM3avAzgCA5gf4LXPv9mH6DTKtAWnrbX1RsBVi8LipsgoYTc90TjNguL7HnVxEfoPrzh2LnP3aUrjPdS93wBm5ZZasv/yvKmZ+OgsC4yOHJgX1QXmd4xfN6F9LkIsXxrpLSWdwAEtWPYL7isKdbMCHjVX8pomLj0ff4IRLOTI3DxGhRdCQzd5ZhiXbg8FtYZIxT5ndpFMgtqIazaVZLZ7DhEQXI2FhvTAKC13yCjT9x1c8xaRZhFiR6MRbyT8Ax79saJgq8RI3QkmVwdleLzs9+ZFsM7UlnVC320B2J6ECCDMnXHrRFEZZFgOjYd8eNFj88N3O3Ru1QOnkQ7gkI7dZPBs7QCusUi1FysleGOGEPTSR5eG6rJo1rI872661Gf3PJ7V6zu8Y9LjFQ0QereOxj0E36w7MyLmu9NCtL/wlYj8YYhkZl6NrUWE8N4ozttngVaLaVREulD7PzZcD/738g1mTgj3PUhfF4rTGpM6qr4276722p5LmzEs8kdBfRFTCLgDeoxf+9Ot+5zdGYF8j3I2Fhi2pEo+gtCakVp1raa+VbJJnNnvF4ttK9YBsdJx4GhpbWXwTmoNunQclJClwQsVRDQhOyPNsvhyKueKTl2kIDsDS5SscuQh+Nth7qM1IjShWVDjMSzXTFNTVPz27n5amHTwms2C6pE3AqEA3XvG7H8Lo92MnOUy2QrghzfdYnnsrV9WbLVZu2GHGx8ZXwT05rGlyHLSwrLL7Ak2wUwpKoWsVishewGk2PmhTzDGxH9E8+nM0wSEPRkeNQwPWemKB1tUkJcSWLm6FiCVVtf9YyD+DZTlgDQQRsd1LhHdGbFbpekn26kcR1fxopshJIkjENomg7IHCKOhyYJkLiDydIzqweGH9w3EnuQG8Z/LnKyqLZ51eBG1HOMBnx39T+VjxEhuoBpQbEccx89w0AgVj6QgpOSsosaWkROH4ekcZ6GyZD0RcszR0PMDvtLwZLG5ybW6IgnnPEDN2cbjorhOpgG597QykJGbzvPKbgnEo109llxAabAzdSlKY0/Fc9pFJlvceWbMKIyBFSC66mNJRQfdmhWzYH9nHdy+V+csEWO+3axD1MaX9fQfa2ddInKZqYRdLl3K0i8Y/S/gvexFqjASXuKPGqAU2PI598BnUpr+pagpsY62ZDYLV7Ax5PcT/Wehp10MOsQTjUmL/7NNlUlMsCzaNkv/9AB4/vPYxm+zm268oQQ4uhN6+SANn9GYE86swbCuAkypiNJmUhLX9zzR1TOK/GtamHt1LUFgOaM7mHaslj4nwKHiwwZWVGefy0+f4gNpiYk1LBSeqZ2RbSzPiRwtCg2jeMbkXzqAGFhy/8qEGG75PWFoDbjhiP1fKg1L9ys1gwZ6hWYbHp2yy4ZIRgDbJ5TIwcuiioHRSp+f6+o5CFgJcvmfWmOyXf+jJ2HLTmT6FXiKwBgVQJ1tSQmQMozRfmJLUBwDPSJOuK8G4DKB1wNvfl5V1X6FtWNNHrTi/oIwx+sMwZ3SgcsvudJGMHTj8ikDn+pHi7WvOJ4w30wbQLPRRmKiMnaT3p/gx3cJ/RBB2vnaaz8T39GzKS36l5Ugcr5StLOzjjs3tS058yCmOXg+ZbyJoEedFNQoZnXk7tDQAC02x0ENeto9WQB3J6z5JI20nNdGYklQQGHA/RXbnp+18p2zpeypxlFXczH6C/6Vw9beb6kdsm8aLtgsHSzd15VfbyVhMOpGgNR5UvQe9JcdXGWubJ2yIjK0V2c0uEPA2+6RZlC3ol8RveExTSzZODYfm39nEaM+JClHd3VJFx2e5A7+lXN9ng7V9fFxrwaV6MVof9AjMLQSDC2z65u2ODCvFfEk64VHnA/y1A/4WT08XSGJAff9JmvSIJjG4RX7+p7Zdzhf7P74w84wkQM9JzRkc+CfotFTs/fdP8BTMve5Yt0LbSxY4HaSdHJLtufs+4pHWpCquEVSKnZas4Xe1DFPX1bMnT/rVIBxrcjTszxSdT2uY3RBuDot3y0t7d/bNOR/4Ki9gZ0VPLh3B5cnNDVCVBfejeflgLuMpqkuvzWCbanWRrhjeO9JC+nBSQc9t6Tv4DS+uqfnIR5KSiijY0jaIRGzYP7YoEUUMq9FkQSCPE0t1RT8Ce10mkIPF107/PyNTBnu1vQVgI5y2Sj0PuMU90xioClGikGJMUL8LLi0xKcwI1CCsGsnUNdUVLUPNITDWYbgc9e6fiwJCcRIoeVVflGr9JUFZ4LzqDRr8yoPqWf+zXRB68+Fhq4uPk77ZG69hIJrsiyqDE13Yu39Jo4TcwvxlC+6izvovBHTJR58tIywFx6tOGneTHsOc6X6NB28PdAc7zovZ4HnYeNI2dVo7nsFI8uUH+uYVe/zhrLR/5ezm6IWNkVaMXHC9BRSW2at7hGiiUf9YGS2fVXSrLo03XvgZgFH2cc00Fw/XlQVQIAv9vOvPMFhFb4xkLjRDXTHLVcAMKbR0rrVW0CWXZu903ldQ9A1eD8v3LYk0xo6fNgUvN9muchhP">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Custom Controls in Win32 API: Visual Styles</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" id="ctl00_avatar" class="avatar">

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385" rel="author">Martin Mitáš</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_620045">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="59">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:119px;height:24px;" class="clipped align-left float-left"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:1px;height:24px;position:relative" class="clipped"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.97  (59 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.97  (59 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">17 Mar 2014</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Paint your control consistently with standard/common controls, using the visual styles API.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/KB/vista/620045/Thumbnail.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
	<li><a href="https://www.codeproject.com/KB/vista/620045/vstyles.zip">Download visual styles example - 74.7 KB</a></li></ul>

<h2>Articles in this Series</h2>

<ul>
	<li><a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">Custom Controls in Win32 API: The Basics</a></li>	<li><a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">Custom Controls in Win32 API: The Painting</a></li>	<li>Custom Controls in Win32 API: Visual Styles</li>	<li><a href="http://www.codeproject.com/Articles/624495/Custom-Controls-in-Win32-API-Standard-Messages">Custom Controls in Win32 API: Standard Messages</a></li>	<li><a href="http://www.codeproject.com/Articles/646482/Custom-Controls-in-Win-API-Control-Customization">Custom Controls in Win32 API: Control Customization</a></li>	<li><a href="http://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">Custom Controls in Win32 API: Encapsulation of Customized Controls</a></li>	<li><a href="http://www.codeproject.com/Articles/1042516/Custom-Controls-in-Win-API-Scrolling">Custom Controls in Win32 API: Scrolling</a></li></ul>

<h2>Introduction</h2>

<p>The <a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">last time</a> we discussed the basics of custom controls' painting. Today, we will continue in the same direction and we will explore <em>visual styles</em> (a.k.a. <em>XP theming</em>).</p>

<p>For creation of high quality custom controls, using this API properly
 is essential, yet a quite complex task, so this article is longer than 
its predecessors and I kindly ask my readers for some patience when 
reading it. It will take some time before we really start using the API 
because first of all, we must take a look at Windows theming from a 
somewhat broader perspective.</p>

<h2>UXTHEME.DLL and COMCTL32.DLL</h2>

<p>The theming API is provided by the library <em>UXTHEME.DLL</em> which
 appeared in Windows XP. The two following screenshots demonstrate the 
difference between unthemed and themed user experience:</p>

<p align="center"><img alt="An unthemed dialog (Windows 2000)" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/win2000.png" style="width: 640px; height: 457px" class="lazyautosizes ls-is-cached lazyloaded" data-sizes="auto" data-srcset="/KB/vista/620045/win2000-r-400.png 400w, /KB/vista/620045/win2000.png 640w" sizes="640px" srcset="/KB/vista/620045/win2000-r-400.png 400w, /KB/vista/620045/win2000.png 640w"></p>

<div class="Caption" align="center">An unthemed dialog (Windows 2000)</div>

<p align="center"><img alt="A themed dialog (Windows 7, the default theme)" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/vista/620045/win7.png" class="lazyload" data-sizes="auto" data-srcset="/KB/vista/620045/win7-r-400.png 400w, /KB/vista/620045/win7.png 700w" width="700" height="500"></p>

<div class="Caption" align="center">A themed dialog (Windows 7, the default theme Aero)</div>

<p>The introduction of this theming library also affected the common controls library, <em>COMCTL32.DLL</em>. For compatibility reasons, Windows XP (and all newer Windows versions) are equipped with two different versions of <em>COMCTL32.DLL</em>.</p>

<p>At the standard path <em>C:\Windows\System32\</em>, the old <em>COMCTL32.DLL</em>
 version 5 can be found. This library version contains the 
implementation of standard controls like list view, combo-box, etc., 
which are unaware of <em>UXTHEME.DLL</em> existence, hence applications linked with this library generally are not themed.</p>

<p>The newer version 6 of <em>COMCTL32.DLL</em> resides under <em>C:\Windows\WinSxS\</em>, available as a <em>side-by-side assembly</em>.
 Only applications explicitly manifesting their compatibility with the 
library version 6 use it. The other applications simply continue to use 
the version 5.</p>

<p>Also note, that historically some controls used to be implemented in <em>USER32.DLL</em> (window classes like, for example, <code>BUTTON</code> or <code>EDIT</code>), while others (known as common controls) resided in <em>COMCTL32.DLL</em>. This has changed with the introduction of <em>COMCTL32.DLL</em> version 6, and now all theming-aware controls live there.</p>

<p><strong>Gotcha:</strong> The old (unthemed) implementation of standard controls is still available in <em>USER32.DLL</em>. If you instruct the linker to link your application with <em>COMCTL32.DLL</em>, it may silently omit it if the application never calls any function from it. Hence I recommend you to call <code>InitCommonControls()</code>
 when initializing the application. Otherwise, the app may be just 
unthemed instead of not working, using the old controls, masking 
perfectly the root cause of the problem.</p>

<h2>Application Manifest</h2>

<p>The most usual and natural way of how the application can tell the system its desire to use version 6 of the library <em>COMCTL32.DLL</em>, is to specify it in its <em>manifest</em>. The manifest can be a separate file, but the preferred way is to embed it in the application binary as a resource.</p>

<p>As a separate file, it has to have exactly the same name as the application, with the suffix ".manifest" added (e.g., <em>example.exe.manifest</em> for application <em>example.exe</em>) and it must be located in the same directory.</p>

<p>When embedded as a resource, it has to have a resource ID 1 and type <code>RT_MANIFEST</code>, so typically the following line is present in the application's resource script (<em>.RC</em> file):</p>

<div class="pre-action-link" id="premain351972" style="width:100%;display:block;"><span id="prehide351972" onclick="processCodeBlocks.togglePre(351972);">Hide</span>  &nbsp; <span id="copycode351972" onclick="return processCodeBlocks.copyCode(351972);">Copy Code</span></div><pre id="pre351972" style="margin-top: 0px;" class="notranslate" lang="text">1 RT_MANIFEST path/to/manifest.xml</pre>

<p>Either way, the manifest is an XML document and it should look like this:</p>

<div class="pre-action-link" id="premain633973" style="width:100%;display:block;"><span id="prehide633973" onclick="processCodeBlocks.togglePre(633973);">Hide</span>  &nbsp; <span id="copycode633973" onclick="return processCodeBlocks.copyCode(633973);">Copy Code</span></div><pre id="pre633973" style="margin-top: 0px;" class="notranslate" lang="xml"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span><span class="code-summarycomment"> </span><span class="code-summarycomment">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">encoding</span><span class="code-keyword">="</span><span class="code-keyword">UTF-8"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">standalone</span><span class="code-keyword">="</span><span class="code-keyword">yes"</span><span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">assembly</span><span class="code-attribute"> </span><span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">urn:schemas-microsoft-com:asm.v1"</span><span class="code-attribute"> </span><span class="code-attribute">manifestVersion</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">assemblyIdentity</span><span class="code-attribute"> </span><span class="code-attribute">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0.0.0"</span><span class="code-attribute"> </span><span class="code-attribute">processorArchitecture</span><span class="code-keyword">="</span><span class="code-keyword">*"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">app name"</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">win32"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">description</span><span class="code-keyword">&gt;</span>app description<span class="code-keyword">&lt;</span><span class="code-leadattribute">/description</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">dependency</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">dependentAssembly</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">assemblyIdentity</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">win32"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Microsoft.Windows.Common-Controls"</span><span class="code-attribute"> </span><span class="code-attribute">
</span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">version</span><span class="code-keyword">="</span><span class="code-keyword">6.0.0.0"</span><span class="code-attribute"> </span><span class="code-attribute">processorArchitecture</span><span class="code-keyword">="</span><span class="code-keyword">*"</span><span class="code-attribute"> </span><span class="code-attribute">
</span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">publicKeyToken</span><span class="code-keyword">="</span><span class="code-keyword">6595b64144ccf1df"</span><span class="code-attribute"> </span><span class="code-attribute">language</span><span class="code-keyword">="</span><span class="code-keyword">*"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">/dependentAssembly</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/dependency</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">ms_asmv2:trustInfo</span><span class="code-attribute"> </span><span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">urn:schemas-microsoft-com:asm.v2"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">ms_asmv2:security</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">ms_asmv2:requestedPrivileges</span><span class="code-keyword">&gt;</span>
                <span class="code-keyword">&lt;</span><span class="code-leadattribute">ms_asmv2:requestedExecutionLevel</span><span class="code-attribute"> </span><span class="code-attribute">level</span><span class="code-keyword">="</span><span class="code-keyword">asInvoker"</span><span class="code-attribute"> </span><span class="code-attribute">uiAccess</span><span class="code-keyword">="</span><span class="code-keyword">false"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
            <span class="code-keyword">&lt;</span><span class="code-leadattribute">/ms_asmv2:requestedPrivileges</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">/ms_asmv2:security</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/ms_asmv2:trustInfo</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/assembly</span><span class="code-keyword">&gt;</span></pre>

<p>Of course for your application the manifest should be adapted to use 
its name, description, version, and also the processor it is supposed to
 run on (<em>"X86"</em>, <em>"amd64"</em>, or <em>"*"</em> meaning any CPU type) in the first <code>&lt;assemblyIdentity&gt;</code> tag.</p>

<p>When an application is being launched on Windows XP or newer, the 
system (in particular, the application loader) examines the binary and 
looks whether it can find the manifest. If yes, then the application 
loader loads DLLs in the versions to satisfy the requirements in the 
manifest. (Strictly speaking this works only for DLLs available as 
side-by-side assemblies, not for every DLL. But <em>COMCTL32.DLL</em> fulfills this requirement.)</p>

<p>In our context, the most interesting part of the manifest is the specification of the dependent assembly, identified as <code>Microsoft.Windows.Common-Controls</code>, where we explicitly ask the system for version 6 of <em>COMCTL32.DLL</em>.</p>

<p>Hence, when implementing a reusable control, we should naturally 
follow and respect the application's manifest too. If the app proclaims 
it supports <em>COMCTL32.DLL</em> version 6, the custom control should follow it and use the theming API as <em>COMCTL32.DLL</em> does. When the app is not themed, the custom control should respect it and its look should be consistent with it.</p>

<p>Even if the control is implemented in a separate DLL and it has no 
control over in what application its code is executed in, we can use the
 version of <em>COMCTL32.DLL</em> as an indicator for the decision making at run time:</p>

<div class="pre-action-link" id="premain666501" style="width:100%;display:block;"><span id="prehide666501" onclick="processCodeBlocks.togglePre(666501);">Hide</span>  &nbsp; <span id="copycode666501" onclick="return processCodeBlocks.copyCode(666501);">Copy Code</span></div><pre id="pre666501" style="margin-top: 0px;" class="notranslate" lang="C++"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">shlwapi.h</span><span class="code-keyword">&gt;</span>
</span>
BOOL ShouldUseUxThemeDll(<span class="code-keyword">void</span>) 
{
    HMODULE hDll;
    DWORD dwMajorVersion = <span class="code-digit">0</span>;

    hDll = LoadLibrary(_T(<span class="code-string">"</span><span class="code-string">COMCTL32.DLL"</span>));
    <span class="code-keyword">if</span>(hDll != NULL) {
        DLLGETVERSIONPROC fn_DllGetVersion;
        DLLVERSIONINFO vi;

        fn_DllGetVersion = (DLLGETVERSIONPROC) GetProcAddress(hDll, <span class="code-string">"</span><span class="code-string">DllGetVersion"</span>);
        <span class="code-keyword">if</span>(fn_DllGetVersion != NULL) {
            vi.cbSize = <span class="code-keyword">sizeof</span>(DLLVERSIONINFO);
            fn_DllGetVersion(&amp;vi);
            dwMajorVersion = vi.dwMajorVersion;
        }
        FreeLibrary(hDll);
    }

    <span class="code-keyword">return</span> (dwMajorVersion &gt;= <span class="code-digit">6</span>);
}</pre>

<p>Note that the return value of this function does not change for the 
life time of the application. (That is, unless the application does 
something nasty with <code>FreeLibrary()</code> and <code>LoadLibrary()</code>, changing the version of <em>COMCTL32.DLL</em> in process run time. That is such an obscure case, that, in my opinion, we can solve this issue by ignoring it...).</p>

<h2>Disabling Visual Styles</h2>

<p>Even if an application asks for <em>COMCTL32.DLL</em> version 6 using
 the manifest, the standard controls may still be painted unthemed, as 
(in some Windows versions) the user can disable the theming in the whole
 user session (in Control Panels), or for the particular application 
(the Properties of the particular <em>.exe</em> file, Compatibility tab).</p>

<p><strong>Note</strong>: The setting in Control Panel applies 
immediately to all (theme-aware) applications, even for those already 
running. Disabling visual styles on the Compatibility tab of the 
application's Properties does not affect already running processes. It 
only applies for any .EXE started after the change.</p>

<p><strong>Gotcha</strong>: At least on 64-bit Windows 7, disabling 
visual themes for a 64-bit application in the Compatibility tab is 
silently ignored by the system. I guess Microsoft felt no need to 
provide that compatibility option for 64-bit applications: Prior to 
Windows XP, there were no 64-bit programs in the first place. So, 
likely, they just forgot to hide or disable the check-box for 64-bit 
apps on that dialog.</p>

<p>On Windows 8, the option to disable themes for an application has disappeared altogether.</p>

<h2>Compatibility and Testing</h2>

<p>Windows 2000 (and older) do not support themes at all and the library <em>UXTHEME.DLL</em> does not exist there. If you aspire to support Windows 2000, then you should load <em>UXTHEME.DLL</em> in run time with <code>LoadLibrary()</code> and <code>GetProcAddress()</code>. If that fails, fall back in your control implementation to the non-themed GDI code paths.</p>

<p>Even when <em>UXTHEME.DLL</em> is present, different Windows versions
 come with quite different default themes and a small set of alternative
 themes (usually only color variations of the default one). (Only 
Windows Vista and 7 share the same themes.)</p>

<p>Of course all of that increases the amount of circumstances under 
which the control should be tested. As a bare minimum, you should test 
your control on Windows XP, Windows 7 (or Vista), and on Windows 10 (or 
8), and also while the themes are disabled.</p>

<h2>Using UXTHEME.DLL</h2>

<p>To use the theming API, you need to link (or load in run time) <em>UXTHEME.DLL</em>, and include its header <em>uxtheme.h</em>. There are also accompanying headers <em>vsstyle.h</em> and <em>vssym32.h</em> we will mention later.</p>

<p><strong>Note</strong>: <em>UXTHEME.DLL</em> does not follow the 
historic Win32 API string duality. Whenever dealing with strings, Win32 
API usually provides two functions for the same thing, one for Unicode 
(functions ending with the suffix "-W') and the other one for ANSI 
strings (suffix "-A"), and a macro (without a suffix) which resolves to 
one of those depending on whether macro <code>UNICODE</code> is defined.</p>

<p>On the other hand <em>UXTHEME.DLL</em> uses strictly Unicode. It 
includes functions for painting text as well as various string 
identifiers (i.e., theme class and subclass names and values of string 
properties; these terms shall be explained further in the article).</p>

<h2>Theme Definition</h2>

<p><em>UXTHEME.DLL</em> itself is a relatively simple DLL. It actually 
doesn't know anything about how to paint any particular control or its 
part. Instead, most of its functions just know how to access data of the
 currently active visual theme, which I call <em>theme definition</em> 
for the purposes of this article. It is the theme definition as provided
 on Windows (and the lack of its documentation) which causes more 
difficulties for the implementation of custom controls rather than <em>UXTHEME.DLL</em> itself.</p>

<p>The theme definition, in general, is a structured storage which 
defines a hierarchy of some objects (classes, subclasses, parts, states;
 we will discuss them below) and associates them with various resources 
(mainly images) and properties describing many aspects of them.</p>

<p>The core of the storage is a resource-only DLL (albeit with a 
different file extension). For example on Windows 7, the DLL is usually 
on the path <em>C:\Windows\Resources\Themes\Aero\aero.msstyles</em>. However your application should not rely on such an implementation detail at all.</p>

<p>On Windows XP the default theme definition is called Luna. On Vista 
and 7 it is Aero. You may already know these names as they were 
appearing even in Microsoft marketing materials.</p>

<p>The top-level category in the hierarchy of objects defined by the theme definition is <em>class</em>.
 Please do not confuse the theme class with the term from 
object-oriented programming or window classes. The class is identified 
with its string name (the second parameter of <code>OpenThemeData()</code>)
 and in most (but not all) cases it provides data for a particular 
standard control, or other aspects of the user interface (e.g., the 
Start menu, Control Panels, etc.).</p>

<p>Many theme classes actually have the same name as some of the window class names of standard controls (e.g., <code>BUTTON</code>, <code>EDIT</code>, <code>TREEVIEW</code>)
 but in general the namespace of both are different and there are some 
standard window classes which do not have their own dedicated 
counterpart in the Windows theme definitions, and vice versa. A 
prominent example of such a theme class can be <code>TEXTSTYLE</code> 
which defines mainly font attributes for various text labels, for 
general use by applications. (Note though this theme class was added in 
Aero. Luna on Windows XP does not have it.)</p>

<p>There may also be something called subclasses, which may provide 
different, alternative, data for the same kind of control or other 
elements of the Windows user interface, but we will cover them a bit 
later, to make the main principles easier to understand.</p>

<p>In the second level, below the class in the hierarchy, there are <em>parts</em>.
 Every part of the given class is identified by an integer and it 
describes some partial aspect of the theme class which can be painted 
independently on the other parts of the same theme class, e.g. a border 
frame, a background, a glyph, a button for the scrollbar or a combo box.</p>

<p>In the third level of the hierarchy, below parts, there are <em>states</em>.
 Like part, every state is also identified by an integer. Different 
states of a single part are used to reflect various states of the 
control, e.g., when it is disabled, when it has focus, or when it is hot
 (i.e., under the mouse cursor). Parts which are not supposed to change 
their look according to the control's internal state often have only one
 state, usually identified by value 1. Other parts, which do change 
their appearance to reflect the state of the control, may define many 
states.</p>

<p>Many API functions working with themes take the part and state 
together with the theme handle as their input. In the relatively rare 
cases when you need to refer to the part as a whole, you may use state 0
 as the API guarantees no state has this identifier. The same stands for
 parts. Part 0 means the caller has no particular part in mind.</p>

<p>Furthermore, each object on each hierarchy level (including the theme
 definition as a whole) can have many properties associated with it. The
 properties vary a lot and can also have different types and they 
describe many attributes of the objects. Again, we will say a few words 
about them later.</p>

<p>Windows SDK provides headers <em>vssym32.h</em> and <em>vsstyle.h</em>
 which provide some symbolic identifiers to the parts and states 
(enumerations) and also for properties (defined as preprocessor macros).
 (Some older tutorials on the net may use <em>tmschema.h</em> instead. 
But Microsoft declared this header obsolete in more recent Windows SDKs.
 It is less complete and incompatible with the newer headers so avoid it
 in new code.)</p>

<p>For example, the standard window class <code>BUTTON</code> has a corresponding theme class <code>BUTTON</code>, and it consists of parts:</p>

<div class="pre-action-link" id="premain456920" style="width:100%;display:block;"><span id="prehide456920" onclick="processCodeBlocks.togglePre(456920);">Hide</span>  &nbsp; <span id="copycode456920" onclick="return processCodeBlocks.copyCode(456920);">Copy Code</span></div><pre id="pre456920" style="margin-top: 0px;" class="notranslate">enum BUTTONPARTS {
    BP_PUSHBUTTON = 1,
    BP_RADIOBUTTON = 2,
    BP_CHECKBOX = 3,
    BP_GROUPBOX = 4,
    BP_USERBUTTON = 5,
    BP_COMMANDLINK = 6,
    BP_COMMANDLINKGLYPH = 7
};</pre>

<p>Then there are other enumerations which list all the states for each button part, for example for <code>PB_PUSHBUTTON</code>:</p>

<div class="pre-action-link" id="premain923661" style="width:100%;display:block;"><span id="prehide923661" onclick="processCodeBlocks.togglePre(923661);">Hide</span>  &nbsp; <span id="copycode923661" onclick="return processCodeBlocks.copyCode(923661);">Copy Code</span></div><pre id="pre923661" style="margin-top: 0px;" class="notranslate">enum PUSHBUTTONSTATES {
    PBS_NORMAL = 1,
    PBS_HOT = 2,
    PBS_PRESSED = 3,
    PBS_DISABLED = 4,
    PBS_DEFAULTED = 5,
    PBS_DEFAULTED_ANIMATING = 6
};</pre>

<h2>Theme Handle Management</h2>

<p>Now, finally, we get to the point where we can start exploring the theming API itself.</p>

<p>Once the control decides it wants to use the visual styles, it needs a valid theme handle (<code>HTHEME</code>). The handle is an opaque type representing the given theme class (or subclass). This handle can be obtained with the function <code>OpenThemeData()</code> (second parameter of it is the class name), and released with <code>CloseThemeData()</code>. All functions for themed painting expect this handle as their first parameter.</p>

<p><strong>Note</strong>: The application must be also ready for the situation when the desired theme can not be opened and <code>OpenThemeData()</code> returns <code>NULL</code>.
 That can happen either because the currently selected theme does not 
know the desired theme class name, or because theming is disabled as 
discussed above. Typically, the control should then fall back to a code 
path, which paints the control without themes, in the plain old way to 
fit in the gray old unthemed dialog.</p>

<p>Furthermore, the control has to reopen the theme handle and repaint itself with it whenever it receives the message <code>WM_THEMECHANGED</code>,
 which is a notification that some relevant theme settings have changed 
(e.g., the user has selected a different theme in Control Panel).</p>

<p>So, in a typical control implementation, the relevant parts of the control implementation may look like this:</p>

<div class="pre-action-link" id="premain377093" style="width:100%;display:block;"><span id="prehide377093" onclick="processCodeBlocks.togglePre(377093);">Hide</span>  &nbsp; <span id="preShrink377093" onclick="processCodeBlocks.shrinkExpand(377093);">Shrink</span> <img id="preimg377093" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(377093);">  &nbsp; <span id="copycode377093" onclick="return processCodeBlocks.copyCode(377093);">Copy Code</span></div><pre id="pre377093" style="margin-top: 0px;" processed="true" class="notranslate" lang="C++"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">uxtheme.h</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-comment">//</span><span class="code-comment"> Class name for this control.</span>
<span class="code-keyword">static</span> <span class="code-keyword">const</span> WCHAR[] wszClass = L<span class="code-string">"</span><span class="code-string">BUTTON"</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    HWND hwnd;       <span class="code-comment">//</span><span class="code-comment"> handle of control window</span>
    HTHEME hTheme;   <span class="code-comment">//</span><span class="code-comment"> theme handle (NULL when not themed)</span>
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> <span class="code-keyword">void</span>
CustomPaint(CustomData* pData, HDC hDC, RECT* rcDirty, BOOL bErase)
{
    <span class="code-keyword">if</span>(pData-&gt;hTheme != NULL) {
        <span class="code-comment">//</span><span class="code-comment"> Paint with themes.</span>
        <span class="code-comment">//</span><span class="code-comment"> ...</span>
    } <span class="code-keyword">else</span> {
        <span class="code-comment">//</span><span class="code-comment"> Fallback to old simple grayish look, painted with plain GDI.</span>
        <span class="code-comment">//</span><span class="code-comment"> ...</span>
    }
}

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);

    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-keyword">case</span> WM_ERASEBKGND:
            <span class="code-keyword">return</span> FALSE;

        <span class="code-keyword">case</span> WM_PAINT:
        {
            PAINTSTRUCT ps;
            BeginPaint(hwnd, &amp;ps);
            CustomPaint(pData, ps.hdc, &amp;ps.rcPaint, ps.fErase);
            EndPaint(hwnd, &amp;ps);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
        }
 
        <span class="code-keyword">case</span> WM_THEMECHANGED:
            <span class="code-keyword">if</span>(pData-&gt;hTheme)
                CloseThemeData(pData-&gt;hTheme);
            pData-&gt;hTheme = OpenThemeData(hwnd, wszClass);
            InvalidateRect(hwnd, NULL, TRUE);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        <span class="code-keyword">case</span> WM_CREATE:
            <span class="code-keyword">if</span>(!DefWindowProc(hwnd, uMsg, wParam, lParam))
                <span class="code-keyword">return</span> -<span class="code-digit">1</span>;
            pData-&gt;hTheme = OpenThemeData(hwnd, wszClass);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        <span class="code-keyword">case</span> WM_DESTROY:
            <span class="code-keyword">if</span>(pData-&gt;hTheme)
                CloseThemeData(pData-&gt;hTheme);
            <span class="code-keyword">break</span>;

        <span class="code-keyword">case</span> WM_NCCREATE:
            <span class="code-keyword">if</span>(!DefWindowProc(hwnd, uMsg, wParam, lParam))
                <span class="code-keyword">return</span> FALSE;
            pData = malloc(<span class="code-keyword">sizeof</span>(CustomData));
            <span class="code-keyword">if</span>(pData == NULL)
                <span class="code-keyword">return</span> FALSE;
            ZeroMemory(pData, <span class="code-keyword">sizeof</span>(CustomData));
            pData-&gt;hwnd = hwnd;
            SetWindowLongPtr(hwnd, <span class="code-digit">0</span>, (LONG_PTR)pData);
            <span class="code-keyword">return</span> TRUE;

        <span class="code-keyword">case</span> WM_NCDESTROY:
            <span class="code-keyword">if</span>(pData != NULL)
                free(pData);
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>Note that for the sake of readability, this example has skipped the checking of the old <em>COMCTL32.DLL</em> version with <code>ShouldUseUxThemeDll()</code>
 as recommended in the earlier section. The attached downloadable code 
(at the top of this article) is more complete in this regard.</p>

<p>Also note we will supplement the function <code>CustomPaint()</code> with some real painting code later in this article, after a short intermezzo.</p>

<h2>Useless IsThemeActive() and IsAppThemed()</h2>

<p>Equipped with the knowledge about theme handle management, let's 
return little bit back to the discussion about when we should paint with
 themes and when not to. When checking whether the application or 
control should be painted with themes, there are two <em>UXTHEME.DLL</em> functions, <code>IsThemeActive()</code> and <code>IsAppThemed()</code>,
 which developers often attempt to use for this purpose but which cause a
 lot of confusion. Therefore, let's explain them a bit more.</p>

<p><code>IsThemeActive()</code> only asks whether the user has enabled themes in his session. It usually returns <code>TRUE</code>, unless the user selected the classical look and feel in Control Panel (so, on Windows 8, it always returns <code>TRUE</code>). In particular, it can return <code>TRUE</code>
 even when the theming is disabled for the particular application in its
 Properties, or when the application otherwise is unaware of themes and 
uses <em>COMCTL32.DLL</em> version 5.</p>

<p>All that matters is the global setting in the Control Panel. 
Therefore the return value does not say anything about whether the 
caller should use the visual themes or not.</p>

<p>The other function, <code>IsAppThemed()</code>, does much more. Actually too much, in my opinion. It checks that themes are allowed globally (the same as <code>IsThemeActive()</code>)
 and then also that the application wants to be themed (manifest) and 
that themes are not disabled (Compatibility tab of its Properties).</p>

<p>It returns <code>TRUE</code> only when all the three conditions are true. In other words, it asks whether <code>OpenThemeData()</code> would, for reasonable valid input parameters, return a valid non-<code>NULL</code> theme handle at the moment. If it returns <code>FALSE</code>, any call to <code>OpenThemeData()</code> is guaranteed to return <code>NULL</code>.</p>

<p>So, you may just call <code>OpenThemeData()</code> directly and use the returned handle for themed painting, or fall back to unthemed painting when it returns <code>NULL</code>. Again you don't need <code>IsAppThemed()</code> for anything.</p>

<p>Also note that both functions depend on the current settings in the 
Control Panel, and those may be changed anytime, during the lifetime of 
your application: I have seen quite a lot of applications which calls 
one or the other function during app initialization to decide whether to
 use theming API at all or not. If you need that, use <code>ShouldUseUxThemeDll()</code> as provided aerlier in this article and keep the rest on <code>OpenThemeData()</code> . It knows when to return <code>NULL</code>.</p>

<h2>Themed Painting</h2>

<p>Alright, back to the themed painting.</p>

<p>Let's supplement code from the section about handle management to 
paint a button-like control, for example. Note the control is not 
interactive so we use a constant part and state. Real controls would 
remember and change the state of the control by monitoring various mouse
 and keyboard messages in a window procedure.</p>

<div class="pre-action-link" id="premain274218" style="width:100%;display:block;"><span id="prehide274218" onclick="processCodeBlocks.togglePre(274218);">Hide</span>  &nbsp; <span id="copycode274218" onclick="return processCodeBlocks.copyCode(274218);">Copy Code</span></div><pre id="pre274218" style="margin-top: 0px;" class="notranslate" lang="C++"><span class="code-keyword">static</span> <span class="code-keyword">void</span> CustomPaint(CustomData* pData, HDC hDC, RECT* rcDirty, BOOL bErase)
{
    RECT rect;
    GetClientRect(pData-&gt;hwnd, &amp;rect);

    <span class="code-keyword">if</span>(pData-&gt;hTheme != NULL) {
        <span class="code-keyword">int</span> part;
        <span class="code-keyword">int</span> state;

        part = BP_BUTTON;
        state = PBS_NORMAL;
       
        <span class="code-keyword">if</span>(IsThemeBackgroundPartiallyTransparent(pData-&gt;hTheme, part, state))
            DrawThemeParentBackground(pData-&gt;hwnd, hDC, &amp;rect);
        DrawThemeBackground(pData-&gt;hTheme, hDC, part, state, &amp;rect, &amp;rect);
    } <span class="code-keyword">else</span> {
        <span class="code-comment">//</span><span class="code-comment"> Fallback to old simple grayish look, painted with plain GDI.</span>
        DrawFrameControl(hDC, &amp;rect, DFC_BUTTON, DFCS_BUTTONPUSH);
    }
}</pre>

<p>The code above is almost canonical. Every tutorial on the topic shows
 something like this snippet of code. Two things are essential.</p>

<p>First, the themes in general support (partially) transparent controls
 so the painting code has to reflect this and (when needed) ask the 
parent window to paint itself within the transparent areas.</p>

<p>For example, a button in Windows theme definitions has rounded 
corners and this way, it is the parent's job to paint the few pixels 
exposed by them.</p>

<p>By the way, although I haven't verified this, I believe <code>IsThemeBackgroundPartiallyTransparent()</code> actually makes some magic based on sending the <code>WM_PRINTCLIENT</code> message to the parent. We already discussed this message in <a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">the previous article</a>.</p>

<p>Another useful function is <code>DrawThemeText()</code> (and also <code>DraweThemeTextEx()</code>,
 since Vista) which is intended for painting control labels. The 
function uses font and other text attributes as set by the theme 
definition. In practice however, both Luna and Aero, do not define any 
font or text properties for majority of classes/parts/states, which just
 leads the function to paint with <code>HFONT</code> currently selected 
into the used device context and only a few standard controls actually 
paint themselves with this function. Most of them stick with the old GDI
 <code>TextOut</code> or <code>DrawText()</code> to paint with a font determined by the latest <code>WM_SETFONT</code>, but that is another topic.</p>

<p><strong>Note</strong>: When the theme does not define any font properties for the class/part/state used, <code>DrawThemeText()</code> simply paints with the font currently selected in the device context.</p>

<p>The API provides a few more functions for painting with themes like <code>DrawThemeEdge()</code> or <code>DrawThemeIcon()</code>. AFAIK, they are rarely used and we will not pay any special attention to them here.</p>

<p>The second point I want to highlight is that if the theme data is not availble (<code>OpenThemeData()</code> returned <code>NULL</code>), we have to paint in the old boring GDI way, here with <code>DrawFrameControl()</code>.</p>

<h2>Theme Subclasses</h2>

<p>Let's now talk a bit about the theme subclasses. First of all, note the term has nothing common with the technique called <em>control subclassing</em>, which is used for augmenting an existing control by implanting another window procedure via <code>SetWindowLongPtr(hwnd, GWLP_WNDPROC, pfn_WinProc)</code>.</p>

<p>The <em>theme subclass</em> is an alternative set of properties and 
resources in the theme definition, differentiated from an ordinary theme
 class (and from all the other subclasses of the same class) by an 
additional supplementary string identifier, the subclass name.</p>

<p>That allows applications to change the look of some control by 
enforcing some particular subclass name to it. Some programs which are 
integral parts of Windows (including <em>explorer.exe</em> which is 
responsible for managing the desktop and the open folder windows) take 
advantage of this feature. It is no accident that the Aero theme 
definition provides a subclass named <code>EXPLORER</code> for many standard controls.</p>

<p>The screenshot below demonstrates how the tree view control differs 
in Aero (Windows 7), depending on whether it uses the standard class <code>TREEVIEW</code>, or when it is told to use the <code>EXPLORER</code> subclass of it:</p>

<p align="center"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Image 3" data-src="/KB/vista/620045/subclass.png" class="lazyload" data-sizes="auto" data-srcset="/KB/vista/620045/subclass-r-400.png 400w, /KB/vista/620045/subclass.png 460w" width="460" height="300"></p>

<p>It can be seen that the two tree views look a bit different and even 
have a bit different item dimensions. From a programmatic point of view,
 the difference is achieved with this single line of code which forces 
the right control to use the subclass:</p>

<div class="pre-action-link" id="premain195028" style="width:100%;display:block;"><span id="prehide195028" onclick="processCodeBlocks.togglePre(195028);">Hide</span>  &nbsp; <span id="copycode195028" onclick="return processCodeBlocks.copyCode(195028);">Copy Code</span></div><pre id="pre195028" style="margin-top: 0px;" class="notranslate" lang="C++">SetWindowTheme(hwndTreeOnRight, L<span class="code-string">"</span><span class="code-string">EXPLORER"</span>, NULL);</pre>

<p>That one line has the following effect: Window manager remembers the 
subclass name in association with the control, until the window dies or 
the function is used once again to reset the subclass name. Whenever the
 control implementation calls <code>OpenThemeData()</code> (with its own window handle as the first parameter), <em>UXTHEME.DLL</em> returns a handle to the subclass data, not the parent class itself. Also the function <code>SetWindowTheme()</code> immediately sends <code>WM_THEMECHANGED</code>
 to the given control. So, in response to it, the control reopens the 
theme handle and repaints itself, getting the alternative look defined 
by the subclass instantly.</p>

<p>Right now, you will probably ask about the last parameter of <code>SetWindowTheme()</code>,
 especially if you have read the documentation of the function on MSDN, 
as the description there is very cryptic. To be honest, I am not too 
sure about it. I think (but never verified) that it allows to associate a
 class (not subclass) name with the control and hence to override the 
class name the control itself uses whenever it calls <code>OpenThemeData()</code>. (This speculation is based on an information that using <code>L" "</code>
 as the last parameter forces the particular window handle to paint 
itself without any theme. That, I guess, is caused by the fact that the 
theme definition does not know a class named with a space.)</p>

<h2>Theme Properties</h2>

<p>I already disclosed that properties are some data associated with 
classes, subclasses, parts, and states in the theme definition, or with 
the theme definition itself.</p>

<p>The API defines a huge number of properties, and usually each object 
in the theme definition defines just a small portion of them. Various 
properties are of different types and it is this variability of 
properties which reflects in the API itself: Majority of its functions 
are intended for retrieving values of the properties.</p>

<p>There are various enumeration properties (<code>GetThemeEnumValue()</code>), integer properties (<code>GetThemeIntValue()</code>), string properties (<code>GetThemeStringValue()</code>), boolean properties (<code>GetThemeBoolValue()</code>), color properties (<code>GetThemeColorValue</code>), and many more. It does not make any sense to list all their types here.</p>

<p>The good news, though, is that in most cases, the app or control does
 not need to retrieve them. Instead the painting functions of the 
theming API reflect them automatically. For example, the property <code>TMT_BGTYPE</code>
 specifies whether painting a background of a class/part/state it is 
associated to, should be painted as bliting an image, painting a frame, 
or if no background should be painted at all. Depending on that, other 
properties may specify what image or what color to use and how.</p>

<p>The function <code>DrawThemeBackground()</code> retrieves all the 
relevant properties and follows them. This is why we won't talk much 
about properties: There are hundreds of them and I have ever needed just
 a few of them in very special situations. (We may touch such properties
 in future articles when we talk about some topic when using some 
specific property is needed.)</p>

<p>All that said there is one exception: There are also some global 
properties, i.e. properties not related to any object in the theme 
definition, but to the theme definition itself, as a whole. We will 
cover these in next section.</p>

<h2>Global Properties</h2>

<p>As mentioned above, there are also some global properties, which 
apply to the whole system as long as the particular theme definition is 
in use. Simply put most of these properties are just a replacement of 
system parameters as retrieved with some old functions provided by <em>USER32.DLL</em>.</p>

<p>All of <em>UXTHEME.DLL</em> functions whose names begin with <code>GetThemeSys...()</code>
 are of this nature. One nice feature of this set of functions is the 
fact that when no theme definition applies (theme handle is <code>NULL</code>), the functions fall back to retrieve the right values with the corresponding <em>USER32.DLL</em> function for you.</p>

<p>So let's provide a small table of how these translate to each other:</p>


	<table class="ArticleTable" align="center"><thead>		<tr>			<th colspan="2"><em>UXTHEME.DLL</em></th>			<th colspan="2"><em>USER32.DLL</em></th>		</tr>		<tr>			<th>Function</th>			<th>Fundamental constant</th>			<th>Function</th>			<th>Fundamental constant</th>		</tr>	</thead>	<tbody>		<tr>			<td><code>GetThemeSysBool()</code></td>			<td><code>TMT_FLATMENUS</code></td>			<td><code>SystemParametersInfo()</code></td>			<td><code>SPI_GETFLATMENU</code></td>		</tr>		<tr>			<td><code>GetThemeSysColor()</code></td>			<td>&nbsp;</td>			<td><code>GetSysColor()</code></td>			<td>&nbsp;</td>		</tr>		<tr>			<td><code>GetThemeSysColorBrush()</code></td>			<td>&nbsp;</td>			<td><code>GetSysColorBrush()</code></td>			<td>&nbsp;</td>		</tr>		<tr>			<td rowspan="2"><code>GetThemeSysFont()</code></td>			<td><code>TMT_ICONTITLEFONT</code></td>			<td rowspan="2"><code>SystemParametersInfo()</code></td>			<td><code>SPI_GETICONTITLELOGFONT</code></td>		</tr>		<tr>			<td>the other ones</td>			<td><code>SPI_GETNONCLIENTMETRICS</code></td>		</tr>		<tr>			<td><code>GetThemeSysInt()</code></td>			<td>&nbsp;</td>			<td>no counterpart</td>			<td>&nbsp;</td>		</tr>		<tr>			<td><code>GetThemeSysSize()</code></td>			<td>&nbsp;</td>			<td><code>GetSystemMetrics()</code></td>			<td>&nbsp;</td>		</tr>		<tr>			<td><code>GetThemeSysString()</code></td>			<td>&nbsp;</td>			<td>no counterpart</td>			<td>&nbsp;</td>		</tr>	</tbody></table>

<p><strong>Note</strong>: Wherever the fundamental constant is not 
filled in the table, both functions share the set of allowed parameters 
(with the same meaning).</p>

<p>Only in the case you want to also support Windows 2000 or older, and hence need to deal with the possibility of missing <em>UXTHEME.DLL</em>, you may need to implement the fallback manually.</p>

<h2>Troubleshooting</h2>

<p>You could now quite easily have the impression that once you solve 
the problem whether to use the theming API, and know how to manage the 
theme handles, the painting with the visual themes is then quite 
straightforward. But in controls of more complex nature, you can 
encounter many problems. Below I summarize the problems I have been 
facing when implementing my controls, especially controls in the <a href="http://mctrl.org/">mCtrl project</a>.</p>

<p>Unfortunately, for many of them, there is no simple solution (as far 
as I know). Nevertheless, I believe it is valuable to list the problems 
here anyway. It is beneficial to know about as many traps as possible 
before you decide to take any particular path.</p>

<p>It is simply a matter of fact that using this API requires often a 
trial-and-error approach to find a feasible way to implement your 
control.</p>

<h3>Gotcha: Heavily Under-Documented</h3>

<p>The biggest problem of the API is the lack of good documentation. 
MSDN documents fairly well all the functions and types of the API. But 
documentation of the theme definition objects, i.e., classes and 
subclasses, as well as their parts and states, consists mainly of pure 
listings of their identifiers.</p>

<p>There is no documentation of what each class, subclass, part, or 
state is meant for. Often it is quite obvious from the name of the 
class/sublclass or part/state identifier, but in many cases it is not.</p>

<p>Even when it is obvious, it is not documented which Windows 
introduced them, or under which circumstances they are usable. For 
example some parts are only used by a standard control when you switch 
it to a particular subclass. It is a case of the class <code>TREEVIEW</code> which defines (among others) the part <code>TVP_HOTGLYPH</code>. Both Luna as well as Aero do not define this part for the class <code>TREEVIEW</code> at all so painting with it does nothing. But Aero defines it for the subclass <code>EXPLORER</code> of the class <code>TREEVIEW</code>.</p>

<p>So when implementing a control resembling tree-view, you should use 
the part only conditionally by checking it is available with <code>IsThemePartDefined()</code>, and fall back to the part <code>TVP_GLYPH</code> if it is not.</p>

<p>Unfortunately, MSDN does not provide any information on which parts 
or states of each class are considered to be guaranteed to be defined 
and which are optional. Obviously, some must be guaranteed to be 
defined, or the painting with themes does not make much sense: Otherwise
 using the API would grow to the task of unrealistic complexity both for
 implementation as well as testing it.</p>

<p>A partial solution to this problem is using some common sense and 
using some utility for exploring the theme definitions: Often you may 
recognize what they are for from their visual appearance. There are 
several such utilities available on the net. I offer one, called Theme 
Explorer, by the end of this article.</p>

<h3>Gotcha: Not Really Designed for Custom Controls</h3>

<p>When implementing a custom control, the developer should design it to
 be consistent with standard controls. Arguably, one might assume that 
it is a purpose of such API to paint other controls consistently with 
the standard ones, despite the theme currently in use; and that the task
 should be fairly straightforward.</p>

<p>Actually the reality differs. Both the API and the way how the 
Windows themes are defined, often lead to frustration when trying to 
achieve the desired goal.</p>

<p>As an example, I remember my attempt to implement an edit control 
with one or more buttons similar to what a standard combo-box is 
equipped with. The only difference should be a different glyph on the 
button(s) but unlike that, its appearance should be as close to the 
standard control as possible.</p>

<p>Similar example would be to only reuse the combo box glyph (the drop 
down arrow), when one wants to present a small button for opening a 
drop-down menu somewhere in the application or in another custom 
control.</p>

<p>Unfortunately, the class <code>COMBOBOX</code> has a part <code>CP_DROPDOWNBUTTON</code> which paints not just the background of the button, but also the glyph. You can have both, or nothing.</p>

<p>Yes, the API has a dedicated function to get a bitmap from the theme (<code>GetThemeBitmap()</code>).
 So one might think retrieving the glyph bitmap can be done with this 
function. Otherwise what would the function be good for? But, seemingly,
 the theme definition authors have a different opinion. There is no 
glyph for the combo box, there are only some pixels in the background 
part which, to the untrained eyes of a poor user, may make a false 
impression that some symbol is present...</p>

<p>My personal opinion is that the theming API and especially the 
themes, defined the way they are, were designed by someone who was not 
having third party custom controls in mind at all. That's quite a 
pitiful situation if you ask me, as it significantly lowers the 
potential of the API.</p>

<h3>Gotcha: Not Used Consistently in Standard Controls</h3>

<p>However, there are also problems with standard controls.</p>

<p>When Microsoft created <em>COMCTL32.DLL</em>, they simply omitted support for some controls or their styles. A well known example is that buttons with the style <code>BS_BITMAP</code> or <code>BS_ICON</code> were painted unthemed on Windows XP although the implementation of theme paint for it is trivial once you support <code>BS_PUSHBUTTON</code>. (This was fixed in Windows Vista.)</p>

<p>In a similar way, since version 6 of the library, Microsoft made tab styles and <code>TCS_BOTTOM</code> and <code>TCS_VERTICAL</code>
 unsupported, and indeed, there are no data in the theme definitions 
corresponding to those control styles. Any custom control wanting to 
achieve something similar cannot rely on it at all.</p>

<p>This fairly limits how custom controls may differ (i.e., be customized) from standard ones.</p>

<p>On the contrary, there are also data in Windows theme definitions 
clearly intended for some purpose like determining a size, margin, or 
other property, but which way too often are not used by implementation 
of the standard controls. Instead the controls use undocumented magical 
constants, hard-coded in <em>COMCTL32.DLL</em>.</p>

<p>For example, when I was implementing a tree-list view control (<a href="http://mctrl.org/">mCtrl project</a>),
 I had encountered this issue. The control was designed to be visually 
as close to the standard tree-view as possible. I was expecting that, 
when themed, the standard control uses <code>GetThemeBackgroundContentRect()</code>
 to apply some margins of tree-view items when painting them. To my 
surprise, any attempt to use this function returned 0 for all the 
margins, while it is apparent the standard tree view has some margins 
around them (they are easy to spot if you select an item in a tree-view,
 there are a few pixels as margins at all the edges).</p>

<p>Said in other words: In order to create a custom control consistently
 with a standard one, the developer has to magically mix standard GDI 
with theming API and magical constants. The particular mixture is 
considered an implementation detail of each standard control by 
Microsoft, it is not documented anywhere and hence it has to be guessed 
or reverse-engineered. Furthermore the poor custom-control developer is 
then in some danger, the mixture recipe shall change in future versions 
of Windows. Indeed, it is not a situation which can make any developer 
happy.</p>

<p>The only partial solution I can offer is that developers of Wine 
already made a huge effort to make their controls to be as close to the 
originals as possible, so the easiest way is looking at their code. It 
is not the first time I recommend their code base, and I am pretty sure 
it is not the last one either. (Some links are provided by the end of 
this article.)</p>

<h3>Gotcha: OpenThemeData() and Windows XP</h3>

<p>According to MSDN, in <code>OpenThemeData()</code> the second parameter is more capable than just being a single class name. In particular it says the following:</p>

<ul>
	<li>It can directly open the theme subclass with <code>OpenThemeData(hwnd, L"subclass::class")</code>.</li>	<li>It can accept a list of semicolon-delimited class names, using the first one found in the theme definition.</li></ul>

<p>Both features are nice. What is not nice is the (undocumented) fact, 
that according to my experience they do not work on Windows XP. So for 
compatibility with WinXP, you need open subclasses only via <code>SetWindowTheme()</code> as explained earlier in this article.</p>

<p>The other feature can be replaced with using multiple calls of the function:</p>

<div class="pre-action-link" id="premain318539" style="width:100%;display:block;"><span id="prehide318539" onclick="processCodeBlocks.togglePre(318539);">Hide</span>  &nbsp; <span id="copycode318539" onclick="return processCodeBlocks.copyCode(318539);">Copy Code</span></div><pre id="pre318539" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-keyword">const</span> WCHAR* pszClassList[] = { L<span class="code-string">"</span><span class="code-string">class1"</span>, L<span class="code-string">"</span><span class="code-string">class2"</span>, ..., NULL };
HTHEME hTheme = NULL;
<span class="code-keyword">int</span> i;

<span class="code-keyword">for</span>(i = <span class="code-digit">0</span>; pszClassList[i] != NULL; i++) {
    hTheme = OpenThemeData(hwnd, pszClassList[i]);
    <span class="code-keyword">if</span>(hTheme != NULL)
        <span class="code-keyword">break</span>;
}</pre>

<h3>Gotcha: GetWindowTheme() Limited to One Theme Handle</h3>

<p>For every <code>HWND</code>,<code> </code>Window manager remembers 
one theme handle. It is the most recently opened theme handle by the 
control, i.e. the return value of most recent <code>OpenThemeData()</code> where the given <code>HWND</code> was passed in as the 1st parameter). This remembered handle can be asked for with <code>GetWindowTheme()</code>. Similarly, only this one handle can be actually overriden with <code>SetWindowTheme()</code>.</p>

<p>When implementing a more complex control, typically a control looking
 as a combination of multiple standard controls, you might want to open 
multiple different theme handles for the purposes of its painting. It is
 of course, possible but you have to think carefully which of them 
should be considered <em>the main handle</em>. For the other theme handles, <code>NULL</code> should be passed as the 1st parameter of <code>OpenThemeData()</code> so that the main handle is not replaced with it.</p>

<h3>Gotcha: GetThemeIntList() Designed to Crash</h3>

<p>Sadly, the function <code>GetThemeIntList()</code> and the corresponding structure <code>INTLIST</code> was mis-designed. The structure contains the member <code>iValues</code>, actually an integer array of a fixed size. Unfortunately the size depends on the preprocessor value <code>_WIN32_WINNT</code> and there is no run-time check in a similar way as many WinAPI functions do with a member typically named <code>cbSize</code>.</p>

<p>If <code>_WIN32_WINNT</code> is not defined, or is lower than 0x0600 (<code>_WIN32_WINNT_VISTA</code>), the array size is 10, otherwise it is 402. The <em>UXTHEME.DLL</em>
 implementation on Vista and later blindly assumes, it can write up to 
402 integers into the array. I.e., if your application was built with <code>_WIN32_WINNT</code> set as for example <code>_WIN32_WINNT_WINXP</code>, you can get a buffer overrun on Vista and newer, leading likely either to application crash or other data overwrite.</p>

<p>The solution is easy: If you need to use this function, build your project with the predefined <code>_WIN32_WINNT</code> accordingly to 0x600 or higher; or use a buffer large enough to hold the complete structure with 402 integers.</p>

<p>Hopefully, Microsoft will not augment the limit further in future Windows versions.</p>

<h2>Theme Explorer</h2>

<p>I already noted that especially the identifiers for accessing the 
theme definitions are poorly documented. For this reason, I have 
developed a small tool for exploring the current theme, called Theme 
Explorer. It allows to see how the themes (in various states) look like,
 and it helps to recognize or guess more easily what their purpose is 
and how they should be used.</p>

<p>Originally I created it for my own purposes, when developing my 
custom controls, but I feel it may be useful to broader audience.</p>

<p>&nbsp;</p>

<p align="center"><img alt="Theme Explorer screenshot" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/vista/620045/theme-explorer.png" class="lazyload" data-sizes="auto" data-srcset="/KB/vista/620045/theme-explorer-r-400.png 400w, /KB/vista/620045/theme-explorer.png 588w" width="588" height="471"></p>

<div class="Caption" align="center">Screenshot of Theme Explorer</div>

<p>The left part is a selector of an object to explore (class or 
subclass on the first level, parts and states deeper in the tree), the 
right side then paints the part/state with <code>DrawThemeBackground()</code> in several sizes and lists the properties associated with the object.</p>

<p>It can be downloaded from the mCtrl project website and its sources are hosted on github:</p>

<ul>
	<li>Homepage: <a href="http://mctrl.org/tools.php">http://mctrl.org/tools.php</a></li>	<li>Code repo: <a href="https://github.com/mity/theme-explorer">https://github.com/mity/theme-explorer</a></li></ul>

<p>(The tool is licensed under GNU GPL version 2 or, at your option, any later version.)</p>

<p>The tool has quite a severe limitation: It can only explore the theme
 currently in use, so to be useful you have to run it on Windows XP or 
later (with the theming support enabled in the system). To explore the 
themes in different Windows versions, you need to use this tool in all 
of them. Still, I hope you can find it useful.</p>

<h2>Downloadable Example</h2>

<p>You can download an example package at the top of this page. It 
contains a Visual Studio 2010 solution with three little projects: DLL 
with theme-aware custom control implementation using what this article 
presents, and two small applications which just host the custom control.
 Actually the two applications share their sources and the only 
difference between them is that one has an application manifest enabling
 the visual theme support while the other one does not.</p>

<p>The DLL uses the function <code>ShouldUseUxThemeDll()</code> to detect whether it should use the themed painting or not. When the function returns <code>FALSE</code>, the DLL then uses its own <code>dummy_OpenThemeData()</code> (instead of <code>OpenThemeData()</code>) which simply returns <code>NULL</code>.</p>

<p>Only when <code>ShouldUseUxThemeDll()</code> returns <code>TRUE</code>, the example loads <em>UXTHEME.DLL</em> and the rest depends on the return value of <code>OpenThemeData()</code>.</p>

<h2>Real World Code</h2>

<p>In case you want to study real world code, I can refer to you the following:</p>

<p><a href="http://www.winehq.org/">Wine</a> reimplementation of <em>COMCTL32.DLL</em> is (mostly) aware of themes. In particular, the controls implemented historically in <em>USER32.DLL</em>
 are subclassed in it so in their case the source focuses only on making
 the controls themed which makes them perfect candidates for further 
studying the topic:</p>

<ul>
	<li>Themed button: <a href="https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_button.c">https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_button.c</a></li>	<li>Themed combo: <a href="https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_combo.c">https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_combo.c</a></li>	<li>Themed edit: <a href="https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_edit.c">https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_edit.c</a></li>	<li>Themed listbox: <a href="https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_listbox.c">https://github.com/mirrors/wine/blob/master/dlls/comctl32/theme_listbox.c</a></li></ul>

<p>Also its reimplementation of <em>UXTHEME.DLL</em> may be of interest for readers of this article:</p>

<ul>
	<li><em>UXTHEME.DLL</em> reimplementation: <a href="https://github.com/mirrors/wine/tree/master/dlls/uxtheme">https://github.com/mirrors/wine/tree/master/dlls/uxtheme</a></li></ul>

<p><a href="http://mctrl.org/">mCtrl</a> implements a wrapper of <em>UXTHEME.DLL</em>, to deal with the library (or some of its exported symbols) missing in dependence on particular Windows version:</p>

<ul>
	<li>Public interface: <a href="https://github.com/mity/mctrl/blob/master/include/mCtrl/theme.h">https://github.com/mity/mctrl/blob/master/include/mCtrl/theme.h</a></li>	<li>Implementation: <a href="https://github.com/mity/mctrl/blob/master/src/theme.c">https://github.com/mity/mctrl/blob/master/src/theme.c</a></li></ul>

<p>In addition to that, majority of its controls are theme-aware, using the wrapper, so lets list just few more interesting ones:</p>

<ul>
	<li>Button: <a href="https://github.com/mity/mctrl/blob/master/src/button.c">https://github.com/mity/mctrl/blob/master/src/button.c</a>, bringing themed <code>BS_ICON</code> and <code>BS_BITMAP</code> for Windows XP</li>	<li>Tree-list view: <a href="https://github.com/mity/mctrl/blob/master/src/treelist.c">https://github.com/mity/mctrl/blob/master/src/treelist.c</a></li></ul>

<h2>Next Time: Handling Standard Messages</h2>

<p>That's it for today. The article is much longer than I originally 
anticipated. On the other side, its length reflects the importance I 
attach to this topic for creation of good custom controls, and also it 
reflects the lack of documentation about it. I hope this text has 
enhanced the situation a bit and that you found at least some 
information presented here useful and in understandable form. Some time 
later we will return to control painting, for example, to discuss some 
animating techniques or painting into a non-client area. Even in those 
areas, <em>UXTHEME.DLL</em> has something to offer.</p>

<p>That said, however, we should first step aside a bit and explore 
other aspects of custom controls implementation. Every control should 
support a number of standard messages which the application and system 
uses to communicate with it. MSDN often documents messages from the 
point of an application, but we should look on them mainly from a 
control's point of view and that will be the subject of the next 
article.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=39770"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=39770"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Custom%20Controls%20in%20Win32%20API%3a%20Visual%20Styles%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Custom+Controls+in+Win32+API%3a+Visual+Styles+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles&amp;title=Custom+Controls+in+Win32+API%3a+Visual+Styles+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles&amp;title=Custom+Controls+in+Win32+API%3a+Visual+Styles+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles&amp;description=Custom+Controls+in+Win32+API%3a+Visual+Styles+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Martin-Mitas">Martin Mitáš</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            <div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowOn" class="follow">
	            
	            
	            <a href="https://www.linkedin.com/profile/view?id=88607525"><img style="vertical-align:middle;border:0;height:24px;width:24px" alt="LinkedIn" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/linkedin-32.png"></a> 
            </div>
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Team Leader</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Czech Republic <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/CZ.gif" alt="Czech Republic" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=39770"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=39770"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1837298"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles&amp;fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1837298"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f620045%2fCustom-Controls-in-Win-API-Visual-Styles&amp;fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F5645307_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5645307xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5645307" parent="0" thread="5645307" href="https://www.codeproject.com/Messages/5645307/TreeView-question-for-visual-style.aspx">TreeView question for visual style</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 14535412</span><span class="date">19-Jul-19  6:04</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=14535412">Member 14535412</a></span></td><td class="date"><span>19-Jul-19  6:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5645307_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="14535412" msgid="5645307" votingtype="GoodOrBad" done="true"><a href="#xx5645307xx" onclick="return rateItem(5, 5645307,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',14535412);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5645307xx" onclick="return rateItem(1, 5645307,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',14535412);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Martin and thanks for such article. <br>
<br>
I'm not dev ( in medical activity ) but love customizing my OS for my own usage( windows 10 current one) <br>
I have a question as it's being months I'm looking hard to find out how to <b>modify treeview background</b>
 to put an image instead of argb color code. It's possible with main 
explorer window ( items/listview) to add a custom image as background 
but do you know where to look at for TreeView ( there's also ProperTree 
name I saw about it in shellstyle.dll) <br>
<br>
Here is a screen: <a href="https://imgur.com/a/GOyPOFH" rel="nofollow noopener">Imgur: The magic of the Internet</a>[<a href="https://imgur.com/a/GOyPOFH" target="_blank" title="New Window" rel="nofollow noopener">^</a>] <br>
Instead of blue fillcolor , have a custom picture as background ? <br>
If you have ideas where to look ( dll libraries etc ) and which code lines to mod .<br>
<br>
Usually, visual styles are edited through shellstyle.dll in 
C:\windows\resources\themes after patching some system files ( 
uxinit.dll and themeui.dll ) I imagine you already know it <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/smiley_smile.gif" alt="Smile | :)" align="top">  but in windows 10 it seems treeview background setting is pointing elsewhere but where ? I can only change argb color.<br>
<br>
ps: I tried locate with your awesome tool theme explorer but without success for TreeView<br>
<br>
Thanks for help<br>
<br>
Regards <br>
<br>
Michel<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5645307&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5645307&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5645307" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5645307" data-ref="3_5645307" class="rating-label" name="RateItem_5645307"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5645307/TreeView-question-for-visual-style.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5645307"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="14535412" msgid="5645307"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637310_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5637310xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5637310" parent="0" thread="5637310" href="https://www.codeproject.com/Messages/5637310/Great-article-comment-and-question.aspx">Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Christopher P Taylor</span><span class="date">19-Jun-19  14:54</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5860511">Christopher P Taylor</a></span></td><td class="date"><span>19-Jun-19  14:54&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637310_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5860511" msgid="5637310" votingtype="GoodOrBad" done="true"><a href="#xx5637310xx" onclick="return rateItem(5, 5637310,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5637310xx" onclick="return rateItem(1, 5637310,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Thank you for this.  First thing, I noticed one typo in 
the sample code:  in your definition of CustomProc, in the WM_PAINT 
clause, you wrote 'pCustom', by which I assume you meant 'pData'.<br>
<br>
Secondly, a question:  for various reasons I won't get into, I am in my 
project using a number of owner-drawn controls (buttons, menus), and it 
is not particularly convenient to trap 
WM_CREATE/WM_NCCREATE/WM_DESTROY/WM_NCDESTROY and use GetWindowLongPtr 
to manage and store the HTHEME associated with the window.  Is there any
 particular problem if, each time I have to repaint a widget, I simply 
call OpenThemeData, perform a DrawThemeBackground or two, and then call 
CloseThemeData?  It seems much simpler to me, more like what one 
typically has to do with DC's.  (Also I don't have to deal with 
WM_THEMECHANGED.)  Are you aware of performance penalties or other 
hazards with this approach?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637310&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637310&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5637310" data-ref="3_5637310" class="rating-label" name="RateItem_5637310"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5637310/Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5637310"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5860511" msgid="5637310"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637591_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx5637591xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5637591" parent="5637310" thread="5637310" href="https://www.codeproject.com/Messages/5637591/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">20-Jun-19  15:56</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>20-Jun-19  15:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637591_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="5637591" votingtype="GoodOrBad" done="true"><a href="#xx5637591xx" onclick="return rateItem(5, 5637591,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5637591xx" onclick="return rateItem(1, 5637591,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5637310);" href="https://www.codeproject.com/Messages/5637310/Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks for reporting the <code>pCustom</code>/<code>pData</code> issue. It should be fixed now.<br>
<br>
About the opening the <code>HTHEME</code> every time: It should work correctly from the technical point of view as long as you don't need to support <code>GetWindowTheme()</code>/<code>SetWindowTheme()</code> in such controls.<br>
<br>
But even then, it can be (much) slower if it results in reloading some 
bigger resources (e.g. images). So it is difficult to tell. It depends 
how many such control you have and how much resource-heavy the theme 
classes you use are. Also different versions of UXTHEME.DLL (on 
different OS versions) may behave differently.<br>
<br>
However, if I apply what Raymond Chen calls psychic debugging, <code>OpenThemeData()</code> likely results in loading of the resources from the theme definition storage just once even when there are multiple <code>HTHEME</code>
 handles referring to those resources living at the same time. (It would
 be wasting potentially a lot of memory if it works differently.) 
Therefore, if my guess is correct, the performance hit may be quite 
small as long as there is other <code>HTHEME</code> handle of the same theme class/subclass.<br>
<br>
For this reason, if you have many such controls using the same theme 
class/subclass, it would be IMHO better if you open and keep one such 
theme class handle globally (for every them class/subclass you need). 
The only complication would then be more complex handling of <code>WM_THEMECHANGED</code>, which should cause the global handle is reopened but but it should not cause storms of <code>CloseThemeData()</code>/<code>OpenThemeData()</code>
 from each control. That can be solved by opening the global handle 
lazily: I.e. when first control needs the theme class (i.e. the global 
handle is <code>NULL</code>) it would open it; otherwise it would do nothing. <code>WM_THEMECHANGED</code> would just close the global handle (and reset it to <code>NULL</code>) so next time any controls wants to use the same class, it gets (re)opened.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637591&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637591&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5637591" data-ref="3_5637591" class="rating-label" name="RateItem_5637591"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5637591/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5637591"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5637591"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637593_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx5637593xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5637593" parent="5637591" thread="5637310" href="https://www.codeproject.com/Messages/5637593/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">20-Jun-19  16:07</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>20-Jun-19  16:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637593_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="5807385" msgid="5637593" votingtype="GoodOrBad" done="true"><a href="#xx5637593xx" onclick="return rateItem(5, 5637593,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5637593xx" onclick="return rateItem(1, 5637593,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5637591);" href="https://www.codeproject.com/Messages/5637591/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Or yet another (and much simpler) idea: Use <code>GetWindowTheme()</code> internally. I.e. make your painting code do something like this:<br>

<div class="pre-action-link" id="premain936918" style="width:100%;display:block;"><span id="prehide936918" onclick="processCodeBlocks.togglePre(936918);">Hide</span>  &nbsp; <span id="preShrink936918" onclick="processCodeBlocks.shrinkExpand(936918);">Shrink</span> <img id="preimg936918" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(936918);">  &nbsp; <span id="copycode936918" onclick="return processCodeBlocks.copyCode(936918);">Copy Code</span></div><pre id="pre936918" style="margin-top: 0px;" class="notranslate">void 
ControlPaint(HWND hWnd, HDC dc)
{
    HTHEME hTheme = GetWindowTheme(hWnd);
    if(hTheme == NULL) {
         hTheme = OpenThemeData(hWnd, _T("classname"));
    }

    ... // paint with the hTheme
}</pre>
<br>
And do not forget to close the theme handle in <code>WM_DESTROY</code> (or <code>WM_NCDESTROY</code>) and <code>WM_THEMECHANGED</code> handler:<br>

<div class="pre-action-link" id="premain235808" style="width:100%;display:block;"><span id="prehide235808" onclick="processCodeBlocks.togglePre(235808);">Hide</span>  &nbsp; <span id="preShrink235808" onclick="processCodeBlocks.shrinkExpand(235808);">Shrink</span> <img id="preimg235808" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(235808);">  &nbsp; <span id="copycode235808" onclick="return processCodeBlocks.copyCode(235808);">Copy Code</span></div><pre id="pre235808" style="margin-top: 0px;" class="notranslate">case WM_CLOSE:
case WM_THEMECHANGED:
{
    HTHEME hTheme = GetWindowTheme(hWnd);
    if(hTheme != NULL)
        CloseThemeData(hTheme);
    break;
}
</pre>
<br>
The only limitation is that any control may remember at most one handle via <code>Get/SetThemeHandle()</code>.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637593&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5637593&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5637593" data-ref="3_5637593" class="rating-label" name="RateItem_5637593"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5637593/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5637593"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5637593"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660499_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx5660499xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5660499" parent="5637593" thread="5637310" href="https://www.codeproject.com/Messages/5660499/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Christopher P Taylor</span><span class="date">8-Sep-19  16:09</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5860511">Christopher P Taylor</a></span></td><td class="date"><span>8-Sep-19  16:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660499_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="5860511" msgid="5660499" votingtype="GoodOrBad" done="true"><a href="#xx5660499xx" onclick="return rateItem(5, 5660499,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5660499xx" onclick="return rateItem(1, 5660499,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5637593);" href="https://www.codeproject.com/Messages/5637593/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Many
 thanks!  It took me a while to get around to it (it required a certain 
amount of reconfiguring my code), but ultimately I went with your second
 proposal and it seems to work well.  <br>
<br>
I'm still working in Win 7, and I've noticed that pretty much all of the
 "themes" provided in my "Personalization" screen are basically the 
same, apart from the ones like "Windows Classic" that turn themes off 
completely.  Accordingly most of the changes I make from 
"Personalization" don't actually result in WM_THEMECHANGED messages.  I 
did 5 minutes of hunting online and still didn't find any themes that 
are truly different from "Windows 7 Basic"/"Aero Windows 7"/etc.  Do you
 have any insight into what exists out there?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660499&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660499&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5660499" data-ref="3_5660499" class="rating-label" name="RateItem_5660499"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5660499/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5660499"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5860511" msgid="5660499"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660639_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx5660639xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5660639" parent="5660499" thread="5637310" href="https://www.codeproject.com/Messages/5660639/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">9-Sep-19  7:37</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>9-Sep-19  7:37&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660639_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="5807385" msgid="5660639" votingtype="GoodOrBad" done="true"><a href="#xx5660639xx" onclick="return rateItem(5, 5660639,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5660639xx" onclick="return rateItem(1, 5660639,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5660499);" href="https://www.codeproject.com/Messages/5660499/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>There
 are only very few themes done by Microsoft for any particular Windows 
version and they usually differ only in some colors. So the biggest 
differences are only between the Windows versions.<br>
<br>
There are also tons of themes done by 3rd party people with very various
 level of quality and compatibility. But AFAIK they all require some 
hacked/patched system DLL (probably the UXTHEME.DLL itself I guess), 
because it tries to check/verify that the theme resource-only DLLs are 
signed with Microsoft's own digital signature. But I have never been 
interested much in this so I cannot provide any details.<br>
<br>
To conclude, the capability to make new themes is likely intended only 
for their internal purposes, and I tend to think they will never do too 
many different themes because of compatibility reasons: There are too 
many apps using some custom controls which could break easily.<br><br><br><div class="modified">modified  9-Sep-19 20:03pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660639&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660639&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5660639" data-ref="3_5660639" class="rating-label" name="RateItem_5660639"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5660639/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5660639"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5660639"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660955_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="110px"><a name="xx5660955xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5660955" parent="5660639" thread="5637310" href="https://www.codeproject.com/Messages/5660955/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Christopher P Taylor</span><span class="date">9-Sep-19  20:24</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5860511">Christopher P Taylor</a></span></td><td class="date"><span>9-Sep-19  20:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5660955_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:110px;"><span class="voteform vertical" ownerid="5860511" msgid="5660955" votingtype="GoodOrBad" done="true"><a href="#xx5660955xx" onclick="return rateItem(5, 5660955,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5660955xx" onclick="return rateItem(1, 5660955,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5660639);" href="https://www.codeproject.com/Messages/5660639/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Interesting
 stuff!  The way the API is written kind of forces programmers to 
pretend that there will be all sorts of different themes out there 
getting swapped in and out constantly, but based on what you just wrote 
it seems like it's all just a charade to a large extent...  Anyway, 
thanks again!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660955&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5660955&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5660955" data-ref="3_5660955" class="rating-label" name="RateItem_5660955"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5660955/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5660955"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5860511" msgid="5660955"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5661795_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="120px"><a name="xx5661795xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5661795" parent="5660955" thread="5637310" href="https://www.codeproject.com/Messages/5661795/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Christopher P Taylor</span><span class="date">12-Sep-19  3:17</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5860511">Christopher P Taylor</a></span></td><td class="date"><span>12-Sep-19  3:17&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5661795_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:120px;"><span class="voteform vertical" ownerid="5860511" msgid="5661795" votingtype="GoodOrBad" done="true"><a href="#xx5661795xx" onclick="return rateItem(5, 5661795,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5661795xx" onclick="return rateItem(1, 5661795,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5660955);" href="https://www.codeproject.com/Messages/5660955/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>In
 order to make the record complete for others, I should report that upon
 further testing, the scheme we've been discussing does not work so 
well.  I had a situation where I created 3 owner-drawn BUTTONs, and for 
each of them, function OpenThemeData got called during the first 
drawing, as planned.  The trouble was, OpenThemeData returned the exact 
same HTHEME in all 3 cases, associating it with the respective HWNDs.  
At some later point, for reasons I don't really understand (nothing to 
do with any activity in the control panel), one of the buttons received a
 random WM_THEMECHANGED, which resulted in CloseThemeData getting called
 on the HTHEME.  The next time a button was drawn, GetWindowTheme 
returned the same HTHEME as ever, which, having been closed, failed to 
produce the appropriate background images --- solid black buttons were 
the result  <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/smiley_dead.gif" alt="Dead | X|" align="top"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5661795&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5661795&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5661795" data-ref="3_5661795" class="rating-label" name="RateItem_5661795"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5661795/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5661795"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5860511" msgid="5661795"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5661796_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="130px"><a name="xx5661796xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5661796" parent="5661795" thread="5637310" href="https://www.codeproject.com/Messages/5661796/Re-Great-article-comment-and-question.aspx">Re: Great article - comment and question</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Christopher P Taylor</span><span class="date">12-Sep-19  3:20</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5860511">Christopher P Taylor</a></span></td><td class="date"><span>12-Sep-19  3:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5661796_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:130px;"><span class="voteform vertical" ownerid="5860511" msgid="5661796" votingtype="GoodOrBad" done="true"><a href="#xx5661796xx" onclick="return rateItem(5, 5661796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5661796xx" onclick="return rateItem(1, 5661796,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5860511);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5661795);" href="https://www.codeproject.com/Messages/5661795/Re-Great-article-comment-and-question.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>My
 solution at this point is to start the run by setting up an invisible 
global window hwndDummy, invoking OpenThemeData(hwndDummy, L"BUTTON"), 
and assigning the result to a global hthemeButton --- all Buttons then 
make use of the latter when drawing.  The window-class of hwndDummy 
doesn't seem to matter, but I do subclass it to respond to 
WM_THEMECHANGED, so that CloseThemeData(hthemeButton) and a fresh 
hthemeButton = OpenThemeData(hwndDummy, L"BUTTON") can be invoked.  
(Given what we discussed most recently about the unlikelihood of genuine
 theme changes, it's a little hard to get inspired about this last step,
 but I took the trouble regardless.)  So far so good with this new 
system...  I know it might not be safe to use globals this way in 
multithreaded settings, but it wouldn't be too hard to adapt the scheme 
to assign hwndDummy and hthemeButton values on a per-thread basis.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5661796&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5661796&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5637310" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5661796" data-ref="3_5661796" class="rating-label" name="RateItem_5661796"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5661796/Re-Great-article-comment-and-question.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5661796"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5860511" msgid="5661796"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5381323_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5381323xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5381323" parent="0" thread="5381323" href="https://www.codeproject.com/Messages/5381323/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">XTAL256</span><span class="date">4-Apr-17  23:09</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3428352">XTAL256</a></span></td><td class="date"><span>4-Apr-17  23:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5381323_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3428352" msgid="5381323" votingtype="GoodOrBad" done="true"><a href="#xx5381323xx" onclick="return rateItem(5, 5381323,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3428352);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5381323xx" onclick="return rateItem(1, 5381323,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3428352);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Very informative and well written<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5381323&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5381323" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5381323" data-ref="3_5381323" class="rating-label" name="RateItem_5381323"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5381323/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5381323"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3428352" msgid="5381323"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5197325_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5197325xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5197325" parent="0" thread="5197325" href="https://www.codeproject.com/Messages/5197325/Great-resource.aspx">Great resource</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Larry Weinheimer</span><span class="date">5-Feb-16  19:15</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10043802">Larry Weinheimer</a></span></td><td class="date"><span>5-Feb-16  19:15&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5197325_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10043802" msgid="5197325" votingtype="GoodOrBad" done="true"><a href="#xx5197325xx" onclick="return rateItem(5, 5197325,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',10043802);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5197325xx" onclick="return rateItem(1, 5197325,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',10043802);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Somethings get harder to find out about, this is valuable to have.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5197325&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5197325&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5197325" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5197325" data-ref="3_5197325" class="rating-label" name="RateItem_5197325"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5197325/Great-resource.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5197325"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="10043802" msgid="5197325"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5159730_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5159730xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5159730" parent="0" thread="5159730" href="https://www.codeproject.com/Messages/5159730/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Member 11165867</span><span class="date">13-Nov-15  2:07</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11165867">Member 11165867</a></span></td><td class="date"><span>13-Nov-15  2:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5159730_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11165867" msgid="5159730" votingtype="GoodOrBad" done="true"><a href="#xx5159730xx" onclick="return rateItem(5, 5159730,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',11165867);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5159730xx" onclick="return rateItem(1, 5159730,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',11165867);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Amazing<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5159730&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=5159730&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5159730" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5159730" data-ref="3_5159730" class="rating-label" name="RateItem_5159730"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5159730/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5159730"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="11165867" msgid="5159730"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4841761_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4841761xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4841761" parent="0" thread="4841761" href="https://www.codeproject.com/Messages/4841761/Thank-you.aspx">Thank you</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">B2kguga</span><span class="date">14-Jun-14  18:17</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=300272">B2kguga</a></span></td><td class="date"><span>14-Jun-14  18:17&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4841761_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="300272" msgid="4841761" votingtype="GoodOrBad" done="true"><a href="#xx4841761xx" onclick="return rateItem(5, 4841761,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',300272);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4841761xx" onclick="return rateItem(1, 4841761,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',300272);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Thank you !!!<br>
<br>
You are a genius. I was looking for some ways to better understand to use the visual styles.<br>
<br>
Do you have plans to make mCtrl with more features such as a progressbar, richededi controls, listboxes, systemtabs etc ?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4841761&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4841761&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4841761" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4841761" data-ref="3_4841761" class="rating-label" name="RateItem_4841761"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/4841761/Thank-you.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4841761"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="300272" msgid="4841761"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4788407_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4788407xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4788407" parent="0" thread="4788407" href="https://www.codeproject.com/Messages/4788407/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">kanalbrummer</span><span class="date">28-Mar-14  6:13</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8480671">kanalbrummer</a></span></td><td class="date"><span>28-Mar-14  6:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4788407_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8480671" msgid="4788407" votingtype="GoodOrBad" done="true"><a href="#xx4788407xx" onclick="return rateItem(5, 4788407,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',8480671);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4788407xx" onclick="return rateItem(1, 4788407,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',8480671);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Very well written article, well structured. Thanks a lot for sharing your experience!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4788407&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4788407&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4788407" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4788407" data-ref="3_4788407" class="rating-label" name="RateItem_4788407"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4788407/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4788407"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="8480671" msgid="4788407"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618420_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4618420xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4618420" parent="0" thread="4618420" href="https://www.codeproject.com/Messages/4618420/Great-Work.aspx">Great Work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Tom Clement</span><span class="date">22-Jul-13  19:17</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-mentor-16.gif" title="mentor" alt="mentor" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=383127">Tom Clement</a></span></td><td class="date"><span>22-Jul-13  19:17&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618420_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="383127" msgid="4618420" votingtype="GoodOrBad" done="true"><a href="#xx4618420xx" onclick="return rateItem(5, 4618420,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',383127);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4618420xx" onclick="return rateItem(1, 4618420,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',383127);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Thanks for contributing this article.<br>
<div class="signature">Tom Clement<br>
Serena Software, Inc.<br>
<a target="_blank" title="New Window" href="http://www.serena.com/" rel="nofollow noopener">www.serena.com</a><br>
<br>
<small><a href="http://www.codeproject.com/script/articles/list_articles.asp?userid=383127" rel="nofollow noopener">articles</a>[<a target="_blank" title="New Window" href="http://www.codeproject.com/script/articles/list_articles.asp?userid=383127" rel="nofollow noopener">^</a>]</small></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4618420&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4618420&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4618420" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4618420" data-ref="3_4618420" class="rating-label" name="RateItem_4618420"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4618420/Great-Work.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4618420"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="383127" msgid="4618420"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617441_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4617441xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4617441" parent="0" thread="4617441" href="https://www.codeproject.com/Messages/4617441/Excellent-well-written-article.aspx">Excellent, well written article!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Espen Harlinn</span><span class="date">21-Jul-13  17:02</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-mentor-16.gif" title="mentor" alt="mentor" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=22364">Espen Harlinn</a></span></td><td class="date"><span>21-Jul-13  17:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617441_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="22364" msgid="4617441" votingtype="GoodOrBad" done="true"><a href="#xx4617441xx" onclick="return rateItem(5, 4617441,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',22364);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4617441xx" onclick="return rateItem(1, 4617441,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',22364);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Excellent, I enjoyed reading this <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/smiley_biggrin.gif" alt="Big Grin | :-D" align="top"> <br>
<div class="signature"><a href="http://harlinn.com/" rel="nofollow noopener">Espen Harlinn</a><br>
Principal Architect, Software - <a href="http://goodtech.no/" rel="nofollow noopener">Goodtech Projects &amp; Services AS</a><br>
<em><br>
Projects promoting programming in "natural language" are intrinsically doomed to fail. <b>Edsger W.Dijkstra</b></em></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617441&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617441&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617441" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4617441" data-ref="3_4617441" class="rating-label" name="RateItem_4617441"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4617441/Excellent-well-written-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4617441"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="22364" msgid="4617441"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618193_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4618193xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4618193" parent="4617441" thread="4617441" href="https://www.codeproject.com/Messages/4618193/Re-Excellent-well-written-article.aspx">Re: Excellent, well written article!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">22-Jul-13  14:24</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>22-Jul-13  14:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618193_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4618193" votingtype="GoodOrBad" done="true"><a href="#xx4618193xx" onclick="return rateItem(5, 4618193,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4618193xx" onclick="return rateItem(1, 4618193,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4617441);" href="https://www.codeproject.com/Messages/4617441/Excellent-well-written-article.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4618193&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4618193&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617441" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4618193" data-ref="3_4618193" class="rating-label" name="RateItem_4618193"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4618193/Re-Excellent-well-written-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4618193"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4618193"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617282_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4617282xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4617282" parent="0" thread="4617282" href="https://www.codeproject.com/Messages/4617282/Great-article.aspx">Great article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Richard MacCutchan</span><span class="date">21-Jul-13  6:35</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-protector-16.png" title="protector" alt="protector" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=767687">Richard MacCutchan</a></span></td><td class="date"><span>21-Jul-13  6:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617282_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="767687" msgid="4617282" votingtype="GoodOrBad" done="true"><a href="#xx4617282xx" onclick="return rateItem(5, 4617282,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',767687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4617282xx" onclick="return rateItem(1, 4617282,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',767687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Such a pleasure to see an article that can be instantly approved for publication. I must read the full series when I get time.<br>
<div class="signature">Use the best guess</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617282&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617282&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617282" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4617282" data-ref="3_4617282" class="rating-label" name="RateItem_4617282"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4617282/Great-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4617282"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="767687" msgid="4617282"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617286_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4617286xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4617286" parent="4617282" thread="4617282" href="https://www.codeproject.com/Messages/4617286/Re-Great-article.aspx">Re: Great article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">21-Jul-13  7:03</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>21-Jul-13  7:03&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617286_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4617286" votingtype="GoodOrBad" done="true"><a href="#xx4617286xx" onclick="return rateItem(5, 4617286,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4617286xx" onclick="return rateItem(1, 4617286,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4617282);" href="https://www.codeproject.com/Messages/4617282/Great-article.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div><strike>Thank
 you, but something is wrong. "My Articles" claims the article as 
published, but it links to some revision which says: "This is an old 
version of the currently published article." Ditto when going from the 
main page (<a href="http://www.codeproject.com/script/Articles/Latest.aspx" rel="nofollow noopener">http://www.codeproject.com/script/Articles/Latest.aspx</a>[<a href="http://www.codeproject.com/script/Articles/Latest.aspx" target="_blank" title="New Window" rel="nofollow noopener">^</a>])<br>
<br>
I already noticed something wrong with the revisions earlier and posted a question here:<br>
<a href="http://www.codeproject.com/Messages/4616441/Confused-from-revision-history-of-an-article-being.aspx" rel="nofollow noopener">http://www.codeproject.com/Messages/4616441/Confused-from-revision-history-of-an-article-being.aspx</a>[<a href="http://www.codeproject.com/Messages/4616441/Confused-from-revision-history-of-an-article-being.aspx" target="_blank" title="New Window" rel="nofollow noopener">^</a>]</strike><br>
<br>
UPDATE: Seems ok now.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617286&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617286&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617282" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4617286" data-ref="3_4617286" class="rating-label" name="RateItem_4617286"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4617286/Re-Great-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4617286"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4617286"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617287_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx4617287xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4617287" parent="4617286" thread="4617282" href="https://www.codeproject.com/Messages/4617287/Re-Great-article.aspx">Re: Great article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Richard MacCutchan</span><span class="date">21-Jul-13  7:07</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/icn-protector-16.png" title="protector" alt="protector" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=767687">Richard MacCutchan</a></span></td><td class="date"><span>21-Jul-13  7:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617287_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="767687" msgid="4617287" votingtype="GoodOrBad" done="true"><a href="#xx4617287xx" onclick="return rateItem(5, 4617287,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',767687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4617287xx" onclick="return rateItem(1, 4617287,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',767687);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4617286);" href="https://www.codeproject.com/Messages/4617286/Re-Great-article.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>This
 now shows as an old version of a currently published article, which I 
also find confusing. I would suggest posting your question in <a href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx" rel="nofollow noopener">http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx</a>[<a href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx" target="_blank" title="New Window" rel="nofollow noopener">^</a>].<br>
<div class="signature">Use the best guess</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617287&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1837298&amp;select=4617287&amp;floc=/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617282" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4617287" data-ref="3_4617287" class="rating-label" name="RateItem_4617287"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4617287/Re-Great-article.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4617287"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="767687" msgid="4617287"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 3-Dec-19  18:57 &nbsp; &nbsp; Last Update: 3-Dec-19  19:03</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?fid=1837298&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=21"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=620045">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=620045">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=620045">Revisions (30)</a></div>
<div><a href="#_comments">Comments (21)</a></div>
<div>Posted 21 Jul 2013</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win32" data-id="99">Win32</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win64" data-id="100">Win64</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/VS2010" data-id="314">VS2010</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/custom-controls" data-id="781">custom-controls</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>87K views</div><div>4.5K downloads</div><div>101 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-showindicator="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=446090"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=446090"  width="160px" height="200px" target="_blank"/></a></noscript><div style="height: 0px; width: 0px; box-sizing: border-box; border: 0px none; font-size: 0px; display: none;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-4" data-google-query-id="COfd1avLmuYCFdfI4wcdllULIQ"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_1__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Visual-Studio, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=446090"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=446090"  width="160px" height="600px" target="_blank"/></a></noscript><div style="height: 600px; width: 160px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-5" data-google-query-id="CPa21qvLmuYCFRHH4wcdajkC7A"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="3" data-load-complete="true" width="160" height="600" frameborder="0"></iframe></div></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/620045/Custom-Controls-in-Win-API-Visual-Styles?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2013 by Martin Mitáš<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2019 <br>
                <br>
				Web04 
				2.8.191122.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="Custom%20Controls%20in%20Win32%20API%20%20Visual%20Styles%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 620045,2,1,true,true,0,'LargeStars', null, 5807385);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1837298,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 620045
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(620045,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 5807385
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : false,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>