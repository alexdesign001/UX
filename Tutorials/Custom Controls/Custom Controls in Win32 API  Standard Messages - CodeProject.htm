<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Custom Controls in Win32 API: Standard Messages - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/Main.css">

    <script src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/amp4ads-host-v0.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/osd.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pubads_impl_modern_rendering_2019112101.js"></script><script async="" type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/jquery-2.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Make your control answer to the questions system or application may ask.">
<meta name="Keywords" content="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,Windows API,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Martin Mitáš">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/Custom-Controls-in-Win-API-Standard-Messages.htm">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages">
<meta property="og:title" content="Custom Controls in Win32 API: Standard Messages">
<meta property="og:description" content="Make your control answer to the questions system or application may ask.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages"
   },
  "headline": "Custom Controls in Win32 API: Standard Messages",
  "url": "https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages",
  "discussionUrl": "https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C,Windows,Win32,Win64,Dev,VS2010,custom-controls",
  "commentCount": "5",
  "editor" : {
    "@type" : "Person",
    "name" : "Martin Mitáš",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Make your control answer to the questions system or application may ask.",
  "articleSection": "Windows API",
  "author" : [{
      "@type" : "Person",
      "name" : "Martin Mitáš",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
    }],
  "datePublished": "2013-07-30",
  "dateCreated": "2013-07-30",
  "dateModified": "2014-03-17"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.94,
    "ratingCount" : 35,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/vista/",
      "name" : "Windows API"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/ga.js"></script>


<style type="text/css"></style><link rel="preload" href="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/integrator.js" as="script"><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/integrator.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pubads_impl_modern_2019112101.js" async=""></script><link rel="prefetch" href="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/container.htm"></head>	

<body class="firefox firefox0">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,379,797 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 813" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">813</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e5d2e6ae-036a-48c4-9374-8e897a099dbe">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=77801"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=77801"  width="728px" height="90px" target="_blank"/></a></noscript><div style="height: 90px; width: 728px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-1" data-google-query-id="CNjd46_LmuYCFQ5jwQodrTsG_A"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe style="border: 0px none; vertical-align: bottom;" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/container.htm" id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" data-is-safeframe="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/undo.png" title="Report Ad" style="z-index: 1000; position: relative; left: 0px; top: -90px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px none; padding: 0px; height: 14px; width: 14px;" align="left"></div><div style="display: none; width: 728px; height: 90px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px none;"><div class="sendReportContainer" style="padding-left: 2px; display:block; line-height:initial !important"><div style="display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial"><b>Don't like this Ad?</b></div><div class="dropzone" style="margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal" contenteditable="true">1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here</div><div style="margin-left:10px; display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option selected="selected">Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select> &nbsp;<input type="button" disabled="disabled" class="reportButton" style="padding: 0px !important" value="Report"></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/dm-logo-150x23.png" style="max-width:100%;position:absolute; right:10px; top:10px;"></a></div></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search  subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/vista/">Windows API</a> » <a href="https://www.codeproject.com/KB/vista/#General">General</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_624495_18" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?display=Print" class="tooltip" title="">
   <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="0fFEvM9MLKpTIALCJUpd33m5OzFQWzdjaqBGOI+mrBgELJs1R04tbz/6hXlvwTgaWMoIVo8/OW5f3+CkQApmKnbuW33S3tL12NKUNtmM8ZG9pcAX8EUfRgd9+1VmCML/jK9urxd09X1eFlN4QYygTjG8ZUfOYPWijgw+teFVOJ8M2UNI0AwBV81YaiM9Ko2dcV0Hmw4FEurayVsSVN2c/gLMrCsHt0Vvlgb57Q3YwMMVNiIw5xC1hLEjQ79b+CICqJeFH5L1MfQHlJX6OsVlPti24MTwdpgiW/MvnKfIsze76OXCw2h4h6al3haRz70iI/wJ4j02E0yqqVCjA3SkyUCTBsKUlBeiD/sp7/mY5uktC+q6i9p1I2y7bnlVyvAmsOKdb3m7UNYASk1BE4OrAdahIjxjvEPtBuJDyGRqT3UpYqLhQjwDVEFCq/Nu5xSPXtbY2dVBCX4elkLqym7w099fQuFEg0aiozJc6+iSY735lFVZJQY2umFJETmp3IkIWpZiTzmrNfAKJE6xHAqKGh2gAAnN8Vf0JFRJ3HNGPmf+SZHiL3i9u8lcL9Gu7H12OqnWq1YjA3fYqjpsWKaa9B4foSTHIZ4xEgenmTlvaK9AlCIPpt2fvboX5uNUvgVr6T/WrvG1JFFi+ZFlr2cueA1iiHavDsJkzxwFKV79HbhBUQvGL8zDDG8DDwdnRTUf+X+jkhp7SB5tAcOnovWwp+6Fhu2sXUCo/6BsvrNK8OTtVeJeZhGzaMdLT8nGwlE09y840sRKArg9uiAlu67/r4SwumP94a4NK41xr+FO19ZP9WmcGK4YImR5il0wB6K7SkA/xAO449k0LashgzFhjn7RVuADNKmiz4JWGTbQhTUQquZxwvnal4nnzeNWEXCwORYe3ubVU4o3MbNenL6Em0+t7Sli79e6cFA1bwzVt6vg3NVNgfg3C6piZ61EnRRlcxWdZKMM6pZgH1fCT0fiXOH0ieVZOeZ/NiH5sa01qneyv2n0lQ88hO86mtVkpLz0cOSZBxaDv9fUgazmi2BoDzkQxhJAU0/wdgKRPY19A3z+4aCbrgwCisOhcnhHmBYFHHSxVsWPI3h7oOmm+shY7cdS4RljRIdqTeyMGc8H1SwzSJqOO8wl+j4wp7/Y73aJg0ldB2pmTH9Z8Grbr/vicYKDyLh8pw4eLsK0E2P8gHr9KP994LkSrq9uoq1AjDgEmnkmBzixqRYFTusJK8mecLY1Eh681nR9zawhAaI2UB+3W8FX4l97WbyzkYeYaej1tHGHvTUMpDMO2W1kMoAmUaY7Yd/1f8g2smSDuegmnijsQyeLqN+Ky+7a9ZU2YSs2xGekDAu52TevpuxINDhOL3JVUbsxBQxpjrL7DVB5yp/ZJAzwHlSeScOvueRha4SZlONkB6DmZuxMYVRR+ufb+zfsxqHFFDimD4ujfFIahLi3N+pV6SYXe0Aq/yrms9bOR8h5hAauKIsg/vILijo3HAL/M9OGWajy8B5wmXvdHWScxAEx4MkS4y6Vtgw1RNPE/fJuvuSMfPThWFaElrwcbAwQvt34XVc0Vpe30DLo8+i2apigAIPZiyFMu/HJ37iBJI6iqO2M02i6jkA5tcnQ7o6XW33w9QxESOCUU0eSCPTWsv1oz2X4cMB4SnNjo/rVkP5nNABUxqOdnutlogBwsLxhUNxpRAW3QzXXXCzPRH6w/QW/s5zwHPe2yMhOpS+iJ3sWzlE9VCNlgW4Vr7Ds4P0+ANToa9XHK6mlUA0bo9mPVJUdiskPRchxODls/MWf33ilutgTjb+p86T8je9/G6vZH1Y1bh31aEdeFLPKqlcC/pt7h1S0BY7HnlcgQlS7pK0jRT2eKByF1VEsrkxsxTSSD8wlhKMjsq2dNjtoQaZ8nSXJgaVwh6QjF8p6HWZKH2Fbsvp4TBogajQ/PJmtDrkM0paBDL5FiK7uRCXOpU5r5xexdrNID04x921e03UJVW4oZx4GYlBIeqWZiliGUML1Z55rpu0pwnMvyYtm2ltOC8opbdUba43dEkljUO6g/gLagjMXj4ODzzy19GNO4T6zf57s70174mlYyMWz1UKSqje06EApOMN0CLVpsJIDiTeqxAnSoDCTOs+KW5K+3NXV28zq24CuQX1fQR9Zd/X3lw1QyWQ+574UT89C98GOuITVtoahqya24cDiethls63AsXzDDjlme4nTNjEzZhrYIHpaU9Lr92X1obrE1asE5cmyOE0h2e47ew74Z2zO1AX3bXhq7YAVM7dgMb6OklsAPK8UsSTZ4g1XqKI8ilFZJYz1mBH1FHc8pLkOehM+It9ABweJXkWwfQ7/NYiwcd6VjBufBk9iTjBbFvT6H3H7BWzU0Psf3kohVZfObP3msJK4Tr6QOeYqfTPgQcNFZB6QSgwm+XpcAdPrYXZcFprA5s3vdUZVUQYZsOBrJnikU5VgMj+LESwkRp0QV0sE/ktV9zwoJz8eiXVR0e7Kheq440uVC0vTbzlUObbYsGJ4u6c44wqLubN1kLyiFxj8LtshBaCz01vufvJ0q3p2/C+VEApUwMPFeQFxjG56wB473qw9KpQUOHR+plXtU/dYi1e8ZaOVcUxoNMuDtf68r0OATbJRpFnJoVY/t9pM5Jia570lhgg8GYAMpB074ioDJzlUj+NP/oiYp4UkekhD7ciY8PR6qCD8JSxm/b/2qe5IXRVfctP4cPIBekwhllhLWTpB86QOHMl35OBolsHUSftswX1NrEdOFesoiEUZwWrFVXb29un7OxjxYa3+rlrbTSCYw00O">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Custom Controls in Win32 API: Standard Messages</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" id="ctl00_avatar" class="avatar">

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385" rel="author">Martin Mitáš</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_624495">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="35">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:118px;height:24px;" class="clipped align-left float-left"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:2px;height:24px;position:relative" class="clipped"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.94  (35 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.94  (35 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">17 Mar 2014</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Make your control answer to the questions system or application may ask.</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
	<li><a href="https://www.codeproject.com/KB/vista/624495/button.zip">Download custom control demo - 67.6 KB</a></li></ul>

<h2>Articles in this series</h2>

<ul>
	<li><a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">Custom Controls in Win32 API: The Basics</a></li>	<li><a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">Custom Controls in Win32 API: The Painting</a></li>	<li><a href="http://www.codeproject.com/Articles/620045/Custom-Controls-in-Win32-API-Visual-Styles">Custom Controls in Win32 API: Visual Styles</a></li>	<li>Custom Controls in Win32 API: Standard Messages</li>	<li><a href="http://www.codeproject.com/Articles/646482/Custom-Controls-in-Win-API-Control-Customization">Custom Controls in Win32 API: Control Customization</a></li>	<li><a href="http://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">Custom Controls in Win32 API: Encapsulation of Customized Controls</a></li>	<li><a href="http://www.codeproject.com/Articles/1042516/Custom-Controls-in-Win-API-Scrolling">Custom Controls in Win32 API: Scrolling</a></li></ul>

<h2>Introduction</h2>

<p>In previous articles we engaged in painting the controls. Today, we 
are going to pay some attention to handling many messages which mediate 
interaction between the control, its dialog or other parent window, and 
also between the control and the operating system itself.</p>

<p>Note that, as all the articles in this series, this is not a 
reference documentation. This article is not meant as a replacement of 
MSDN. It is meant as complementary to it. MSDN often describes what the 
message is about, how its parameters are passed to it via <code>WPARAM</code> and <code>LPARAM</code>
 and I cannot see any sense in repeating it here. Instead, this article 
provides just an overview of messages controls often need to implement, 
with some hints how to do that from point of view of the control, not 
application attempting to just send the message to a control.</p>

<h2>Unicode and ANSI Strings</h2>

<p>Before we start talking about the number of messages, lets take a 
little talk on strings and how standard controls handle the Unicode vs. 
ANSI duality of the Win32 API, as that obviously has some impact how the
 custom controls should handle string parameters too.</p>

<p><strong>Note:</strong> <em>Unicode</em> in context of Win32 API means
 UTF-16 encoding in little-endian byte order. (On Windows 2000, it was 
only UCS-2, i.e. subset of UTF-16 without the support for surrogate 
pairs.) <em>Windows ANSI</em>, or just <em>ANSI</em> in Win32 API context, is a misnomer meaning a byte-oriented encoding determined by current <em>code page</em>.
 Unlike in Unicode, the same sequence of bytes has different meaning in 
different code pages and, often, may be invalid. In general, all new 
code should prefer to use Unicode, at least internally.</p>

<p>Most control-specific messages which take string as a parameter (or a
 pointer to structure having string as a member) are actually two 
distinct messages. The Unicode-flavored message has a suffix <code>W</code>, the ANSI-flavored one has a suffix <code>A</code>. The preprocessor macro <code>UNICODE</code> then in public header controls which one is used when application source uses the message name without either of the suffices.</p>

<p>However that is mainly true about control-specific messages. You can find many examples of this approach in <em>commctrl.h</em> for messages responsible to insert or set items of controls like list view or tree view.</p>

<p>The standard messages, in particular <code>WM_NCCREATE</code>, <code>WM_CREATE</code>, <code>WM_SETTEXT</code> and <code>WM_GETTEXT</code>,
 work a bit differently. There are no Unicode/ANSI flavors of these 
messages. Instead the system remembers whether the window class was 
registered with <code>RegisterClassW()</code> or <code>RegisterClassA()</code> (or their <code>RegisterClassEx()</code> counterparts). Depending on this, we call the resulted <code>HWND</code>s to be <em>Unicode windows</em> or <em>ANSI windows</em>.</p>

<p>All the relevant functions like <code>CreateWindow()</code>, <code>SetWindowText()</code> or <code>GetWindowText()</code> have the Unicode or ANSI flavor (again, suffix <code>W</code> or <code>A</code>
 respectively in the function name). Whenever the function is called, it
 makes automatically the required conversion to pass the string to the 
window procedure in the corresponding form.</p>

<p>As globalization advances, internationalization and localization are 
natural demands on any modern software. Hence Unicode rules more and 
more this world and the standard controls internally always work in 
Unicode (at least since Windows 2000). I recommend following this rule 
of thumb in your controls, unless you have very strong reason to do 
otherwise.</p>

<p>That, in general, means to follow these steps:</p>

<ul>
	<li>Register your control with Unicode flavor of <code>RegisterClass()</code>.</li>	<li>Interpret strings in the standard messages as Unicode.</li>	<li>Hold strings in control's structures in Unicode.</li>	<li>When
 implementing new control-specific message, implement it either for 
Unicode, or implement two distinct messages. The code below demonstrates
 this.</li></ul>

<p><strong>Note:</strong> The first three points of the list can be achieved by using explicitly the <code>W</code>-flavors of the functions like <code>RegisterClassW()</code>
 etc., or with using the Unicode resolution macros (the name without any
 suffix) and building the project as Unicode one by using appropriate 
compiler options. In Visual Studio, this can be configured in project 
properties, gcc compiler has the option <em>-municode</em> for this purpose.</p>

<div class="pre-action-link" id="premain192881" style="width:100%;display:block;"><span id="prehide192881" onclick="processCodeBlocks.togglePre(192881);">Hide</span>  &nbsp; <span id="preShrink192881" onclick="processCodeBlocks.shrinkExpand(192881);">Shrink</span> <img id="preimg192881" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(192881);">  &nbsp; <span id="copycode192881" onclick="return processCodeBlocks.copyCode(192881);">Copy Code</span></div><pre id="pre192881" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.h
 * (public control interface) */</span>

...

<span class="code-preprocessor">#define XXM_SOMESTRINGMESSAGEW     (WM_USER+100)
</span><span class="code-preprocessor">#define XXM_SOMESTRINGMESSAGEA     (WM_USER+101)
</span><span class="code-preprocessor">#ifdef UNICODE
</span>    <span class="code-preprocessor">#define XXM_SOMESTRINGMESSAGE     XXM_SOMESTRINGMESSAGEW
</span><span class="code-preprocessor">#else
</span>    <span class="code-preprocessor">#define XXM_SOMESTRINGMESSAGE     XXM_SOMESTRINGMESSAGEA
</span><span class="code-preprocessor">#endif
</span>
...


<span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>
<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {

        ...

        <span class="code-keyword">case</span> XXM_SOMESTRINGMESSAGEW:
            ... <span class="code-comment">//</span><span class="code-comment"> Handle input (WPARAM/LPARAM) as Unicode.</span>
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        <span class="code-keyword">case</span> XXM_SOMESTRINGMESSAGEA:
            ... <span class="code-comment">//</span><span class="code-comment"> Handle input (WPARAM/LPARAM) as ANSI.</span>
                <span class="code-comment">//</span><span class="code-comment"> (Assuming the control holds the strings in Unicode,</span>
                <span class="code-comment">//</span><span class="code-comment"> this usually involves converting the string with</span>
                <span class="code-comment">//</span><span class="code-comment"> MultiByteToWideChar() (when string is input parameter)</span>
                <span class="code-comment">//</span><span class="code-comment"> or WideCharToMultiByte() (output parameter).</span>
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        ...

    }
}</pre>

<p>Notifications handle the Unicode and ANSI strings yet differently and we will talk about it later by the end of this article.</p>

<h2>Control Creation and Destruction</h2>

<p>We already touched the topic of control creation and destruction in the <a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">1st part of this series</a>. However lets take a look on it a little bit closer.</p>

<p>The message <code>WM_NCCREATE</code> is the very first message the control gets during its life time. Correspondingly, the message <code>WM_NCDESTROY</code>
 is the last one. For custom control implementation, these messages are 
appropriate for allocation and setup of resources the control needs 
(e.g. some structure to hold the control's internal data and state), or 
freeing it respectively.</p>

<p>Note that for <code>WM_NCCREATE</code>, <code>DefWindowProc()</code> sets window text propagated from <code>CreateWindow()</code> via <code>LPARAM</code> as <code>CREATESTRUCT::lpszName</code>. If your control works with window text, you should propagate the message to <code>DefWindowProc()</code>. More about window text will be discussed later in a dedicated section later in this article.</p>

<p>During window creation, i.e. in the context of <code>CreateWindow()</code> (and assuming nothing fails during the creation), the messages <code>WM_NCCREATE</code> and <code>WM_CREATE</code> are sent. But some more messages can be sent between the two (typically, <code>WM_NCCALCSIZE</code>) and also after <code>WM_CREATE</code> (e.g. <code>WM_SIZE</code>, <code>WM_MOVE</code>, <code>WM_SHOWWINDOW</code>). Therefore, <code>WM_NCCREATE</code>
 should do the minimal work to have its data in a consistent state (that
 usually means allocating the structure for the state, and initializing 
it to some default values. That guarantees other message handlers can 
use the data without any problem.</p>

<p>As a rule of thumb, most of the other (less critical) setup of the control should be handled in <code>WM_CREATE</code>. So, for example, non-essential resources of the controls should be initialized to <code>NULL</code> in <code>WM_NCCREATE</code> and allocated thenafter in <code>WM_CREATE</code>.
 Especially if the resource allocation involves calling some other 
Win32API functions: They may resolve to sending another messages to the 
control and this design then guarantees the control data is in a 
consistent state and it helps to avoid subtle bugs. Some setup, can be 
deferred even further into other messages like <code>WM_SIZE</code> (e.g. if a complex control needs to compute some layout) and other appropriate message handlers.</p>

<p>When the window is being destroyed, i.e. in the context of <code>DestroyWindow()</code>, the control gets <code>WM_DESTROY</code> followed by <code>WM_NCDESTROY</code>. It is good practice to undo in <code>WM_NCDESTROY</code> what <code>WM_NCCREATE</code> did, and in <code>WM_DESTROY</code> what <code>WM_CREATE</code> did. I also recommend that <code>WM_DESTROY</code> keeps the control in consistent state, especially that all free'd pointers in <code>CustomData</code> structure are reset to <code>NULL</code>.</p>

<p><strong>Note:</strong> <code>WM_NCDESTROY</code> is sent even if previously the message <code>WM_NCCREATE</code> failed (i.e. if it returned <code>FALSE</code>). Also <code>WM_DESTROY</code> is sent even if <code>WM_CREATE</code> failed (i.e. returned <code>-1</code>). It has impact on error paths, as the code excerpt below demonstrates.</p>

<p>Special care must be taken if the control is implemented by 
customizing an existing window class. Therefore good practice is to call
 propagate <code>WM_NCCREATE</code> and <code>WM_CREATE</code> to 
original window procedure before handling it locally in the derived one.
 However that is another topic and we will explore this another time.</p>

<div class="pre-action-link" id="premain368578" style="width:100%;display:block;"><span id="prehide368578" onclick="processCodeBlocks.togglePre(368578);">Hide</span>  &nbsp; <span id="preShrink368578" onclick="processCodeBlocks.shrinkExpand(368578);">Shrink</span> <img id="preimg368578" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(368578);">  &nbsp; <span id="copycode368578" onclick="return processCodeBlocks.copyCode(368578);">Copy Code</span></div><pre id="pre368578" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    HWND hwnd;
    HTHEME hTheme;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_NCCREATE:
            <span class="code-keyword">if</span>(!DefWindowProc(hwnd, uMsg, wParam, lParam))
                <span class="code-keyword">return</span> FALSE;
            pData = malloc(<span class="code-keyword">sizeof</span>(CustomData));
            <span class="code-keyword">if</span>(pData == NULL)
                <span class="code-keyword">return</span> FALSE;
            ZeroMemory(pData, <span class="code-keyword">sizeof</span>(CustomData));
            pData-&gt;hwnd = hwnd;
            <span class="code-comment">//</span><span class="code-comment"> ... Set pData to consistent state (e.g. some reasnable default values)</span>
            SetWindowLongPtr(hwnd, <span class="code-digit">0</span>, (LONG_PTR)pData);
            <span class="code-keyword">return</span> TRUE;

        <span class="code-keyword">case</span> WM_CREATE:
        {
            LRESULT lres;
            lres = DefWindowProc(hwnd, uMsg, wParam, lParam);
            <span class="code-keyword">if</span>(lres == -<span class="code-digit">1</span>)
                <span class="code-keyword">return</span> -<span class="code-digit">1</span>;

            <span class="code-comment">//</span><span class="code-comment"> Further setup, e.g. opening theme handle if the control supports themed painting.</span>
            pData-&gt;hTheme = OpenThemeData(hwnd, L<span class="code-string">"</span><span class="code-string">..."</span>);
            <span class="code-comment">//</span><span class="code-comment"> ...</span>
            <span class="code-keyword">return</span> lres;
        }

        <span class="code-keyword">case</span> WM_DESTROY:
            <span class="code-keyword">if</span>(pData-&gt;hTheme != NULL) {
                CloseThemeData(pData-&gt;hTheme);
                pData-&gt;hTheme = NULL;
            }
            <span class="code-keyword">break</span>;

        <span class="code-keyword">case</span> WM_NCDESTROY:
            <span class="code-keyword">if</span>(pData != NULL) {  <span class="code-comment">//</span><span class="code-comment"> pData is NULL if WM_NCCREATE failed before SetWindowLongPtr()!!!</span>
                <span class="code-comment">//</span><span class="code-comment"> ... free all the other resources we alloc'ed in WM_NCCREATE</span>
                free(pData)
            }
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Window Style and Extended Style</h2>

<p>Every window has a style and extended style associated with it. Both are actually double-word (<code>DWORD</code>)
 bitmasks, which augment look or behavior of the control. Initially the 
style and extended style are set accordingly to parameters of <code>CreateWindow()</code> or <code>CreateWindowEx()</code>. The style is propagated into <code>WM_NCCREATE</code> and <code>WM_CREATE</code> as members of <code>CREATESTRUCT</code>.</p>

<p>Later, during the control's life time, they can be changed with the function <code>SetWindowLong()</code>, using the indeces <code>GWL_STYLE</code> or <code>GWL_EXSTYLE</code> respectively.</p>

<p>All bits of the extended style and 16 higher bits of the style have a
 meaning defined by system. Lower 16 bit of the style are available for 
control-specific purposes.</p>

<p>The system-defined style and extended style bits are usually handled by appropriate messages passed to <code>DefWindowProc()</code>. For example, if the control has the style <code>WM_BORDER</code>, then handling of <code>WM_NCCALCSIZE</code>reserves the space for the border by making a client area of the control a bit smaller, and <code>WM_NCPAINT</code> paints into the space the border.</p>

<p>(Actually the border is then painted unthemed. We will eventually 
cover painting into non-client area and related stuff in some sequel 
article.)</p>

<p>Still, at least for the control-specific styles, the control 
implementation must know when the styles are changed to reflect it. 
Monitoring the changes in the style and extended style bits is performed
 with messages <code>WM_STYLECHANGING</code> and <code>WM_STYLECHANGED</code>. <code>WM_STYLECHANGING</code> is sent before the change is performed and the control may, if it desires so, deny the change or force a different change.</p>

<p>Although the control can always ask for the current style with <code>GetWindowLong()</code>,
 it can be often better and more convenient to have the style cached 
locally in our control's data structure, at least the low 16-bits of the
 style we (arguably) can need to access quite often.</p>

<div class="pre-action-link" id="premain392033" style="width:100%;display:block;"><span id="prehide392033" onclick="processCodeBlocks.togglePre(392033);">Hide</span>  &nbsp; <span id="preShrink392033" onclick="processCodeBlocks.shrinkExpand(392033);">Shrink</span> <img id="preimg392033" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(392033);">  &nbsp; <span id="copycode392033" onclick="return processCodeBlocks.copyCode(392033);">Copy Code</span></div><pre id="pre392033" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    DWORD style : <span class="code-digit">16</span>;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_NCCREATE:
        {
            CREATESTRUCT* cs = (CREATESTRUCT*) lParam;
            <span class="code-comment">//</span><span class="code-comment"> ...</span>
            pData-&gt;style = cs-&gt;style;
            <span class="code-keyword">return</span> TRUE;
        }

        <span class="code-keyword">case</span> WM_STYLECHANGING:
        {
            <span class="code-comment">/*</span><span class="code-comment"> Sometimes, for example, a control has to allow setting some style only
             * during its creation, and it needs to block the change of it thenafter.
             * It can be done by augmenting STYLESTRUCT::styleNew as we wish. */</span>
            <span class="code-keyword">if</span>(wParam == GWL_STYLE) {
                STYLESTRUCT* ss = (STYLESTRUCT*) lParam;

                <span class="code-comment">/*</span><span class="code-comment"> Prevent change in some styles we do not allow to change during control's life: */</span>
                <span class="code-keyword">if</span>((ss-&gt;styleOld ^ ss-&gt;styleNew) &amp; (XXS_CONSTSTYLE1 | XXS_CONSTSTYLE2)) {
                    ss-&gt;styleNew &amp;= ~(XXS_CONSTSTYLE1 | XXS_CONSTSTYLE2);
                    ss-&gt;styleNew |= ss-&gt;styleOld &amp; (XXS_CONSTSTYLE1 | XXS_CONSTSTYLE2);
                }
            }
            <span class="code-keyword">break</span>;
        }

        <span class="code-keyword">case</span> WM_STYLECHANGED:
            <span class="code-keyword">if</span>(wParam == GWL_STYLE) {
                STYLESTRUCT* ss = (STYLESTRUCT*) lParam;

                <span class="code-comment">/*</span><span class="code-comment"> Remember new style in our data structure for simple use */</span>
                pData-&gt;style = ss-&gt;styleNew;

                <span class="code-comment">/*</span><span class="code-comment"> If a style affecting look of the control changes, we may need to repaint it. */</span>
                <span class="code-keyword">if</span>((ss-&gt;styleOld ^ ss-&gt;styleNew) &amp; (XXS_ANOTHERLOOK | XXS_MORECOLOROUS)) {
                    <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw)
                        InvalidateRect(hwnd, NULL, TRUE);
                }
            }
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Window Geometry</h2>

<p>Whenever the control is created, resized, its (normal or extended) 
style is changed, or state of its status bars changes, the system sends <code>WM_NCCALCSIZE</code>
 to the control so that it can rearrange what portion of the control 
area is non-client or client one. The default implementation in <code>DefWindowProc()</code>
 reserves some space for borders, client edges and also scrollbars, 
depending on the style, extended style, and space needed for scrollbars 
(if any).</p>

<p>Custom implementation of this message may be quite complicated to all
 combinations of its parameters and return values it expects, but it is 
rarely needed, and the default implementation is almost always 
sufficient. The only exception may be when we want to say the system, 
what parts of the control's client area stays valid after the resize in 
cases when the rough control with class style <code>CS_HREDRAW</code> and <code>CS_VREDRAW</code> is not sufficient. In such cases the implementation may look like this:</p>

<div class="pre-action-link" id="premain686320" style="width:100%;display:block;"><span id="prehide686320" onclick="processCodeBlocks.togglePre(686320);">Hide</span>  &nbsp; <span id="copycode686320" onclick="return processCodeBlocks.copyCode(686320);">Copy Code</span></div><pre id="pre686320" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_NCCALCSIZE:
            <span class="code-keyword">if</span>(wParam) {
                <span class="code-comment">//</span><span class="code-comment"> Return the desired combination of WVR_xxx constants, to</span>
                <span class="code-comment">//</span><span class="code-comment"> specify which part of client should be preserved after the</span>
                <span class="code-comment">//</span><span class="code-comment"> resize. For example:</span>
                <span class="code-keyword">return</span> WVR_ALIGNTOP | WVR_ALIGNRIGHT;
            }

            <span class="code-comment">//</span><span class="code-comment"> In other cases, pass the message into DefWindowProc().</span>
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>After system knows what part of the control belongs to the non-client area, it sends <code>WM_MOVE</code> (if position of client area changed) and <code>WM_SIZE</code> (if size of it changed) to the control, and invalidates portions of client area accordingly to the return value of <code>WM_NCCALCSIZE</code>.</p>

<p>Whenever the control is to change its visibility, the control gets <code>WM_SHOWWINDOW</code>. That includes whenever <code>ShowWindow()</code>
 is called, but also when parent window gets minimized/restored, or when
 other window is maximized and hence it obscures the control completely.
 The cases can be distinguished by analyzing its parameters.</p>

<h2>Window Text</h2>

<p>For setting and retrieving a text associated with a window, Win32 API provides messages <code>WM_SETTEXT</code> and <code>WM_GETTEXT</code>. However applications usually do not use these messages directly and they call functions <code>SetWindowText()</code> and <code>GetWindowText()</code> which can convert the strings between Unicode and ANSI if caller and window opinion on type of strings does not match.</p>

<p>When passed into <code>DefWindowProc()</code>, the text is stored or 
retrieved directly from window manager. This allows Windows to get the 
text from a window belonging to another process, even if that other 
process is not responding. Raymond Chen described this nicely in his 
famous blog, The Old New Thing: <a href="http://blogs.msdn.com/b/oldnewthing/archive/2003/08/21/54675.aspx">The secret life of GetWindowText</a>.</p>

<p>It's also worth of note that for some utilities (e.g. various 
accessibility tools), the window text may ver useful even if no 
particular text is displayed by the control, so setting it to a 
reasonable value can improve an experience to users with some 
disabilities or limitations.</p>

<p>If you decide to handle the messages differently and (for example) 
store the text directly in your control's structure, then you should 
also consistently handle messages <code>WM_NCCREATE</code> and <code>WM_GETTEXTLENGTH</code>:</p>

<div class="pre-action-link" id="premain397855" style="width:100%;display:block;"><span id="prehide397855" onclick="processCodeBlocks.togglePre(397855);">Hide</span>  &nbsp; <span id="preShrink397855" onclick="processCodeBlocks.shrinkExpand(397855);">Shrink</span> <img id="preimg397855" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(397855);">  &nbsp; <span id="copycode397855" onclick="return processCodeBlocks.copyCode(397855);">Copy Code</span></div><pre id="pre397855" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">tchar.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">strsafe.h</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    TCHAR* lpszText;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_SETTEXT:
        {
            TCHAR* lpszText = (TCHAR*) lParam;
            TCHAR* lpszTmp;
            <span class="code-sdkkeyword">size_t</span> sz;

            <span class="code-keyword">if</span>(lpszText != NULL)
                StringCchLength(lpszText, STRSAFE_MAX_CCH, &amp;sz);
            <span class="code-keyword">else</span>
                sz = <span class="code-digit">0</span>;
            lpszTmp = (TCHAR*) malloc(<span class="code-keyword">sizeof</span>(TCHAR) * (sz+1));
            <span class="code-keyword">if</span>(lpszTmp == NULL)
                <span class="code-keyword">return</span> FALSE;
            StringCchCopyEx(lpszTmp, sz+1, lpszText, NULL, NULL, STRSAFE_IGNORE_NULLS);
            <span class="code-keyword">if</span>(pData-&gt;lpszText != NULL)
                free(pData-&gt;lpszText);
            pData-&gt;lpszText = lpszTmp;
            <span class="code-keyword">return</span> TRUE;
        }

        <span class="code-keyword">case</span> WM_GETTEXT:
        {
            <span class="code-sdkkeyword">size_t</span> sz = (<span class="code-sdkkeyword">size_t</span>) wParam;
            TCHAR* lpBuffer = (TCHAR*) lParam;
            TCHAR* lpEnd;

            <span class="code-keyword">if</span>(pData-&gt;lpszText == NULL)
                <span class="code-keyword">return</span> <span class="code-digit">0</span>;
            StringCchCopyEx(lpBuffer, sz, pData-&gt;lpszText, &amp;lpEnd, NULL, <span class="code-digit">0</span>);
            <span class="code-keyword">return</span> (lpEnd - lpBuffer);
        }

        <span class="code-keyword">case</span> WM_GETTEXTLENGTH:
        {
            <span class="code-sdkkeyword">size_t</span> sz;

            <span class="code-keyword">if</span>(pData-&gt;pszText == NULL)
                <span class="code-keyword">return</span> <span class="code-digit">0</span>;
            StringCchLength(pData-&gt;lpszText, STRSAFE_MAX_CCH, &amp;sz);
            <span class="code-keyword">return</span> sz;
        }

        <span class="code-keyword">case</span> WM_NCCREATE:
        {
            CRERATESTRUCT* cs = (CREATESTRUCT*) lParam;
            <span class="code-sdkkeyword">size_t</span> sz;
            <span class="code-comment">//</span><span class="code-comment"> ...</span>

            <span class="code-keyword">if</span>(cs-&gt;lpszText != NULL)
                StringCchLength(cs-&gt;lpszText, STRSAFE_MAX_CCH, &amp;sz);
            <span class="code-keyword">else</span>
                sz = <span class="code-digit">0</span>;
            pData-&gt;lpszText = (TCHAR*) malloc(<span class="code-keyword">sizeof</span>(TCHAR) * (sz+1));
            <span class="code-keyword">if</span>(pData-&gt;lpszText == NULL)
                <span class="code-keyword">return</span> FALSE;
            StringCchCopyEx(pData-&gt;lpszText, sz+1, cs-&gt;lpszText, NULL, NULL, STRSAFE_IGNORE_NULLS);
            <span class="code-keyword">return</span> TRUE;
        }

        <span class="code-keyword">case</span> WM_NCDESTROY:
            <span class="code-comment">//</span><span class="code-comment"> ...</span>
            <span class="code-keyword">if</span>(pData-&gt;lpszText != NULL)
                free(lpszText);
            <span class="code-comment">//</span><span class="code-comment"> ...</span>
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p><strong>Note:</strong> In most cases, relying on <code>DefWindowProc()</code> and calling <code>GetWindowText()</code>
 where neded (e.g. in painting code) fully suffices (and it is 
definitely less work). You should generally prefer this way unless you 
have good reason to do the stuff manually as the code excerpt shows.</p>

<h2>Window Font</h2>

<p>Every control which draws a text during its painting, should allow 
application to specify what font it should use. For this purpose the API
 provides the messages <code>WM_SETFONT</code> and <code>WM_GETFONT</code>. Their implementation is simple enough so there is no need for any further explanation:</p>

<div class="pre-action-link" id="premain978239" style="width:100%;display:block;"><span id="prehide978239" onclick="processCodeBlocks.togglePre(978239);">Hide</span>  &nbsp; <span id="preShrink978239" onclick="processCodeBlocks.shrinkExpand(978239);">Shrink</span> <img id="preimg978239" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(978239);">  &nbsp; <span id="copycode978239" onclick="return processCodeBlocks.copyCode(978239);">Copy Code</span></div><pre id="pre978239" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    HFONT hFont;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_SETFONT:
            pData-&gt;hFont = (HFONT) wParam;
            <span class="code-keyword">if</span>((BOOL) lParam  &amp;&amp; !pData-&gt;bNoRedraw)
                InvalidateRect(hwnd, NULL, TRUE);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        <span class="code-keyword">case</span> WM_GETFONT:
            <span class="code-keyword">return</span> (LRESULT) pData-&gt;hFont;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>All what remains is the painting code to select the font into a device context when drawing a text. If the <code>hFont</code> is <code>NULL</code>, the control should use the font returned by <code>GetStockObject(SYSTEM_FONT)</code>. Note this font is pre-selected in new device contexts.</p>

<p>When painting text with <code>DrawThemeText()</code>, keep in mind 
the function paints with the font specified in the theme definition only
 if it defines one for the theme class/part/state combination. If it 
does not, the function uses the font selected into the device context. 
Hence, it is good idea to select the font into the device context even 
for the themed code path.</p>

<h2>Painting</h2>

<p>Window painting is based on handling <code>WM_ERASEBKGND</code>, <code>WM_PAINT</code> and <code>WM_PRINTCLIENT</code> we already described in <a href="http://www.codeproject.com/Articles/617212/Custom-Controls-in-Win32-API-The-Painting">one of the previous articles in the series</a>.</p>

<p>Aside that, there is also a message <code>WM_SETREDRAW</code> which 
is supported by many standard controls. The message allows application 
to temporarily disable the redrawing of the control when its state 
changes. This is, for example, often used for controls like list view 
and tree view. Often, application may need to populate such controls 
with huge number of items, and the control refreshes itself after each 
such insert to reflect the data it holds.</p>

<p>If the application knows it inserts hundreds of items at once, it may
 disable the repaint, insert all the items, re-enable the repaint and 
force the repaint:</p>

<div class="pre-action-link" id="premain821603" style="width:100%;display:block;"><span id="prehide821603" onclick="processCodeBlocks.togglePre(821603);">Hide</span>  &nbsp; <span id="copycode821603" onclick="return processCodeBlocks.copyCode(821603);">Copy Code</span></div><pre id="pre821603" style="margin-top: 0px;" class="notranslate">/* app.c
 * (some application) */

...

SendMessage(hwnd, WM_SETREDRAW, FALSE, 0);  // Disable repaint
...  // Huge number of messages which change control's state
SendMessage(hwnd, WM_SETREDRAW, TRUE, 0);   // Re-enable repaint
RedrawWindow(hwnd, NULL, NULL, RDW_ERASE | RDW_FRAME | RDW_INVALIDATE | RDW_ALLCHILDREN);</pre>

<p><strong>Note:</strong> Complex controls may need to repaint also its child windows or their non-client area, hence we used <code>RedrawWindow()</code> with all the flags instead of simple <code>InvalidateRect(hwnd, NULL, TRUE)</code>. However if it is known there are no children or frame, <code>InvalidateRect()</code> would suffice.</p>

<p>If you want to support this message (which you should if setting up 
or populating the control might lead to too many repaints), then on the 
control's implementation side, it usually means just remembering a 
single flag in control's data and invalidating the control's area only 
when the flag is not set:</p>

<div class="pre-action-link" id="premain10186" style="width:100%;display:block;"><span id="prehide10186" onclick="processCodeBlocks.togglePre(10186);">Hide</span>  &nbsp; <span id="preShrink10186" onclick="processCodeBlocks.shrinkExpand(10186);">Shrink</span> <img id="preimg10186" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(10186);">  &nbsp; <span id="copycode10186" onclick="return processCodeBlocks.copyCode(10186);">Copy Code</span></div><pre id="pre10186" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    <span class="code-comment">//</span><span class="code-comment"> Note the inverted logic of this meber.</span>
    <span class="code-comment">//</span><span class="code-comment"> I.e. ZeroMemory() in WM_NCCREATE sets it correctly to FALSE.</span>
    BOOL bNoRedraw;

    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_PAINT:
        {
            <span class="code-comment">//</span><span class="code-comment"> Adapted WM_PAINT handler from the article about painting.</span>
            <span class="code-comment">//</span><span class="code-comment"> We only added the test for pData-&gt;bNoRedraw.</span>
            PAINTSTRUCT ps;
            BeginPaint(hwnd, &amp;ps);
            <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw) {
                <span class="code-keyword">if</span>(GetWindowLong(hwnd, GWL_STYLE) &amp; XXS_DOUBLEBUFFER)
                    CustomDoubleBuffer(hwnd, &amp;ps);
                <span class="code-keyword">else</span>
                    CustomPaint(hwnd, ps.hdc, &amp;ps.rcPaint, ps.fErase);
            }
            EndPaint(hwnd, &amp;ps);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
        }

        <span class="code-keyword">case</span> WM_SETREDRAW:
            pData-&gt;bNoRedraw = !wParam;
            <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw)        <span class="code-comment">//</span><span class="code-comment"> Repaint automatically on re-enabling.</span>
                InvalidateRect(hwnd, NULL, TRUE);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;

        <span class="code-keyword">case</span> XXM_CHANGESTATE:
            ...  <span class="code-comment">//</span><span class="code-comment"> modify control's state by modifying data in pData</span>
                 <span class="code-comment">//</span><span class="code-comment"> (e.g. insert/set/delete items of any kind in it).</span>

            <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw)        <span class="code-comment">//</span><span class="code-comment"> Avoid repaint when disabled by the app.</span>
                InvalidateRect(hwnd, NULL, TRUE);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p><strong>Note:</strong> According to MSDN, when repainting is 
re-enabled, application itself is then supposed to invalidate the 
control's area and repaint. However many standard controls do that 
automatically. I decided to follow the practice in the example above. 
The advantage of this approach also is the control may have better idea 
what exactly needs to repaint so it may be able to invalidate only 
relevant parts of its area.</p>

<p>I recommend another post on The Old New Thing blog as a further complementary reading on the topic of <code>WM_SETREDRAW</code>: <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/01/24/10119211.aspx">There's a default implementation for WM_SETREDRAW, but you might be able to do better</a>.</p>

<p>Yet another message related to painting is <code>WM_NCPAINT</code>. We will cover it in another article, which will talk about, so lets skip it for now.</p>

<h2>Interaction with Dialog</h2>

<p>Quite often, the parent window of the control is a dialog. The 
dialogs are quite popular also for simplicity of their indirect creation
 by using a dialog template (<code>DIALOG</code> or <code>DIALOGEX</code>
 resource), as it automates a lot of code for creation larger number of 
windows manually. Of course, the dialog template, or its items 
respectively, can refer to the control's window class.</p>

<p><strong>Note:</strong> The dialog template can refer to the control's class name only if it has been registered with the same instance handle (<code>HINSTANCE</code>) where the template lives, or if the class is global (i.e. class style <code>CS_GLOBAL</code> has been used).</p>

<p>Normal behavior of dialog is determined by its dialog procedure, 
which is usually the same code which is externally available by calling <code>DefDlgProc()</code>, so customized dialogs can propagate messages to it in a similar way as window procedure do it with <code>DefWindowProc()</code>.</p>

<p>Dialogs, in general, provide some features for user's comfort and 
effectiveness. Some of them need cooperation from the control to work 
well. These features are provided by <code>DefDlgProc()</code>, which is
 usually called from the dialog's procedure. Application can also 
emulate some of those features for normal (non-dialog) windows. For 
example refer to Raymond Chanin's another post: <a href="http://blogs.msdn.com/b/oldnewthing/archive/2003/10/21/55384.aspx">Using the TAB key to navigate in non-dialogs</a>.</p>

<p>So lets take a look how make the control ready for such coopertion.</p>

<p>The dialog resource can specify the font to be used. If so, the dialog procedure sends <code>WM_SETFONT</code> to each control it creates. We already talked about this message earlier, so lets go on.</p>

<p>Another important feature of dialog is keyboard navigation. Users often rely on changing focus of their controls by pressing <em>TAB</em> or <em>SHIFT+TAB</em> hot keys. The dialog procedure can use also use other keys as <em>space</em> or <em>enter</em>.
 Therefore it is important to tell the dialog what keys your control 
needs to get for its own operation, so the dialog knows whether it may 
use it for the navigation or whether he should feed the control with it.
 This is done by handling <code>WM_GETDLGCODE</code>.</p>

<p>The handler of this messages is usually just one-liner which specifies bitmask describing the control's needs:</p>

<div class="pre-action-link" id="premain726733" style="width:100%;display:block;"><span id="prehide726733" onclick="processCodeBlocks.togglePre(726733);">Hide</span>  &nbsp; <span id="copycode726733" onclick="return processCodeBlocks.copyCode(726733);">Copy Code</span></div><pre id="pre726733" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    BOOL bNoRedraw;  <span class="code-comment">//</span><span class="code-comment"> inverted logic, i.e. ZeroMemory() WM_NCCREATE leaves this on the right default.</span>
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_GETDLGCODE:
            <span class="code-keyword">return</span> DLGC_flag1 | DLGC_flag2;
            <span class="code-comment">//</span><span class="code-comment"> For illustrative purpose only. Refer to MSDN for all possible flags and their meaning.</span>
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>Yet another feature is a visual feedback of focus and accelerator 
keys in the dialog's appearance. Historically these were always shown. 
But since Windows XP, Microsoft has decided it may be disturbing for 
users who use mostly mouse and rarely use keyboard. So, Windows started 
to hide the focus rect and accelerator key mark by default, unless user 
starts to navigate by the keyboard. As an end user you may like it or 
dislike it, as a developer you should make the control to follow it. 
Users who do not like it, can then disable the hiding in Control Panels.</p>

<p>The logic is based on handling of the message <code>WM_UPDATEUISTATE</code> by every control which can have focus or a shortcut. When handled manually, it may be implemented like this:</p>

<div class="pre-action-link" id="premain411058" style="width:100%;display:block;"><span id="prehide411058" onclick="processCodeBlocks.togglePre(411058);">Hide</span>  &nbsp; <span id="preShrink411058" onclick="processCodeBlocks.shrinkExpand(411058);">Shrink</span> <img id="preimg411058" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(411058);">  &nbsp; <span id="copycode411058" onclick="return processCodeBlocks.copyCode(411058);">Copy Code</span></div><pre id="pre411058" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    DWORD dwUiState;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_UPDATEUISTATE:
            <span class="code-keyword">switch</span>(LOWORD(wParam)) {
                <span class="code-keyword">case</span> UIS_CLEAR:       pData-&gt;dwUiState &amp;= ~HIWORD(wp); <span class="code-keyword">break</span>;
                <span class="code-keyword">case</span> UIS_SET:         pData-&gt;dwUiState |= HIWORD(wp); <span class="code-keyword">break</span>;
                <span class="code-keyword">case</span> UIS_INITIALIZE:  pData-&gt;dwUiState = HIWORD(wp); <span class="code-keyword">break</span>;
            }
            <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw)
                InvalidateRect(hwnd, NULL, FALSE);
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>The rest is then just following the flags in your painting code. For example, if the condition <code>(pData-&gt;dwUiState &amp; UISF_HIDEACCEL)</code> stands, you should reflect it by using <code>DT_HIDEPREFIX</code> flag in <code>DrawText()</code>.</p>

<p>Or, you may rely on implementation of the message in <code>DefWindowProc()</code> and only query the current state by sending the control <code>WM_QUERYUISTATE</code> in the painting code.</p>

<p>Once again, further recommended complementary reading consists of some posts on The Old New Thing:</p>

<ul>
	<li><a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/05/03/414317.aspx">Managing the UI state of accelerators and focus rectangles</a></li>	<li><a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/05/16/10419105.aspx">Untangling the confusingly-named WM_UPDATEUISTATE and WM_CHANGEUISTATE messages</a></li>	<li><a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/05/17/10419502.aspx">Who sends the initial WM_UPDATEUISTATE message?</a></li></ul>

<h2>Interaction with System</h2>

<p>The control also may need to handle some messages informing it about 
changes in some Windows settings which may have impact on controls and 
their look or behavior.</p>

<p>One such message is <code>WM_SYSCOLORCHANGE</code> sent by system to all top-level windows whenever the colors as returned by <code>GetSysColor()</code> change. The top-level windows should distribute the message to all child windows, including our control. (<strong>Gotcha:</strong> it is on app's developers. AFAIK, <code>DefWindowProc()</code> does not do that.) If the control's painting depends on system colors, it should repaint itself with new ones.</p>

<p>Another message with a bit similar purpose is <code>WM_THEMECHANGED</code>
 which is sent when the theme preferences are changed. Again the control
 should repaint itself with new theme data, which requires reopening the
 theme handles. We already discussed this in the previous article.</p>

<h2>Monitoring Focus</h2>

<p>Often, the control needs to repaint itself when it gets or loses focus. This is very simply done by tracking <code>WM_SETFOCUS</code> and <code>WM_GETFOCUS</code> messages.</p>

<div class="pre-action-link" id="premain999579" style="width:100%;display:block;"><span id="prehide999579" onclick="processCodeBlocks.togglePre(999579);">Hide</span>  &nbsp; <span id="copycode999579" onclick="return processCodeBlocks.copyCode(999579);">Copy Code</span></div><pre id="pre999579" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_SETFOCUS:
        <span class="code-keyword">case</span> WM_GETFOCUS:
            <span class="code-keyword">if</span>(!pData-&gt;bNoRedraw)
                InvalidateRect(hwnd, NULL, FALSE);
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Keyboard Messages</h2>

<p>There is a lot of messages for handling a keyboard, so lets introduce them.</p>

<p>At the low level, there are <code>WM_KEYDOWN</code> and <code>WM_KEYUP</code>
 messages. The former of them, as the name of it suggests, is sent when 
you press a key on your keyboard, but also when you keep holding it down
 and key auto-repeat kicks in (you can distinguish the two cases by 
inspecting its params). The latter one is sent when the key is released.</p>

<p>On top of that, there is <code>WM_CHAR</code> (or <code>WM_DEADCHAR</code>). Some of them may be sent between <code>WM_KEYDOWN</code> and <code>WM_KEYUP</code>,
 with translated identification of virtual key code to a real character.
 The translation is done in the application's message loop by calling 
the function <code>TranslateMessage()</code>. When the function sees <code>WM_KEYDOWN</code>, it just inserts corresponding <code>WM_CHAR</code> which is then retrieved later by another call of <code>GetNextMessage()</code>.</p>

<p><strong>Note:</strong> It really matters whether you handle the lower
 level or higher level messages. The message translation involves a 
configuration of keyboard and its layout. It is also affected by state 
of caps lock, shift or other functional keys. If you are developing a 
game, you probably are more interested in <code>WM_KEYDOWN</code> and <code>WM_KEYUP</code>. If it is a text editor, then it is more likely <code>WM_CHAR</code> for handling normal text typing and <code>WM_KEYDOWN</code> and <code>WM_KEYUP</code> to handle some functional keys like <em>&lt;INSERT&gt;</em> or cursor arrow keys.</p>

<p>Most of the keyboard messages mentioned above also have their <em>SYS</em> counterpart: <code>WM_SYSKEYDOWN</code>, <code>WM_SYSKEYUP</code> and <code>WM_SYSCHAR</code>.
 Actually these are sent in the same situations, but for key 
combinations usually used for tasks defined by Windows. E.g. 
combinations with <em>&lt;ALT&gt;</em> to enter window menu etc. Handling them allows you to override the default handling (assuming you do not pass them into <code>DefWindowProc()</code>). Under normal circumstances, this separation allows you to focus on handling the non-SYS messages and keeping these on <code>DefWindowProc()</code>, without a fear of any conflict.</p>

<p>Additionally there is a message <code>WM_UNICHAR</code> which is capable to handle any UTF-32 Unicode code point. As Windows internally works in <code>UTF-16</code>
 (with support of surrogate pairs since Windows XP), the system never 
sends this message to you. It is rather for your own comfort: If it is 
beneficial to support the message you can implement it in your window 
procedure and you as well as 3rd party applications (typically various 
Input Method Editors for e.g. Asian languages) can send it to you.</p>

<p>Some more in-depth reading about handling keyboard messages can be found in the article <a href="http://www.ngedit.com/a_wm_keydown_wm_char.html">What's broken in the WM_KEYDOWN-WM_CHAR input model?</a>, despite its pessimistic title.</p>

<h2>Mouse Messages</h2>

<p>Mouse handling involves even more messages. There are messages for handling move of a mouse pointer (<code>WM_MOVE</code>), actions with mouse buttons (e.g. <code>WM_LBUTTONDOWN</code> for left button down), and messages for composed actions like click or double click (e.g. <code>WM_LBUTTONDBLCLK</code>). Most messages also have two flavors: normal (client) and non-client whose names begin with <code>WM_NC</code> (e.g. <code>WM_NCMOUSEMOVE</code>, <code>WM_NCNCBUTTONUP</code>).</p>

<p>The normal messages are sent when the mouse event occurs while the mouse pointer is in a client area of the control, or while <em>mouse capture</em> is in an effect: The control may, depending on its logic, ask the system to send all mouse messages to it with the function <code>SetCapture()</code>, until it releases it with <code>ReleaseCapture()</code> (or until another window steals the capture with the <code>SetCapture()</code>. When the control loses the capture, it is notified with <code>WM_RELEASEDCAPTURE</code>.) The "NC" messages are sent when the mouse operation happens in non-client area (and the capture is not in effect).</p>

<p>The mouse capture is frequently used, for example, when implementing a
 button-like control (or a control whose part is of button-like nature).
 When its button is pressed (<code>WM_LBUTTONDOWN</code>), you take the 
capture so subsequent button release goes to the control even when it 
occurs outside of the control's client area:</p>

<div class="pre-action-link" id="premain284263" style="width:100%;display:block;"><span id="prehide284263" onclick="processCodeBlocks.togglePre(284263);">Hide</span>  &nbsp; <span id="preShrink284263" onclick="processCodeBlocks.shrinkExpand(284263);">Shrink</span> <img id="preimg284263" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(284263);">  &nbsp; <span id="copycode284263" onclick="return processCodeBlocks.copyCode(284263);">Copy Code</span></div><pre id="pre284263" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    BOOL bLeftButtonPressed;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};


<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_LBUTTONDOWN:
            pData-&gt;bLeftButtonPressed = TRUE;
            SetCapture(hwnd);
            <span class="code-keyword">break</span>;

        <span class="code-keyword">case</span> WM_LBUTTONUP:
        {
            POINT pt = { GET_X_LPARAM(lParam), GET_Y_LPARAM(lParam) };
            RECT rc;
            GetClientArea(hwnd, &amp;rc);
            <span class="code-keyword">if</span>(PtInRect(&amp;rc, pt))
                SendMessage(GetParent(hwnd), WM_COMMAND, GetWindowLong(hwnd, GWL_ID), <span class="code-digit">0</span>);
            ReleaseCapture();
        }
            <span class="code-comment">//</span><span class="code-comment"> No break here, fall through</span>

        <span class="code-keyword">case</span> WM_RELEASEDCAPTURE:
            pData-&gt;bLeftButtonPressed = FALSE;
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p><strong>Note:</strong> When the mouse capture is in effect, the window it holds it gets <strong>all</strong>
 mouse messages. So depending on its logic, for some of them, the 
control may need to manually check whether a mouse message really 
occurred inside it or not.</p>

<p>It is also important to remember that many messages are sent only when you explicitly ask for them: Double-click messages (<code>WM_LBUTTONDBLCLK</code>, <code>WM_RBUTTONDBLCK</code> etc.) are sent only if the window class was registered with the class style <code>CS_DBLCLKS</code>.</p>

<p>Messages <code>WM_MOUSELEAVE</code> and <code>WM_MOUSEHOVER</code> are sent only when their tracking is enabled with <code>TrackMouseEvent()</code>. Note the function enables one shot of the messages, and that <code>WM_MOUSELEAVE</code> disables the tracking altogether, so, usually, the function needs to be called again:</p>

<div class="pre-action-link" id="premain626357" style="width:100%;display:block;"><span id="prehide626357" onclick="processCodeBlocks.togglePre(626357);">Hide</span>  &nbsp; <span id="preShrink626357" onclick="processCodeBlocks.shrinkExpand(626357);">Shrink</span> <img id="preimg626357" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(626357);">  &nbsp; <span id="copycode626357" onclick="return processCodeBlocks.copyCode(626357);">Copy Code</span></div><pre id="pre626357" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    BOOL fTrackingMouse;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> <span class="code-keyword">void</span>
TrackMouse(HWND hwnd)
{
    TRACKMOUSEEVENT tme;
    tme.cbSize = <span class="code-keyword">sizeof</span>(TRACKMOUSEEVENT);
    tme.dwFlags = TME_LEAVE | TME_HOVER;
    tme.hwndTrack = hwnd;
    tme.dwHoverTime = HOVER_DEFAULT;
    TrackMouseEvent(&amp;tme);
}

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_MOUSEMOVE:
            <span class="code-keyword">if</span>(!pData-&gt;fTrackingMouse) {
                TrackMouse();
                pData-&gt;fTrackingMouse = TRUE;
            }
            <span class="code-keyword">break</span>;

        <span class="code-keyword">case</span> WM_MOUSEHOVER:
            ... <span class="code-comment">//</span><span class="code-comment"> handle mouse hover (often used for example to show a tooltip)</span>
            TrackMouse();
            <span class="code-keyword">break</span>;

        <span class="code-keyword">case</span> WM_MOUSELEAVE:
            pData-&gt;fTrackingMouse = FALSE;
            ...  <span class="code-comment">//</span><span class="code-comment"> handle mouse leave</span>
            <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>Also note there is no <code>WM_MOUSEENTER</code> message. You can use <code>WM_MOUSEMOVE</code> for this purpose: Whenever <code>WM_MOUSEMOVE</code> comes and the flag <code>fTrackingMouse</code> is not set, then the mouse entered the client area of the window.</p>

<h2>Scrolling Messages</h2>

<p>There are some message that allow controls to support scrolling: <code>WM_HSCROLL</code>, <code>WM_VSCROLL</code>, <code>WM_MOUSEWHEEL</code> and <code>WM_MOUSEHWHEEL</code>. However we'll take a closer look on scrolling in some sequel article.</p>

<h2>Accessibility</h2>

<p>Actually, the controls should also support cooperation with accessiblity and automation tools. It is done by handling <code>WM_GETOBJECT</code>, which is supposed to return pointer to a COM objects implementing certain COM interface (depending on <code>WPARAM</code> and <code>LPARAM</code>).</p>

<p>This is, however, quite complex topic. In addition, I admit it is a 
topic I cannot say much about currently due my limited knowledge about 
it. Hopefully we will return to it sometime later.</p>

<h2>Notifications</h2>

<p>So far, we mainly talked about situation when system or application 
needs to talk to the control. But often, the control also needs to tell 
something about its change to the application. That is usually done 
through some of notification message.</p>

<p>There are two main notification messages: <code>WM_COMMAND</code> and <code>WM_NOTIFY</code>.
 The first one is unable to bear more data then just an identification 
of control it is sending it (i.e. our control) and a 16-bit value which 
can be packed to it. Therefore it is typical use case is to trigger some
 action. For example, standard buttons fire <code>WM_COMMAND</code> when clicked.</p>

<p>The latter message, <code>WM_NOTIFY</code>, bears more data, and additionally it is further extensible. The parameter <code>LPARAM</code> is actually a pointer to <code>NMHDR</code>
 structure, or any other (control and notification-code specific) 
structure with any additionally data. The control just has to guarantee 
any such custom structure begins with <code>NMHDR</code>:</p>

<div class="pre-action-link" id="premain461016" style="width:100%;display:block;"><span id="prehide461016" onclick="processCodeBlocks.togglePre(461016);">Hide</span>  &nbsp; <span id="copycode461016" onclick="return processCodeBlocks.copyCode(461016);">Copy Code</span></div><pre id="pre461016" style="margin-top: 0px;" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.h
 * (public control interface) */</span>


<span class="code-comment">//</span><span class="code-comment"> Notification code</span>
<span class="code-preprocessor">#define XXN_MYNOTIFICATION    101
</span>
<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> XXNM_NOTIFICATIONDATA {
    NMHDR hdr; <span class="code-comment">//</span><span class="code-comment"> NMHDR has to be the 1st member of the struct.</span>
    ...        <span class="code-comment">//</span><span class="code-comment"> Other data.</span>
} XXNM_NOTIFICATIONDATA;

<span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">static</span> <span class="code-keyword">void</span>
SendNotification(HWND hwnd)
{
    XXNM_NOTIFICATIONDATA nd;

    nd.hdr.hwndFrom = hwnd;
    nd.hdr.idFrom = GetWindowLong(hwnd, GWL_ID);
    nd.hdr.code = XXN_MYNOTIFICATION;
    ... <span class="code-comment">//</span><span class="code-comment"> setup the other struct members</span>
    SendMessage(GetParent(hwnd), WM_NOTIFY, nd.hdr.idFrom, (LPARAM) &amp;nd);
}</pre>

<p>However, there is one more complication in case when the structure 
contains strings. The control is responsible to provide the strings in 
encoding the parent window expects. If the parent window is not under 
your control, i.e. when you cannot be sure what the parent wants, you 
have to ask it with the message <code>WM_NOTIFYFORMAT</code>, either 
each time before sending such message, or when the control is created 
and then every time we are asked to refresh the info:</p>

<div class="pre-action-link" id="premain299699" style="width:100%;display:block;"><span id="prehide299699" onclick="processCodeBlocks.togglePre(299699);">Hide</span>  &nbsp; <span id="preShrink299699" onclick="processCodeBlocks.shrinkExpand(299699);">Shrink</span> <img id="preimg299699" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(299699);">  &nbsp; <span id="copycode299699" onclick="return processCodeBlocks.copyCode(299699);">Copy Code</span></div><pre id="pre299699" style="margin-top: 0px;" processed="true" class="notranslate" lang="C"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (control implementation) */</span>

<span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> CustomData_tag CustomData;
<span class="code-keyword">struct</span> CustomData_tag {
    BOOL fUnicodeNotifications;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
};

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    CustomData* pData = (CustomData*) GetWindowLongPtr(hwnd, <span class="code-digit">0</span>);
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_NOTIFYFORMAT:
        {
            LRESULT format;
            <span class="code-keyword">if</span>(lParam == NF_REQUERY) {
                format = SendMessage(cs-&gt;hwndParent, WM_NOTIFYFORMAT, (WPARAM) hwnd, NF_QUERY);
                pData-&gt;fUnicodeNotifications = (format == NFR_UNICODE);
            } <span class="code-keyword">else</span> {
                format = (pData-&gt;fUnicodeNotifications ? NFR_UNICODE : NFR_ANSI);
            }
            <span class="code-keyword">return</span> format;
        }

        <span class="code-keyword">case</span> WM_NCCREATE:
        {
            CREATESTRUCT* ss = (CREATESTRUCT*) lParam;
            LRESULT format;
            <span class="code-comment">//</span><span class="code-comment"> ...</span>

            format = SendMessage(cs-&gt;hwndParent, WM_NOTIFYFORMAT, (WPARAM) hwnd, NF_QUERY);
            pData-&gt;fUnicodeNotifications = (format == NFR_UNICODE);
            <span class="code-keyword">return</span> TRUE;
        }
    }

    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Downloadable Example</h2>

<p>The attached example project (at the top of this page) implements a button. It roughly corresponds to standard button with <code>BS_PUSHBUTTON</code> or <code>BS_DEFPUSHBUTTON</code> style. Sure, such code is not useful for reuse in any application as you can simply stick with the standard button.</p>

<p>But still, the code of the custom control demonstrates handling of 
good portion of the messages described in this article as well as the 
stuff what we already learnt in the previous articles about painting and
 visual styles, so it can serve as a code for your further 
experimenting.</p>

<p>The example application is made of a simple dialog with two buttons: 
one standard button and one of the custom control implementation, so you
 can compare them live. The only main difference is that (with default 
Aero Theme) on Windows Vista and later the real button uses transition 
animation when changing state (e.g. between hot and normal). Some of the
 sequel articles will be dedicated to several methods of control 
animations so surely we will fill this gap later.</p>

<h2>Real World Code</h2>

<p>Today's real world code for further studying consists from few <a href="http://www.winehq.org/">Wine</a> sources. It may give you good insight what those function expect from various standard messages.</p>

<ul>
	<li>Implementation of <code>DefWindowProc()</code>: <a href="https://github.com/mirrors/wine/blob/master/dlls/user32/defwnd.c">https://github.com/mirrors/wine/blob/master/dlls/user32/defwnd.c</a></li>	<li>Implementation of <code>DefDlgProc()</code>: <a href="https://github.com/mirrors/wine/blob/master/dlls/user32/defdlg.c">https://github.com/mirrors/wine/blob/master/dlls/user32/defdlg.c</a></li>	<li>Implementation of <code>CreateWindow()</code>: <a href="https://github.com/mirrors/wine/blob/master/dlls/user32/win.c">https://github.com/mirrors/wine/blob/master/dlls/user32/win.c</a></li></ul>

<p><strong>Note:</strong> Keep in mind that some messages not essential 
for running Windows applications are not (yet) implemented in Wine. For 
example, the code above does not play with <code>WM_UPDATEUISTATE</code> and its relatives.</p>

<h2>Next Time: Adapting Existing Controls</h2>

<p>Often, creating new control by adapting an existing one can be much 
less work then implementing it from scratch. Next time, we will explore 
few techniques how to do that and what advantages or limitations they 
bear.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=77801"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=77801"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Custom%20Controls%20in%20Win32%20API%3a%20Standard%20Messages%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Custom+Controls+in+Win32+API%3a+Standard+Messages+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages&amp;title=Custom+Controls+in+Win32+API%3a+Standard+Messages+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages&amp;title=Custom+Controls+in+Win32+API%3a+Standard+Messages+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages&amp;description=Custom+Controls+in+Win32+API%3a+Standard+Messages+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Martin-Mitas">Martin Mitáš</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            <div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowOn" class="follow">
	            
	            
	            <a href="https://www.linkedin.com/profile/view?id=88607525"><img style="vertical-align:middle;border:0;height:24px;width:24px" alt="LinkedIn" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/linkedin-32.png"></a> 
            </div>
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Team Leader</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Czech Republic <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/CZ.gif" alt="Czech Republic" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=77801"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=77801"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1838092"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages&amp;fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1838092"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f624495%2fCustom-Controls-in-Win-API-Standard-Messages&amp;fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F5529206_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5529206xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5529206" parent="0" thread="5529206" href="https://www.codeproject.com/Messages/5529206/This-is-a-absolutely-fantastic-series.aspx">This is a absolutely fantastic series</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">steveb</span><span class="date">16-Jun-18  16:34</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=35405">steveb</a></span></td><td class="date"><span>16-Jun-18  16:34&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5529206_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="35405" msgid="5529206" votingtype="GoodOrBad" done="true"><a href="#xx5529206xx" onclick="return rateItem(5, 5529206,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',35405);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5529206xx" onclick="return rateItem(1, 5529206,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',35405);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Can you also cover SDK header &lt;custcntl.h&gt; which contain some boilerplate custom control helpers.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=5529206&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=5529206&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5529206" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5529206" data-ref="3_5529206" class="rating-label" name="RateItem_5529206"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5529206/This-is-a-absolutely-fantastic-series.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5529206"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="35405" msgid="5529206"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4783061_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4783061xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4783061" parent="0" thread="4783061" href="https://www.codeproject.com/Messages/4783061/Good-One.aspx">Good One</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Saurabh_Saxena</span><span class="date">20-Mar-14  12:51</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3226764">Saurabh_Saxena</a></span></td><td class="date"><span>20-Mar-14  12:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4783061_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3226764" msgid="4783061" votingtype="GoodOrBad" done="true"><a href="#xx4783061xx" onclick="return rateItem(5, 4783061,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3226764);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4783061xx" onclick="return rateItem(1, 4783061,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',3226764);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">My vote of 5<br>
<div class="signature">Saurabh_Saxena</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4783061&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4783061&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4783061" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4783061" data-ref="3_4783061" class="rating-label" name="RateItem_4783061"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4783061/Good-One.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4783061"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="3226764" msgid="4783061"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4627242_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4627242xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4627242" parent="0" thread="4627242" href="https://www.codeproject.com/Messages/4627242/Excellent.aspx">Excellent</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Paul2013</span><span class="date">2-Aug-13  8:36</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6426837">Paul2013</a></span></td><td class="date"><span>2-Aug-13  8:36&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4627242_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6426837" msgid="4627242" votingtype="GoodOrBad" done="true"><a href="#xx4627242xx" onclick="return rateItem(5, 4627242,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6426837);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4627242xx" onclick="return rateItem(1, 4627242,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6426837);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I'm really enjoying your series on custom controls.<br>
Please keep them coming.<br>
<br>
Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4627242&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4627242&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4627242" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4627242" data-ref="3_4627242" class="rating-label" name="RateItem_4627242"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/4627242/Excellent.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4627242"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="6426837" msgid="4627242"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4625433_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4625433xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_bug.gif" alt="Bug" title="Bug" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4625433" parent="0" thread="4625433" href="https://www.codeproject.com/Messages/4625433/Nice.aspx">Nice</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Klaus-Werner Konrad</span><span class="date">31-Jul-13  9:54</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6201690">Klaus-Werner Konrad</a></span></td><td class="date"><span>31-Jul-13  9:54&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4625433_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6201690" msgid="4625433" votingtype="GoodOrBad" done="true"><a href="#xx4625433xx" onclick="return rateItem(5, 4625433,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6201690);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4625433xx" onclick="return rateItem(1, 4625433,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6201690);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Very nice article (serie) !<br>
However, you forgot to initialize the ss pointer in your message handler for WM_STYLECHANGING and WM_STYLECHANGED ...<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4625433&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4625433&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4625433" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4625433" data-ref="3_4625433" class="rating-label" name="RateItem_4625433"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4625433/Nice.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4625433"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="6201690" msgid="4625433"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4625439_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4625439xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4625439" parent="4625433" thread="4625433" href="https://www.codeproject.com/Messages/4625439/Re-Nice.aspx">Re: Nice</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">31-Jul-13  9:59</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>31-Jul-13  9:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4625439_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4625439" votingtype="GoodOrBad" done="true"><a href="#xx4625439xx" onclick="return rateItem(5, 4625439,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4625439xx" onclick="return rateItem(1, 4625439,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4625433);" href="https://www.codeproject.com/Messages/4625433/Nice.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks. I'll fix it.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4625439&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1838092&amp;select=4625439&amp;floc=/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4625433" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4625439" data-ref="3_4625439" class="rating-label" name="RateItem_4625439"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4625439/Re-Nice.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4625439"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4625439"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 3-Dec-19  18:57 &nbsp; &nbsp; Last Update: 3-Dec-19  19:03</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?fid=1838092&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=6"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=624495">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=624495">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=624495">Revisions (18)</a></div>
<div><a href="#_comments">Comments (5)</a></div>
<div>Posted 31 Jul 2013</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win32" data-id="99">Win32</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win64" data-id="100">Win64</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/VS2010" data-id="314">VS2010</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/custom-controls" data-id="781">custom-controls</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>53.7K views</div><div>1.9K downloads</div><div>68 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-showindicator="true" data-tags="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=384102"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=384102"  width="160px" height="200px" target="_blank"/></a></noscript><div style="height: 0px; width: 0px; box-sizing: border-box; border: 0px none; font-size: 0px; display: none;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-4" data-google-query-id="CIHR4q_LmuYCFcVgwQod97IH3Q"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_1__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=384102"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=384102"  width="160px" height="600px" target="_blank"/></a></noscript><div style="height: 600px; width: 160px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-5" data-google-query-id="CMn54q_LmuYCFcJpwQodlRQOgQ"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="3" data-load-complete="true" width="160" height="600" frameborder="0"></iframe></div></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/624495/Custom-Controls-in-Win-API-Standard-Messages?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2013 by Martin Mitáš<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2019 <br>
                <br>
				Web04 
				2.8.191122.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="Custom%20Controls%20in%20Win32%20API%20%20Standard%20Messages%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 624495,2,1,true,true,0,'LargeStars', null, 5807385);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1838092,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 624495
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(624495,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 5807385
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : false,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><iframe id="google_osd_static_frame_4382871563804" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe></body></html>