<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Custom Controls in Win32 API: The Painting - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/Main.css">

    <script src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/amp4ads-host-v0.js"></script><script src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pubads_impl_modern_rendering_2019112101.js"></script><script async="" type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/jquery-2.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/article.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/MemberProfilePopup.js" defer="defer"></script>
<script type="text/javascript" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/a.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Understanding the basics of custom control painting and avoiding the trap of control flicker">
<meta name="Keywords" content="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,Windows API,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Martin Mitáš">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/Custom-Controls-in-Win-API-The-Painting_002.htm">
<meta name="twitter: card" content="summary">
<meta name="twitter: site" content="@CodeProject">
<meta property="og:url" content="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting">
<meta property="og:title" content="Custom Controls in Win32 API: The Painting">
<meta property="og:description" content="Understanding the basics of custom control painting and avoiding the trap of control flicker">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting"
   },
  "headline": "Custom Controls in Win32 API: The Painting",
  "url": "https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting",
  "discussionUrl": "https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C,Windows,Win32,Win64,Visual-Studio,Dev,VS2010,custom-controls",
  "commentCount": "24",
  "editor" : {
    "@type" : "Person",
    "name" : "Martin Mitáš",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Understanding the basics of custom control painting and avoiding the trap of control flicker",
  "articleSection": "Windows API",
  "author" : [{
      "@type" : "Person",
      "name" : "Martin Mitáš",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5807385"
    }],
  "datePublished": "2013-07-14",
  "dateCreated": "2013-07-14",
  "dateModified": "2014-12-12"
,
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.99,
    "ratingCount" : 54,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries.aspx",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/vista/",
      "name" : "Windows API"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/ga.js"></script>


<style type="text/css"></style><script src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pubads_impl_modern_2019112101.js" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-37/html/container.html"></head>	

<body class="firefox firefox0">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,379,797 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		<span id="ctl00_MemberBar_ReadLaterList_ReadLaterListDiv" class="tooltip member-message">
	<span id="ReadLaterListIcon" class="readlaterlist-count openable hidden"></span>
	<div class="tooltip-flyout readlaterlist-dropdown">
		<div id="ItemsToRead" class="readlaterlist-list"></div>
	</div>
</span><span id="ctl00_MemberBar_Messages_NotificationDiv" class="tooltip member-message">
	<a id="ctl00_MemberBar_Messages_NotificationCount" title="1 message" class="notification-count openable" href="https://www.codeproject.com/script/Membership/MyNotifications.aspx">1</a>

	<div class="tooltip-flyout notification-dropdown">
		

		<div id="ctl00_MemberBar_Messages_Confirm" class="bold spaced">
            <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/caution.png" style="width:20px;height:20px;vertical-align:bottom">
            <a id="ctl00_MemberBar_Messages_EmailConfirm" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting">Click here to confirm your email address. </a>
		</div>

		
		
		<div id="Notifications" class="notification-list">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/loading24.gif" alt="loading" style="margin:auto;">
		</div>
		<div class="spaced">
			
		</div>
	</div>
</span><span id="ctl00_MemberBar_TotalPoints" title="Total reputation points"><a class="bold member-rep-box silver" title="Reputation points earned: 811" href="https://www.codeproject.com/script/Reputation/List.aspx?mid=527156">811</a></span><span id="ctl00_MemberBar_CurRat" class="member-links tooltip openable">
				<a id="ctl00_MemberBar_MyProfile" class="me desktop-only tablet-only" dir="ltr" href="https://www.codeproject.com/Members/jon57">jon57</a>
                <a id="ctl00_MemberBar_MyProfileMob" class="me mobile-only" href="https://www.codeproject.com/Members/jon57">☰</a>
                <div class="tooltip-flyout">
					
					<div class="list-item"><a id="ctl00_MemberBar_MySettingsDefault" href="https://www.codeproject.com/script/Membership/Modify.aspx">My Settings</a></div>
					
					<div class="list-item"><a id="ctl00_MemberBar_MyBookmarks" href="https://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">My Bookmarks</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyArticles" href="https://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=527156">My Articles</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyMessages" href="https://www.codeproject.com/script/Forums/Messages.aspx?fmid=527156">My Messages</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyQuestions" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=questions&amp;mid=527156&amp;showall=True">My Questions</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyAnswers" href="https://www.codeproject.com/script/Answers/MemberPosts.aspx?tab=answers&amp;mid=527156&amp;showall=True">My Answers</a></div>
					<div class="list-item"><a id="ctl00_MemberBar_MyComments" href="https://www.codeproject.com/script/comments/MemberComments.aspx?mid=527156">My Comments</a></div>
					
					
					<div id="ctl00_MemberBar_MyFollowingHolder">
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowing" href="https://www.codeproject.com/script/follow/Edit.aspx">Things I Follow</a></div>
					    <div class="list-item"><a id="ctl00_MemberBar_MyFollowers" href="https://www.codeproject.com/script/follow/Followers.aspx">My Followers</a></div>
					</div>
					
        
					<form name="unsubForm" id="unsubForm" action="/script/Membership/LogOff.aspx?rp=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting" method="post" class="tight">
                    <input type="hidden" name="AntiForgeryToken" value="e5d2e6ae-036a-48c4-9374-8e897a099dbe">
                    <input type="submit" value="Sign out" class="list-item border-none extended align-left" onclick="return doSignout();" style="background-color: transparent; color: #999; cursor:pointer">
                    
                    </form>

                    <script type="text/javascript">//<!--
			        function doSignout()
			        {
    			        document.unsubForm.action = "/script/Membership/LogOff.aspx?rp=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting"
				        document.unsubForm.submit();
				        return true;
			        }//-->
			        </script>
                    
				</div>
			</span>

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=508008"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=508008"  width="728px" height="90px" target="_blank"/></a></noscript><div style="height: 90px; width: 728px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-1" data-google-query-id="CNmKiKDLmuYCFU1kwQods40K9g"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="1" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/undo.png" title="Report Ad" style="z-index: 1000; position: relative; left: 0px; top: -90px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px none; padding: 0px; height: 14px; width: 14px;" align="left"></div><div style="display: none; width: 728px; height: 90px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px none;"><div class="sendReportContainer" style="padding-left: 2px; display:block; line-height:initial !important"><div style="display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial"><b>Don't like this Ad?</b></div><div class="dropzone" style="margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal" contenteditable="true">1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here</div><div style="margin-left:10px; display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option selected="selected">Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select> &nbsp;<input type="button" disabled="disabled" class="reportButton" style="padding: 0px !important" value="Report"></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/dm-logo-150x23.png" style="max-width:100%;position:absolute; right:10px; top:10px;"></a></div></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table class="search" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><input tabindex="2" class="search  subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q"></td><td><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		
		
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">View ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming.aspx">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;cmpTpId=2&amp;cid=0">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos.aspx">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li></li>
		

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks &amp; Libraries</a> » <a href="https://www.codeproject.com/KB/vista/">Windows API</a> » <a href="https://www.codeproject.com/KB/vista/#General">General</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    <a id="ctl00_ActionLinks_ArticleFollow_FollowBtn" title="" class="button unfollowed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Have any updates for this Article appear in your Timeline so you can stay up to date" style="display: inline-block;">Follow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have any updates for this Article appear in your Timeline so you can stay up to date</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_ActionLinks_ArticleFollow_UnfollowBtn" title="" class="button followed align-center invisiblewith-subline tooltip" data-enabletooltip="true" data-tooltip="Stop following this Article" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Article</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_617212_25" data-size="medium" data-mode="bookmark"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark48.png" style="width:24px;height:24px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span> 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?display=Print" class="tooltip" title="">
   <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/print48.png" style="border:0" width="24px" height="24px">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/617212/Custom-Controls-in-Win-API-The-Painting" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="aeBO9tyqXwLdBF2Btu+ey5ORQWc1PFrvqtkQMhW32Baucd4FZUnP0bUG/RHDedE6eN4rpmfavMxHnC4oWNoGfFuaf/jbVjDC51XK0H7dwTAt8kqv83ABA1R+hCYa8+YBoE4QpkG5Xg62rPbbs7iWiKCDUA8h+pIcNVPyXNrlFMf5MS0IH3CXXt+l4vtjXZt1UzgSt0xcdUDRgxXv+WmLCdQ5YA61QxS7DNFDWRSKZsBWjoSPoRDj1T5a+B2IKLOjcGdM2SpgtNGhkyj98lyHdMWxVvSHTZ7kPEOKgxkHEEoybKkXdWMCTdDsvDYFTDsNQrrokqHSIUlQ+lmRSyklk0Ol3ygt+MiwlCKs9tPCjd14WY/y2fC+/VZtoQsh3isrKZOaziFlZBS33Oh+QbqXHMcbaLl7SN/FBkqQVbBqzenIucn92Ynf3S4y5jGENDt2lNGE70vYgeclh4dHUqMghp2V+zE1D2ZhJ9ZSA7KDVVPVWynV+ADYKt/D80iD8M8tTaGvyyodmY4YY0dUqK2SEOBmsXr2IzisKz2IynDB7Gs11TQgkST+OTyRq6HBFgBhOACK+NWjHfC6O2fOVNRa+Ndv3D5ed+WBr0Tm+ovpPkdf5NQXxVf1u4nV+3bpgBMCTnZ9ohcPDcHnaQaWbUgdQmD+XkcMlXsHZRzB7ILC1IDfUrGldlru49ONFyR1iwR8+GqD6pz8qJZcLrwntmrg4VPiDfJWj/V3OC0YKgE00MDa2lidSZtTPF+miPt+cXuLGXotXViczjHNm1LKVNWd8t43RUi2QMoSfgccJMd9UrjG1XcyCDabXoXp7G2gySmVdlj8ppWWt3VvUJASzfFdd6UM6ELIDc0t4rCJhVzfXnO2EmUvitWS3HeVfgIQl/V5P8Q+xokQHCoO+Yku2QrYKD7VaHEnV6/ZOSR9dcj2dHNnPppxiutXCMFEsLCHfjnjsjktJANSBcquh3ZVxsKwFpvRGU5qAvrO2TINkHR4Qv5YyyiOIQhIqUB1iyrLCVF9iEUWBI1Qlfzzaes8edaXEzqKDimTVdIwdscmG4021mI3uf4f1MrlHGP/+ghXEoEvnHeW/Vtu6MMThoeEGxTq24MyOFFMJ/wO2PM52c+QHe3jviQMT4TSgVEz7Mt0MPwVaRqzFBC/wazJLKxW+JoVXCYz8l0W9YuNmcoQREYsHJBrkwqhKQSrInWjVfaYPklvzU9KmvhS72zTlPX4jRwmxk9ZOiWQHOLg46IXNEoXGyycxWP/5T7Ue23duAh4JTxgTtX6KLj+gFdAMdRpSCS5zQrmAz3yiRLZVHT2AMjGYIpBskkBEc47C4YAvuvMnKaY4VePzk3kzD9sceQzfLdjT8vJlWB+MbCdXh3HYBVTTbtvgMTUfEwp70ELDIM5uvnRcOkjds1U/k+kFK0/yOG3G4SbeTlf8IcuxoR6ahauldSW5j0aDOoZR23LRDlY2H38QwVWomhHezRtFuMio8i1E16qB5c0dhloXgUfmG2QmYx7kN9MZ3U7RsYp0setkGJ8c2rC5lKJSPy9TtfNFKBWJAxfxLZ81jFRadPnUx4iE2njabOs4dPy3UpU7EyF6TPvQueReMWV88MNR19eZbctZwYUK1ctl4h4SjdM6bx3nN1EGUVnm4D7gIxbuV3zUczzJJXyOaOGYWspI9NJn5cSvy3ZCF4kKzYsxs2YchpK2SVe3Fdfy/vZMyvDR6EbeF788UhIFxp5J+YU1f5kxT/stIa+9QUiFwooIoOojCjYwQRGo7yMLziYRaNjrBNUJcYeExk76/trX3MWQ//TIC6FzoQVJeBCvoWDXO18lCHQOllmWI0cH/5Wq6YEKRjTQyb3qryfs34WMf4Mc6Sc9Af63PVVyeGaekVY0M9zVrpJ3UeDzmqWrB24NcBEAx6/1tfcDtUBw85ofwb8Yb55RtcjRpeX1hWHQFBR3t3MWNpynZVHG00T/PFi55AVQ8llD0SYacy9VrNzvdwEib1BbjbvFvJBAnD9oct+tVyb1aTFFSsl6oVnZ4VQz6KhQFO80jLwb2HFngHoOgtpg37YF7xuiJEq5xztKMG6yJswDuy55RtC/xI27urcV51blpLbGVIbtwsbijACOdqQC1YmXIjMzBbd6EWKmU6DA7lrHUz7fR6gJnM57+vgSOAAQjfKz2fQE4oS6usP0ng1O8xNHQN7avE84ZzFph0O3DUQWEiVK4eOH5UY2OsFTkvUidEDPxF+drRiTvFWmYvfELeFs/VD+mZRkD3lSyKwrSvNwXPbnYPfWSUBvlHvP2bzZT7A9Z6XLImQ6pWztZYDJcIOHlRy77E2WJqpOUgcixkHFkiqEKNLJ57tpPhpYf2Iqcpl6LFudIVDXrryyC2DyI6DsZXxDzP+Qs5hH90cLVV6KFfT4qCOoq3vS86CSecc+cm61ZxDch4kHmOlfAEVfKRZBBkZmAK+R7B53QYo7HnQ1ACEjMHV1MtegOhVCdvNLwQSfQQHg/qnEm//YwjAbA70ktT/39f18w6nyotu3sR4cWdmpx1+30twUomITbPbbRUpgktmf9VyxHnvNPaivMCM0TNjR64QfvQgAtjG4W165BYv8o1Sexu629M6d3qCFnkIW0bZCwtBAPgI04H/a8pFjiRq7zYLGWp8RUu0AwddCxfsOAMrVmSMhi1kBJS1xOImjY+oGAduRBm2RY0Q8Xo8jUvjU8PQQcNt7eGtG7KCoYq8Rp13tA1ejLiEdWBUTQLdGr8lxWFm1g==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Custom Controls in Win32 API: The Painting</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" id="ctl00_avatar" class="avatar">

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385" rel="author">Martin Mitáš</a></span> 

                                        <div class="flex-item" style="margin-top:-7px;height:35px">
                                            <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_617212">

	<table class="small-text" width="100%" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" alt="loading..." src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/loading16.gif" width="16px" height="16px"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				
				<td id="ctl00_RateArticle_StartForm" nowrap="nowrap" align="right"><b>Rate me!</b> </td>

				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap tooltip rating-stars-voter-large" style="padding-top:1px">

                    
					

<meta itemprop="upvoteCount" content="54">


<table id="ctl00_RateArticle_ItemRating_RatingTable" style="margin:0 1px;" class="hide-on-hover float-left" cellspacing="0" cellpadding="0">
	<tbody><tr>
		<td class="nowrap">

        <div style="width:120px;height:28px;position:relative" class="nowrap rating-stars-large"><div style="width:119px;height:24px;" class="clipped align-left float-left"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/stars-fill-lg.png"></div><div style="width:1px;height:24px;position:relative" class="clipped"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/stars-empty-lg.png" style="position:absolute;top:0;right:0"></div>

		
	</div></td>
		<td id="ctl00_RateArticle_ItemRating_VR" class="nowrap">
		<span id="ctl00_RateArticle_ItemRating_VotesR">4.99  (54 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_RateArticle_ItemRating_RatingText"></span>


                    
					<span id="ctl00_RateArticle_RB" class="ajaxHist radio voting show-on-hover" style="display: none;">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 
					<div class="rating-star-block"><a href="#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

                    
					

                    
	                <div id="ctl00_RateArticle_RCD" class="hover-container tooltip-flyout rating-comment" style="top:12px">
		                Add a reason or comment to your vote:
                        <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close" class="rating-close">x</a>
                        <br>
                        <textarea class="RateComment" rows="5" cols="60" style="width:96%;"></textarea>
		                <span id="ctl00_RateArticle_CommentReq" class="subdue">Adding a comment to your rating is optional</span>
		            </div>

                    
                        

				</td>

				
                <td id="ctl00_RateArticle_VR" class="nowrap show-on-hover tooltip" style="display: none;">

		            <span id="ctl00_RateArticle_VotesR">4.99  (54 votes)</span>

                    
					<div id="ctl00_RateArticle_histPHR" class="speech-bubble-container-up-right" style="width:175px;margin-top:24px;right:-15px;top:6px">
						<div class="speech-bubble-up-right">
							<div id="ctl00_RateArticle_HistogramR">

</div>
							<img id="ctl00_RateArticle_LoadingR" class="align-middle" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/loading24.gif" style="border-width:0px;">
						</div>
						<div class="speech-bubble-pointer-up-right">
							<div class="speech-bubble-pointer-up-right-inner"></div>
						</div>
					</div>
                </td>


				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>

			
		</td>
	</tr>
	</tbody></table>

</div>
                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">12 Dec 2014</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_description" class="summary">Understanding the basics of custom control painting and avoiding the trap of control flicker</div><span id="ctl00_thumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					<div id="ctl00_confirmError" class="advise"><img style="float:left;margin-right:10px" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/warning48.png" width="48px" height="48px"><b>Is your email address OK?</b> You are signed up for our 
						newsletters but your email address is either unconfirmed, or has not been 
						reconfirmed in a long time. Please <b>click <a id="ctl00_RequestConfirmLink2" href="https://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting">here</a> to have a confirmation email
                        sent</b> so we can confirm your email address and start sending you 
                        newsletters again. Alternatively, you can 
						<a id="ctl00_SubscribeLink2" href="https://www.codeproject.com/script/Membership/Subscribe.aspx">update your subscriptions</a>.</div>

						
						<div id="contentdiv" class="text">
						



<ul class="download">
	<li><a href="https://www.codeproject.com/KB/vista/617212/dblbuf.zip">Download custom control demonstrating the double buffering - 117.9 KB</a></li></ul>

<h2>Articles in this Series</h2>

<ul>
	<li><a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">Custom Controls in Win32 API: The Basics</a></li>	<li>Custom Controls in Win32 API: The Painting</li>	<li><a href="http://www.codeproject.com/Articles/620045/Custom-Controls-in-Win32-API-Visual-Styles">Custom Controls in Win32 API: Visual Styles</a></li>	<li><a href="http://www.codeproject.com/Articles/624495/Custom-Controls-in-Win32-API-Standard-Messages">Custom Controls in Win32 API: Standard Messages</a></li>	<li><a href="http://www.codeproject.com/Articles/646482/Custom-Controls-in-Win-API-Control-Customization">Custom Controls in Win32 API: Control Customization</a></li>	<li><a href="http://www.codeproject.com/Articles/744603/Custom-Controls-in-Win-API-Encapsulation-of-Cust">Custom Controls in Win32 API: Encapsulation of Customized Controls</a></li>	<li><a href="http://www.codeproject.com/Articles/1042516/Custom-Controls-in-Win-API-Scrolling">Custom Controls in Win32 API: Scrolling</a></li></ul>

<h2>Introduction</h2>

<p>In the <a href="http://www.codeproject.com/Articles/559385/Custom-Controls-in-Win32-API-The-Basics">previous article</a>,
 we learned the very basics of custom control implementation. Today, we 
take a closer look at control painting. This topic is quite important 
because successful controls must look nice and they must fit into the 
Windows environment. This task is not as simple as it sounds, especially
 if you consider that most applications support more than one particular
 Windows version, and that in the last 10 years, almost every Windows 
version changes the default visual appearance of its controls.</p>

<h2>Multiple Painting APIs</h2>

<p>Over time, Microsoft has provided many APIs for 2D graphics and painting. GDI (<em>GDI32.DLL</em>) is available since ancient times, and can be used everywhere. GDI+ (<em>GDIPLUS.DLL</em>)
 is part of Windows XP and newer (but a redistributable version of it 
can be downloaded from the Microsoft website). Direct2D is the newest 
and it is available only on Windows 7 and newer.</p>

<p>In general, the newer APIs are capable of better graphics (e.g., 
support for anti-aliasing, alpha channels, etc.) and have better 
performance characteristics (when used in the right way) as they can 
offload many tasks to the graphics card, while GDI operates mainly on 
the main system memory and on the CPU.</p>

<p>However, we will mainly stick with GDI, in this article as well as 
the following ones. For custom controls implementation it is usually 
sufficient, it works everywhere, and last but not least, the 
paint-related messages a control receives are GDI-centric due to 
historical reasons. Of course, using the newer painting APIs is possible
 but it is not the subject of our interest.</p>

<p>All that said, this article is not about GDI painting. There are 
plenty of resources on the net on that. On this site, the topic is quite
 thoroughly covered by Paul Watt:</p>

<ul>
	<li><a href="http://www.codeproject.com/Articles/1988/Guide-to-WIN32-Paint-for-beginners">Guide to Win32 Paint for Beginners</a></li>	<li><a href="http://www.codeproject.com/Articles/2078/Guide-to-WIN32-Paint-for-Intermediates">Guide to Win32 Paint for Intermediates</a></li>	<li><a href="http://www.codeproject.com/Articles/1944/Guide-to-WIN32-Regions">Guide to Win32 Regions</a></li>	<li><a href="http://www.codeproject.com/Articles/2095/A-Guide-to-WIN32-Clipping-Regions">A Guide to Win32 Clipping Regions</a></li>	<li><a href="http://www.codeproject.com/Articles/251892/Guide-to-Image-Composition-with-Win32-MsImg32-dll">Guide to Image Composition with Win32 MsImg32.dll</a></li>	<li><a href="http://www.codeproject.com/Articles/224754/Guide-to-Win32-Memory-DC">Guide to Win32 Memory DC</a> (good complementary reading to the Double Buffering presented here)</li></ul>

<h2>Hello World</h2>

<p>The preceding article already provided a code for a trivial control 
which was, of course, also capable of painting itself. Let's take a look
 at the painting code from that example once again. When the control's 
window procedure gets the message <code>WM_PAINT</code>, it was just calling our function, <code>CustomPaint()</code>:</p>

<div class="pre-action-link" id="premain725215" style="width:100%;display:block;"><span id="prehide725215" onclick="processCodeBlocks.togglePre(725215);">Hide</span>  &nbsp; <span id="preShrink725215" onclick="processCodeBlocks.shrinkExpand(725215);">Shrink</span> <img id="preimg725215" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(725215);">  &nbsp; <span id="copycode725215" onclick="return processCodeBlocks.copyCode(725215);">Copy Code</span></div><pre id="pre725215" style="margin-top: 0px;" processed="true" class="notranslate" lang="C++"><span class="code-keyword">static</span> <span class="code-keyword">void</span>
CustomPaint(HWND hwnd)
{
    PAINTSTRUCT ps;
    HDC hdc;
    RECT rect;

    GetClientRect(hwnd, &amp;rect);

    hdc = BeginPaint(hwnd, &amp;ps);
    SetTextColor(hdc, RGB(<span class="code-digit">0</span>,<span class="code-digit">0</span>,<span class="code-digit">0</span>));
    SetBkMode(hdc, TRANSPARENT);
    DrawText(hdc, _T(<span class="code-string">"</span><span class="code-string">Hello World!"</span>), -<span class="code-digit">1</span>, &amp;rect, DT_SINGLELINE | DT_CENTER | DT_VCENTER);
    EndPaint(hwnd, &amp;ps);
}

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_PAINT:
            CustomPaint(hwnd);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
    }
    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>The code sample already presents the very basic principle: Whenever the control needs painting, the system sends message <code>WM_PAINT</code>. The handler (here the function <code>CustomPaint()</code>) gets the device context handle (<code>BeginPaint()</code>), then uses it to paint the control with GDI functions (here, it just draws the string <code>"Hello world"</code> to the middle of the control), and then releases all resources with <code>EndPaint()</code>.</p>

<p>So far, there is no issue. However for good painting of complex 
controls, we simply need better understanding of how things really work.
 Otherwise, you will probably find yourselves on some web forum, 
searching for an answer to the omnipresent question "How to prevent 
control flickering when it is being resized?"</p>

<p>Also, complex controls may have a need to paint in other times then when <code>WM_PAINT</code>
 is received, or they may even have a need to paint outside its client 
area, either into the control's non-client area, or completely outside 
of the control's area.</p>

<h2>The Big Picture</h2>

<p>So how are the things around <code>WM_PAINT</code> glued together? From a perspective of the control (or more generally, any window represented with a <code>HWND</code> handle), there are several important messages, not just the <code>WM_PAINT</code>, and also some other concepts tightly related to the control painting.</p>

<p>First of all, we have to answer the question which any attentive 
reader already asks: When does the system decide the control needs to be
 painted? For each <code>HWND</code>, the system manages its window <em>update region</em> (also known as <em>dirty region</em>).
 The region describes part of the window, whose content is invalid and 
needs repainting. When the region is not empty, the system knows the 
control (actually its part as defined by the region) needs repainting 
and it will eventually send the control the <code>WM_PAINT</code> when there is no other message in the message queue of the window's thread.</p>

<p>Normally, the system does not remember the contents of a window. For 
example, whenever a window is moved to the edge of the screen so part of
 it is behind the corner, or whenever it is obscured by another window, 
the actual contents of the window is lost. After the window becomes 
fully visible once again, the system adds the unveiled part of the 
window into the update region which then eventually leads to requesting 
its repainting.</p>

<p>The control may also need to repaint itself or its part because its 
state or the data it shows has changed. To do so, the control simply may
 call a <code>Win32API </code>function to expand the update region <code>InvalidateRgn()</code>
 or one of its more specific relatives. In most cases, the region to be 
invalidated has a rectangular shape, so in most cases, the function <code>InvalidateRect()</code> is used instead.</p>

<p>I already noted that the repainting itself is also more complex than just sending the message <code>WM_PAINT</code>:</p>

<ol>
	<li>	<p>First, the system asks the control to erase its background with the message <code>WM_ERASEBKGND</code>. This may be as soon as the region is invalidated. The parameter <code>wParam</code>
 is set to the window's device context, which can be used to paint 
something. However the painting, if used at all, should be very fast, 
and usually consists of only filling the area with some background 
brush, hence effectively erasing its background. If the control passes 
the message into <code>DefWindowProc()</code>, this is exactly what happens. <code>DefWindowProc()</code> simply gets the brush which was specified during window class registration (<code>WNDCLASS::hbrBackground</code>)
 and fills the control with it. Have you ever seen a grayish window on 
your screen when your machine is very busy with some very CPU-intensive 
tasks and you bring open a new window or bring a window to the top of 
the Z-order? Well, this is the reason. The grayish window has already 
received the <code>WM_ERASEBKGND</code> but not yet <code>WM_PAINT</code>. The return value is also important, the message should return non-zero if it performs the erase, or zero if it does not. (<code>DefWindowProc()</code> follows it and returns non-zero if it filled the control with the background brush, or zero if it did not because the <code>WNDCLASS::hbrBackground</code> was set to <code>NULL</code>.) We will see soon what it is good for.</p>
	</li>	<li>	<p>If the update region also intersects the non-client area of the window, the system sends <code>WM_NCPAINT</code>.
 For top-level windows, this message is responsible for painting window 
caption, the minimize and maximize buttons, and also the menu if the 
window has any. For child windows (i.e., controls), it is often used for
 painting a border and also scrollbars if the control supports them in a
 similar way as, for examples, the standard list-view and tree-view 
controls do. If the control just passes the message into <code>DefWindowProc()</code>, it paints a border as specified by the window style <code>WS_BORDER </code>and/or extended style <code>WS_EX_CLIENTEDGE</code> and the scrollbars as set by <code>SetScrollInfo()</code>. For today, we leave the <code>WM_NCPAINT</code> aside and we will return to it in a future article.</p>
	</li>	<li>	<p>Finally, the <code>WM_PAINT</code> is sent. However, note
 that the system treats this message specially and it comes only after 
all other messages from the message queue are handled and it is empty. 
If you think about it, it makes sense. As long as there are other 
messages in the queue, they may change the state of the control, 
resulting in a need for yet another repainting.</p>
	</li></ol>

<p>The system assumes that a control uses <code>BeginPaint()</code> and <code>EndPaint()</code> when handling <code>WM_PAINT</code>. Between the two calls, the application is expected to paint the whole invalid region of the control.</p>

<p>The first function, <code>BeginPaint()</code>, initializes the pointed structure <code>PAINTSTRUCT</code> and returns the device context (<code>HDC</code>)
 to be painted on (the same handle as stored in the structure). Two 
members are often very useful when handling the painting: the member <code>fErase</code>, which is set to <code>TRUE</code> if the window has <strong>not</strong> been erased with <code>WM_ERASEBKGND</code> (i.e., depending on the value that message has returned), and the member <code>rcPaint</code>, which is the smallest rectangle enclosing the invalid region which needs repainting.</p>

<p>The latter function, <code>EndPaint()</code>, frees any resources taken by <code>BeginPaint()</code>
 (e.g. the device context), and it also validates the invalid region, 
i.e., the invalid region of the control becomes empty after this call.</p>

<h2>The Flickering Problem</h2>

<p>Often, when a non-experienced control developer creates his first 
custom control, he is quite happy with it until he uses it in an 
application which resizes it together with the main window it resides 
in. When running it, he is then surprised by its ugly flickering. It is a
 wide-spread problem, so we will pay special attention to it.</p>

<p>If you already understand how Windows manages the painting from the section above, you probably already can see the culprit:</p>

<ul>
	<li>As the user is resizing the main application window, it gets <code>WM_SIZE</code> and in response it resizes the control.</li>	<li>The custom control's window procedure likely propagates its <code>WM_SIZE</code> into <code>DefWindowProc()</code>. That function (reasonably) invalidates the whole control, assuming its window class was registered with <code>CS_HREDRAW</code> and <code>CS_VREDRAW</code> as it commonly is.</li>	<li>In response to invalidation, the control gets <code>WM_ERASEBKGND</code> which by default fills the whole window client according to the brush used when registering its class.</li>	<li>Very soon then-after the control gets <code>WM_PAINT</code>, painting itself fully in all its glory.</li>	<li>As
 the user continues to resize the window by dragging the mouse, all of 
this happens again and again, causing the effect of flickering, how the 
control goes from erased to fully painted state and back again in short 
succession.</li></ul>

<h2>Solving the Flickering</h2>

<p>If you know the cause of the issue, it is quite easy to formulate 
hints for avoiding it. But let's list them here anyway for the sake of 
completeness. I tried to list the hints in the order of their importance
 (which, of course, is a subject of my personal preference to some 
degree).</p>

<ol>
	<li>	<p>If possible, do not rely on <code>WM_ERASEBKGND</code>, i.e., let it return non-zero without passing it into <code>DefWindowProc()</code>. Often, <code>WM_PAINT</code> can paint all the background of the dirty region and there is no need for such erasing.</p>
	</li>	<li>	<p>If you need to handle erasing specially from the painting itself, it can often be optimized so that <code>WM_ERASEBKGND</code> still does nothing but returns non-zero, and the handler of <code>WM_PAINT</code> can do the "erasing" by also painting the areas not covered by the regular paint code when <code>PAINTSTRUCT::fErase</code> is set.</p>
	</li>	<li>	<p>To the reasonable degree, try hard to design the painting
 code so that it does not repaint the same pixels multiple times. E.g., 
to paint blue rect with red border, do not <code>FillRect(red)</code> followed with <code>FillRect(blue)</code>
 to repaint the inner contents from red to blue. Rather paint the red 
border as 4 smaller rectangle not overlapped with the blue contents.</p>
	</li>	<li>	<p>For complex controls, the paint code may be often 
optimized to skip a lot of painting outside the invalid rectangle as 
specified by <code>PAINTSTRUCT::rcPaint</code>, by proper organizing the control data.</p>
	</li>	<li>	<p>When changing the control state, invalidate only the minimal required region of the control.</p>
	</li>	<li>	<p>When the flickering still happens during resizing, consider to not using <code>CS_HREDRAW</code> and <code>CS_VREDRAW</code>. Instead, invalidate the relevant parts of the control in handling the <code>WM_SIZE</code> manually. Often much smaller parts of the control may need repainting.</p>
	</li>	<li>	<p>When the control supports scrollbars, and using them leads to flickering, make sure the scrolling code uses <code>ScrollWindow()</code> function instead of invalidating whole control area. (Note we will cover the topic of scrolling in one of the sequel articles.)</p>
	</li>	<li>	<p>Generally, the flickering effect is also reduced when the
 painting performs better. If your paint method does not rely on the 
system setting the clipping rectangle to the client rectangle of the 
control, you may use window class style <code>CS_PARENTDC</code> when registering the control window class, leading to less work for <code>BeginPaint()</code>.</p>
	</li></ol>

<p>Note that although some of the points above may seem like a lot of 
work for a developer, it is very often a work which will be needed to be
 done anyway for a fully featured control which implements, for example,
 features like hit testing (<code>WM_HITTEST</code>). A lot of the code 
then may be reused. For example, consider a control which paints a table
 of some sort, each cell providing some interactive response when a user
 clicks in it. Then the code must be aware of the layout of the table, 
and the code computing the layout may be reused for the paint 
implementation and hit testing implementation.</p>

<p>In case everything above fails, there is also a magical band called <em>double buffering</em> which can solve the flickering in all cases (assuming the erasing via <code>WM_ERASEBKGND</code> is suppressed and delayed to <code>WM_PAINT</code>).
 But there is some price to pay for using it: higher resource 
consumption, especially memory. Even if your control still has the 
flickering problem after all you did in some situation, I recommend to 
use double-buffering only if the application explicitly requested for 
that (e.g., by specifying a style for it) because often the application 
never allows the situation when the flickering occurs (e.g., the 
application never resizes the control).</p>

<h2>Double Buffering</h2>

<p>Double buffering is a painting technique based on the fact that you 
may paint the code into a memory-based bitmap instead of directly on the
 screen, and then, after all the complex painting is done, you may copy (<em>blit</em>) the whole bitmap on the screen in a brisk.</p>

<p>Let's present a sample code of how it may look like. We start with 
the trivial control implementation and from the previous part, add the 
double buffering code:</p>

<div class="pre-action-link" id="premain754173" style="width:100%;display:block;"><span id="prehide754173" onclick="processCodeBlocks.togglePre(754173);">Hide</span>  &nbsp; <span id="copycode754173" onclick="return processCodeBlocks.copyCode(754173);">Copy Code</span></div><pre id="pre754173" style="margin-top: 0px;" class="notranslate" lang="C++"><span class="code-comment">/*</span><span class="code-comment"> custom.h
 * (custom control interface)
 */</span>
 
<span class="code-comment">//</span><span class="code-comment"> ...</span>

<span class="code-comment">/*</span><span class="code-comment"> Style to request using double buffering. */</span>
<span class="code-preprocessor">#define XXS_DOUBLEBUFFER         (0x0001)
</span>
<span class="code-comment">//</span><span class="code-comment"> ...</span></pre>

<div class="pre-action-link" id="premain847486" style="width:100%;display:block;"><span id="prehide847486" onclick="processCodeBlocks.togglePre(847486);">Hide</span>  &nbsp; <span id="preShrink847486" onclick="processCodeBlocks.shrinkExpand(847486);">Shrink</span> <img id="preimg847486" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(847486);">  &nbsp; <span id="copycode847486" onclick="return processCodeBlocks.copyCode(847486);">Copy Code</span></div><pre id="pre847486" style="margin-top: 0px;" processed="true" class="notranslate" lang="C++"><span class="code-comment">/*</span><span class="code-comment"> custom.c
 * (custom control implementation)
 */</span>

<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">custom.h"</span>
</span>
<span class="code-keyword">static</span> <span class="code-keyword">void</span>
CustomPaint(HWND hwnd, HDC hDC, RECT* rcDirty, BOOL bErase)
{
    <span class="code-comment">//</span><span class="code-comment"> ... Paint the control here.</span>
}

<span class="code-keyword">static</span> <span class="code-keyword">void</span>
CustomDoubleBuffer(HWND hwnd, PAINTSTRUCT* pPaintStruct)
{
    <span class="code-keyword">int</span> cx = pPaintStruct-&gt;rcPaint.right - pPaintStruct-&gt;rcPaint.left;
    <span class="code-keyword">int</span> cy = pPaintStruct-&gt;rcPaint.bottom - pPaintStruct-&gt;rcPaint.top;
    HDC hMemDC;
    HBITMAP hBmp;
    HBITMAP hOldBmp;
    POINT ptOldOrigin;

    <span class="code-comment">//</span><span class="code-comment"> Create new bitmap-back device context, large as the dirty rectangle.</span>
    hMemDC = CreateCompatibleDC(pPaintStruct-&gt;hdc);
    hBmp = CreateCompatibleBitmap(pPaintStruct-&gt;hdc, cx, cy);
    hOldBmp = SelectObject(hMemDC, hBmp);

    <span class="code-comment">//</span><span class="code-comment"> Do the painting into the memory bitmap.</span>
    OffsetViewportOrgEx(hMemDC, -(pPaintStruct-&gt;rcPaint.left),
                        -(pPaintStruct-&gt;rcPaint.top), &amp;ptOldOrigin);
    CustomPaint(hwnd, hMemDC, &amp;pPaintStruct-&gt;rcPaint, TRUE);
    SetViewportOrgEx(hMemDC, ptOldOrigin.x, ptOldOrigin.y, NULL);

    <span class="code-comment">//</span><span class="code-comment"> Blit the bitmap into the screen. This is really fast operation and although</span>
    <span class="code-comment">//</span><span class="code-comment"> the CustomPaint() can be complex and slow there will be no flicker any more.</span>
    BitBlt(pPaintStruct-&gt;hdc, pPaintStruct-&gt;rcPaint.left, pPaintStruct-&gt;rcPaint.top,
           cx, cy, hMemDC, <span class="code-digit">0</span>, <span class="code-digit">0</span>, SRCCOPY);

    <span class="code-comment">//</span><span class="code-comment"> Clean up.</span>
    SelectObject(hMemDC, hOldBmp);
    DeleteObject(hBmp);
    DeleteDC(hMemDC);
}

<span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_ERASEBKGND:
            <span class="code-keyword">return</span> FALSE;  <span class="code-comment">//</span><span class="code-comment"> Defer erasing into WM_PAINT</span>

        <span class="code-keyword">case</span> WM_PAINT:
        {
            PAINTSTRUCT ps;
            BeginPaint(hwnd, &amp;ps);
            <span class="code-keyword">if</span>(GetWindowLong(hwnd, GWL_STYLE) &amp; XXS_DOUBLEBUFFER)
                CustomDoubleBuffer(hwnd, &amp;ps);
            <span class="code-keyword">else</span>
                CustomPaint(hwnd, ps.hdc, &amp;ps.rcPaint, ps.fErase);
            EndPaint(hwnd, &amp;ps);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
        }

        <span class="code-comment">//</span><span class="code-comment"> ...</span>
    }
    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<p>As it can be seen, the prototype of the function <code>CustomPaint()</code> has changed: It is now capable of painting the current control state to any device context, not just on the screen. The <code>BeginPaint()</code> and <code>EndPaint()</code> machinery has moved directly to the <code>WM_PAINT</code> handler. When double buffering is enabled (the control has the style <code>XXS_DOUBLEBUFFER</code>), the function <code>CustomDoubleBuffer()</code> is called to paint the control onto a temporary bitmap, which is then copied on the device context retrieved by <code>BeginPaint()</code>.</p>

<p>A few other things are worthy of any note as the code is quite self-explanatory:</p>

<ul>
	<li>	<p>When using the double buffering, we always pass <code>bErase</code> as <code>TRUE</code> because, obviously, when double-buffered, the in-memory bitmap must be painted completely from scratch.</p>
	</li>	<li>	<p>As a small optimization, instead of allocating a bitmap 
for the complete control's client area, we allocate only as small as 
needed for the dirty region. Then we compensate the change in 
coordinates between the control's top left corner and the dirty rect's 
top left corner by arranging the proper view-port origin temporarily.</p>
	</li>	<li>	<p>The control creates and destroys the bitmap each time <code>WM_PAINT</code>
 is received. It is a potentially costly operation so this could be 
further optimized by some appropriate caching strategy of the bitmap for
 reuse. However, as the bitmap is potentially quite large and 
memory-hungry, you should not hold it all the time. In the real world, 
the control gets many <code>WM_PAINT</code> messages in a short period 
of time when the user is using it, or none for longer periods of time 
when he is not (e.g., when the application window is minimized) so the 
cache should be a bit smart. Something like that would make the example 
much longer and I believe the reader can take this as an opportunity for
 a small exercise of his own creativity.</p>
	</li></ul>

<p>(Again, an example Visual Studio 2010 project is attached. It is a 
slightly enhanced and more complete version of the code presented here.)</p>

<h2>Message WM_PRINTCLIENT</h2>

<p>There is yet another message worth mentioning, related to painting. 
The controls aspiring on a position of good citizen in the Windows 
environment should also support the message <code>WM_PRINTCLIENT</code>. In short, this message asks the control to paint itself into the provided device context (via <code>WPARAM</code>).
 Printing in Windows, for example, takes use of this. Various tools like
 screen zooming or thumbnailing utilities may use it. Some coding tricks
 like painting on a glass window border are possible by using this 
message (but that is out of our topic, at least for today).</p>

<p>Note our new version of <code>CustomPaint()</code> is exactly suitable for such purpose so implementing this message is a very straightforward task:</p>

<div class="pre-action-link" id="premain338676" style="width:100%;display:block;"><span id="prehide338676" onclick="processCodeBlocks.togglePre(338676);">Hide</span>  &nbsp; <span id="copycode338676" onclick="return processCodeBlocks.copyCode(338676);">Copy Code</span></div><pre id="pre338676" style="margin-top: 0px;" class="notranslate" lang="C++"><span class="code-keyword">static</span> LRESULT CALLBACK
CustomProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    <span class="code-keyword">switch</span>(uMsg) {
        <span class="code-comment">//</span><span class="code-comment"> ...</span>

        <span class="code-keyword">case</span> WM_PRINTCLIENT:
        {
            RECT rc;
            GetClientRect(hwnd, &amp;rc);
            CustomPaint(hwnd, (HDC) wParam, &amp;rc, TRUE);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
        }

        <span class="code-comment">//</span><span class="code-comment"> ...</span>
    }
    <span class="code-keyword">return</span> DefWindowProc(hwnd, uMsg, wParam, lParam);
}</pre>

<h2>Next Time: Visual Styles</h2>

<p>I omitted talking about one API closely related to painting of controls. It is an API which provides support for <em>visual themes</em> (implemented by <em>UXTHEME.DLL</em>). As it was introduced in Windows XP, it is sometimes also referred as <em>XP theming</em>. In these days, the controls simply must be theme-aware if they want to fit into the Windows look and feel.</p>

<p>Though, it is quite a complex topic of its own, so the next time a whole article will be dedicated to it.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=508008"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=300x250&c=508008"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Custom%20Controls%20in%20Win32%20API%3a%20The%20Painting%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Custom+Controls+in+Win32+API%3a+The+Painting+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting&amp;title=Custom+Controls+in+Win32+API%3a+The+Painting+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting&amp;title=Custom+Controls+in+Win32+API%3a+The+Painting+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting&amp;description=Custom+Controls+in+Win32+API%3a+The+Painting+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/58de2d085c17e28b8951315245dd408c.jpg" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Martin-Mitas">Martin Mitáš</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" valign="middle" nowrap="nowrap">
            <div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowOn" class="follow">
	            
	            
	            <a href="https://www.linkedin.com/profile/view?id=88607525"><img style="vertical-align:middle;border:0;height:24px;width:24px" alt="LinkedIn" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/linkedin-32.png"></a> 
            </div>
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Team Leader</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                <a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn" title="" class="button unfollowed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Have the articles and posts from this member appear in your Timeline so you can stay up to date." style="display: inline-block;">Follow<div class="tiny-text" style="margin-top:-3px;">this Member</div><div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Have the articles and posts from this member appear in your Timeline so you can stay up to date.</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>
	<a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn" title="" class="button followed align-center invisible tooltip" data-enabletooltip="true" data-tooltip="Stop following this Member" style="display:none;">Unfollow<div class="speech-bubble-container-up" style="width:150px">  <div class="speech-bubble-up" style="text-align:center"> Stop following this Member</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>

            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Czech Republic <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/CZ.gif" alt="Czech Republic" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-loadonview="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=508008"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=728x90&c=508008"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellspacing="0" cellpadding="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="3px" border="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="button new-message compose float-left">
<a rel="nofollow" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting" name="Frm_HoverNL" target="_top">Add a Comment or Question&nbsp;</a>
</div><div class="admin-links float-left align-middle" style="width:90px;line-height:24px;margin-top:4px;">
&nbsp;<a href="https://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/help_sm.png" title="FAQ" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;"></a>
</div><div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1836867"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" value="Search Comments"><input type="image" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/search.gif">
</form>
</div><div class="tooltip email-alert" id="ctl00_MessageBoard_SubscribeDiv">
	<span class="nowrap medium-text">Email Alerts</span><div class="tooltip-flyout" style="width: 335px;margin-top: 24px;left: -270px;padding: 7px;">
		<b>Email me</b><input type="checkbox" id="ctl00_MessageBoard_SubscribeNew"><label for="ctl00_MessageBoard_SubscribeNew">New Posts</label><input type="checkbox" id="ctl00_MessageBoard_SubscribeReplies"><label for="ctl00_MessageBoard_SubscribeReplies">Replies to Posts</label><br><br><b>Send them</b><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeInstant"><label for="ctl00_MessageBoard_SubscribeInstant">Instantly</label><input type="radio" name="ctl00$MessageBoard_SubscribeSchedule" id="ctl00_MessageBoard_SubscribeDaily"><label for="ctl00_MessageBoard_SubscribeDaily">Daily</label>&nbsp; <b>For</b> <select id="ctl00_MessageBoard_MessageType" class="tiny-text" style="width:80px;">
			<option value="0" selected="selected">
				All Types
			</option><option value="128">
				Announcements
			</option>
		</select><button class="button safe float-right update">Update</button>
	</div>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting&amp;fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1836867"><input type="hidden" name="currentQS" value="floc=%2fArticles%2f617212%2fCustom-Controls-in-Win-API-The-Painting&amp;fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True"><input type="hidden" name="floc" value="/Articles/617212/Custom-Controls-in-Win-API-The-Painting">Spacing<select size="1" class="dropdown" name="spc">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table width="100%" cellspacing="0" cellpadding="2px" border="0">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table class="fixed-layout blank-background" width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr id="F5341939_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5341939xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5341939" parent="0" thread="5341939" href="https://www.codeproject.com/Messages/5341939/Selecting-back-things-that-are-destroyed-anyway.aspx">Selecting back things that are destroyed anyway</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Sergiy Bogdancev</span><span class="date">26-Dec-16  16:21</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7828517">Sergiy Bogdancev</a></span></td><td class="date"><span>26-Dec-16  16:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5341939_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7828517" msgid="5341939" votingtype="GoodOrBad" done="true"><a href="#xx5341939xx" onclick="return rateItem(5, 5341939,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5341939xx" onclick="return rateItem(1, 5341939,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Martin<br>
<br>
In double-buffering I select font, brush and pen into hMemDC:<br>
<div class="pre-action-link" id="premain934985" style="width:100%;display:block;"><span id="prehide934985" onclick="processCodeBlocks.togglePre(934985);">Hide</span>  &nbsp; <span id="preShrink934985" onclick="processCodeBlocks.shrinkExpand(934985);">Shrink</span> <img id="preimg934985" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(934985);">  &nbsp; <span id="copycode934985" onclick="return processCodeBlocks.copyCode(934985);">Copy Code</span></div><pre id="pre934985" style="margin-top: 0px;" class="notranslate" lang="c++">HPEN hOldPen = (HPEN)SelectObject(hMemDC, pData-&gt;hP_Pressed);
HBRUSH hOldBrush = (HBRUSH)SelectObject(hMemDC, pData-&gt;hBr_Idle_Disabled);
HFONT hOldFont = (HFONT)SelectObject(hMemDC, pData-&gt;hFont);</pre>Is it necessary to select back old pen, brush and font once I've done painting and before destroying hMemDC?<br>
<br>
Regards, Sergiy<br><br><div class="modified">modified  26-Dec-16 15:40pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5341939&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5341939&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5341939" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5341939" data-ref="3_5341939" class="rating-label" name="RateItem_5341939"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5341939/Selecting-back-things-that-are-destroyed-anyway.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5341939"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="7828517" msgid="5341939"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5341951_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx5341951xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5341951" parent="5341939" thread="5341939" href="https://www.codeproject.com/Messages/5341951/Re-Selecting-back-things-that-are-destroyed-anyway.aspx">Re: Selecting back things that are destroyed anyway</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">26-Dec-16  18:07</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>26-Dec-16  18:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5341951_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="5341951" votingtype="GoodOrBad" done="true"><a href="#xx5341951xx" onclick="return rateItem(5, 5341951,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5341951xx" onclick="return rateItem(1, 5341951,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5341939);" href="https://www.codeproject.com/Messages/5341939/Selecting-back-things-that-are-destroyed-anyway.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It's simple question with very complicated exact answer because it depends on many things.<br>

<ul>
<li>How the given <code>HDC</code> and its lifetime is managed. That depends on window class styles likes e.g. <code>CS_OWNERDC</code>, <code>CS_PARENTDC</code> etc. (in case of <code>WM_PAINT</code>) or how the <code>HDC</code> has been created/obtained.</li><li>How you manage lifetime of GDI objects you sometimes select to <code>HDC</code>. You could easily cause a leak of e.g. <code>HBRUSH</code> that was originally selected to the <code>HDC</code> if do not select the old one back.</li><li>You must not get into clash with rules like you cannot destroy a GDI object while it is being selected to any <code>HDC</code>.</li></ul>
etc.<br>
<br>
Consider also that it is often very useful to have painting code universal enough to paint to <em>any</em> provided <code>HDC</code>. In case of control you may then use it:<br>

<ul>
<li>for <code>WM_PAINT</code> (without caring much about <code>CS_xxxx</code> styles and their peculiarities).</li><li>for <code>WM_PRINTCLIENT</code> which paints to a <code>HDC</code> you absolutely do not have under your control.</li><li>for painting e.g. a part of control (item) into a temporary bitmap (outside <code>WM_PAINT</code>), so you then may implement some drag&amp;drop with it.</li></ul>
So, unless you really know what you do and know why you can do it in the
 given situation, the rule is: "always restore the original state".<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5341951&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5341951&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5341939" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5341951" data-ref="3_5341951" class="rating-label" name="RateItem_5341951"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5341951/Re-Selecting-back-things-that-are-destroyed-anyway.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5341951"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5341951"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338076_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5338076xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5338076" parent="0" thread="5338076" href="https://www.codeproject.com/Messages/5338076/OffsetViewportOrgEx.aspx">OffsetViewportOrgEx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Sergiy Bogdancev</span><span class="date">13-Dec-16  15:21</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7828517">Sergiy Bogdancev</a></span></td><td class="date"><span>13-Dec-16  15:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338076_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7828517" msgid="5338076" votingtype="GoodOrBad" done="true"><a href="#xx5338076xx" onclick="return rateItem(5, 5338076,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5338076xx" onclick="return rateItem(1, 5338076,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Martin<br>
First of all, thanx for sharing your knowledge, it really helps.<br>
<br>
It seems I cannot get the function <b>OffsetViewportOrgEx</b>. MSDN 
gives 1 sentence description and googling it gives similar to MSDN. 
Searching it on Codeproject gives your article only, and stackoverflow's
 double buffering articles do without it.<br>
<br>
Could you please explain in details what it does and why you pass 
negative values. Would there be a way without it in your example? It 
bugs me really!<br>
<br>
Thanx, Sergiy<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338076&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338076&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5338076" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5338076" data-ref="3_5338076" class="rating-label" name="RateItem_5338076"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5338076/OffsetViewportOrgEx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5338076"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="7828517" msgid="5338076"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338148_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx5338148xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5338148" parent="5338076" thread="5338076" href="https://www.codeproject.com/Messages/5338148/Re-OffsetViewportOrgEx.aspx">Re: OffsetViewportOrgEx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">13-Dec-16  19:53</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>13-Dec-16  19:53&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338148_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="5338148" votingtype="GoodOrBad" done="true"><a href="#xx5338148xx" onclick="return rateItem(5, 5338148,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5338148xx" onclick="return rateItem(1, 5338148,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5338076);" href="https://www.codeproject.com/Messages/5338076/OffsetViewportOrgEx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>The two functions <tt>OffsetViewportOrgEx()</tt> and <tt>SetViewportOrgEx()</tt> change logical origin of GDI coordinate system associated with the given <tt>HDC</tt>.
 The first function does it relatively, the other one absolutely. For 
example, if we set logical origin of the device context to [10,10], then
 <tt>SetPixel(hdc, 0, 0, RGB(0,0,0))</tt> will really paint the pixel at [10,10] and not [0,0].<br>
<br>
In the article we use it for the double-buffering. Note the bitmap we paint into with the <tt>hMemDc</tt>
 generally does not cover whole window because we create it only large 
enough to cover the invalid region in order to save some memory. As a 
consequence its top-left corner does not generally correspond to the 
top-left corner of the control's client area.<br>
<br>
Therefore we temporarily change the logical origin to compensate this. 
The control's painting code then does not need to care whether it is 
painting to bitmap or directly to the window and for it, [0,0] always 
corresponds to the left-top corner of the window, even if the bitmap 
corresponds to small area anywhere inside the control's client area.<br>
<br>
EDIT: To answer your 2nd question, yes, we could do without it. I can see two ways:<br>

<ol>
<li>We could create the bitmap as large as the control's client area. 
Disadvantage is we allocate potentially much more memory then really 
needed.</li><li>Or we could make the control's painting code more 
complicated by (in the case of double-buffering) manually adding the 
offsets to EVERY coordinate we use in the painting code. Disadvantage of
 this approach is we get ugly code which is harder to maintain.</li></ol><br><br><div class="modified">modified  13-Dec-16 19:09pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338148&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338148&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5338076" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5338148" data-ref="3_5338148" class="rating-label" name="RateItem_5338148"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/5338148/Re-OffsetViewportOrgEx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5338148"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5338148"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338231_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx5338231xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5338231" parent="5338148" thread="5338076" href="https://www.codeproject.com/Messages/5338231/Re-OffsetViewportOrgEx.aspx">Re: OffsetViewportOrgEx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Sergiy Bogdancev</span><span class="date">14-Dec-16  4:57</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7828517">Sergiy Bogdancev</a></span></td><td class="date"><span>14-Dec-16  4:57&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5338231_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="7828517" msgid="5338231" votingtype="GoodOrBad" done="true"><a href="#xx5338231xx" onclick="return rateItem(5, 5338231,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5338231xx" onclick="return rateItem(1, 5338231,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7828517);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5338148);" href="https://www.codeproject.com/Messages/5338148/Re-OffsetViewportOrgEx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanx again. It really now makes sense to me.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338231&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5338231&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5338076" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5338231" data-ref="3_5338231" class="rating-label" name="RateItem_5338231"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5338231/Re-OffsetViewportOrgEx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5338231"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="7828517" msgid="5338231"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5184926_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx5184926xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_bug.gif" alt="Bug" title="Bug" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5184926" parent="0" thread="5184926" href="https://www.codeproject.com/Messages/5184926/Logical-error.aspx">Logical error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">FLASHPOINT1983</span><span class="date">10-Jan-16  15:41</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7221597">FLASHPOINT1983</a></span></td><td class="date"><span>10-Jan-16  15:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5184926_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7221597" msgid="5184926" votingtype="GoodOrBad" done="true"><a href="#xx5184926xx" onclick="return rateItem(5, 5184926,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7221597);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5184926xx" onclick="return rateItem(1, 5184926,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',7221597);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi! I think there is a problem in code below (dblbuf.zip , custom.c , line 86), <br>
<div class="pre-action-link" id="premain340855" style="width:100%;display:block;"><span id="prehide340855" onclick="processCodeBlocks.togglePre(340855);">Hide</span>  &nbsp; <span id="preShrink340855" onclick="processCodeBlocks.shrinkExpand(340855);">Shrink</span> <img id="preimg340855" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(340855);">  &nbsp; <span id="copycode340855" onclick="return processCodeBlocks.copyCode(340855);">Copy Code</span></div><pre id="pre340855" style="margin-top: 0px;" class="notranslate" lang="c++"><span class="code-keyword">case</span> WM_PAINT:
        {
            PAINTSTRUCT ps;
            BeginPaint(hwnd, &amp;ps);
			<span class="code-comment">//</span><span class="code-comment"> We let application to choose whether to use double buffering or not by using the style CCS_DOUBLEBUFFER.</span>
            <span class="code-keyword">if</span>(pData-&gt;style &amp; XXS_DOUBLEBUFFER)
                CustomDoubleBuffer(pData, &amp;ps);
            <span class="code-keyword">else</span>
                CustomPaint(pData, ps.hdc, &amp;ps.rcPaint, ps.fErase);
            EndPaint(hwnd, &amp;ps);
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
		}</pre><br>
Should be<br>
<div class="pre-action-link" id="premain478198" style="width:100%;display:block;"><span id="prehide478198" onclick="processCodeBlocks.togglePre(478198);">Hide</span>  &nbsp; <span id="preShrink478198" onclick="processCodeBlocks.shrinkExpand(478198);">Shrink</span> <img id="preimg478198" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(478198);">  &nbsp; <span id="copycode478198" onclick="return processCodeBlocks.copyCode(478198);">Copy Code</span></div><pre id="pre478198" style="margin-top: 0px;" class="notranslate" lang="c++"><span class="code-keyword">if</span>(pData-&gt;style &amp;<b>&amp;</b> XXS_DOUBLEBUFFER)
)</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5184926&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5184926&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5184926" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5184926" data-ref="3_5184926" class="rating-label" name="RateItem_5184926"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5184926/Logical-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5184926"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="7221597" msgid="5184926"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5185111_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx5185111xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="5185111" parent="5184926" thread="5184926" href="https://www.codeproject.com/Messages/5185111/Re-Logical-error.aspx">Re: Logical error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">11-Jan-16  5:52</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>11-Jan-16  5:52&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5185111_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="5185111" votingtype="GoodOrBad" done="true"><a href="#xx5185111xx" onclick="return rateItem(5, 5185111,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx5185111xx" onclick="return rateItem(1, 5185111,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5184926);" href="https://www.codeproject.com/Messages/5184926/Logical-error.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>No.
 There must be bit-wise and (&amp;) and not logical one (&amp;&amp;). 
Your condition would be quivalent to (pData-&gt;style != 0) becase 
XXS_DOUBLEBUFFER is always nonzero. In contrast, the condition with the 
bit-wise and tests whether the one particular bit (XXS_DOUBLEBUFFER) in 
the bitmask pData-&gt;style is set or not.<br>
<br>
See <a href="https://en.wikipedia.org/wiki/Bitwise_operations_in_C" rel="nofollow noopener">Bitwise operations in C - Wikipedia, the free encyclopedia</a>[<a href="https://en.wikipedia.org/wiki/Bitwise_operations_in_C" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5185111&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=5185111&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5184926" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF5185111" data-ref="3_5185111" class="rating-label" name="RateItem_5185111"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/5185111/Re-Logical-error.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_5185111"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="5185111"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4630427_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4630427xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4630427" parent="0" thread="4630427" href="https://www.codeproject.com/Messages/4630427/Nice-series-my-5.aspx">Nice series (my 5)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">H.Brydon</span><span class="date">6-Aug-13  18:47</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6496963">H.Brydon</a></span></td><td class="date"><span>6-Aug-13  18:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4630427_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6496963" msgid="4630427" votingtype="GoodOrBad" done="true"><a href="#xx4630427xx" onclick="return rateItem(5, 4630427,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6496963);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4630427xx" onclick="return rateItem(1, 4630427,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',6496963);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">I've been programming this technology for a while and I learned something useful!<br>
<br>
+5<br>
<div class="signature">--<br>
Harvey</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4630427&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4630427&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4630427" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4630427" data-ref="3_4630427" class="rating-label" name="RateItem_4630427"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4630427/Nice-series-my-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4630427"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="6496963" msgid="4630427"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4630439_h0" class="header hover-row">
<td class="subject-line normal  vote-hi" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4630439xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4630439" parent="4630427" thread="4630427" href="https://www.codeproject.com/Messages/4630439/Re-Nice-series-my-5.aspx">Re: Nice series (my 5)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">6-Aug-13  19:07</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>6-Aug-13  19:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4630439_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4630439" votingtype="GoodOrBad" done="true"><a href="#xx4630439xx" onclick="return rateItem(5, 4630439,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4630439xx" onclick="return rateItem(1, 4630439,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4630427);" href="https://www.codeproject.com/Messages/4630427/Nice-series-my-5.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Nice to hear that <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/smiley_smile.gif" alt="Smile | :)" align="top"> <br>
Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4630439&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4630439&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4630427" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4630439" data-ref="3_4630439" class="rating-label" name="RateItem_4630439"><span class="rating-result"><span>5.00/5 (1 vote)</span></span></span><a href="https://www.codeproject.com/Messages/4630439/Re-Nice-series-my-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4630439"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4630439"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4619024_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4619024xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4619024" parent="0" thread="4619024" href="https://www.codeproject.com/Messages/4619024/This-is-a-great-series-of-articles.aspx">This is a great series of articles!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Paul M Watt</span><span class="date">23-Jul-13  11:56</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-mentor-16.gif" title="mentor" alt="mentor" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=28002">Paul M Watt</a></span></td><td class="date"><span>23-Jul-13  11:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4619024_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="28002" msgid="4619024" votingtype="GoodOrBad" done="true"><a href="#xx4619024xx" onclick="return rateItem(5, 4619024,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',28002);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4619024xx" onclick="return rateItem(1, 4619024,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',28002);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">First, thank you very much for referring your readers to my GDI articles.  <br>
Second, there is one article of mine that is more relevant to your article than the 5 that you listed combined:<br>
<a href="http://www.codeproject.com/Articles/224754/Guide-to-Win32-Memory-DC" rel="nofollow noopener">Guide to Win32 Memory DC</a>[<a href="http://www.codeproject.com/Articles/224754/Guide-to-Win32-Memory-DC" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br>
This article details the how and why rather than the more practical 
information that you have presented for the context of creating 
controls.<br>
<br>
Finally, I have looked through all of your articles in this series and I
 think you have done a great job of presenting all of the details that 
need to be considered for control design. For example listing 
WM_PRINT_CLIENT.<br>
<br>
Keep up the great work. I look forward to future articles.<br>
<div class="signature">To know and not do, is not yet to know</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4619024&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4619024&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4619024" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4619024" data-ref="3_4619024" class="rating-label" name="RateItem_4619024"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4619024/This-is-a-great-series-of-articles.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4619024"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="28002" msgid="4619024"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4619040_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4619040xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4619040" parent="4619024" thread="4619024" href="https://www.codeproject.com/Messages/4619040/Re-This-is-a-great-series-of-articles.aspx">Re: This is a great series of articles!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">23-Jul-13  12:08</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>23-Jul-13  12:08&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4619040_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4619040" votingtype="GoodOrBad" done="true"><a href="#xx4619040xx" onclick="return rateItem(5, 4619040,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4619040xx" onclick="return rateItem(1, 4619040,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4619024);" href="https://www.codeproject.com/Messages/4619024/This-is-a-great-series-of-articles.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks. The referred article was omitted by accident rather then by intent. I'll add it.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4619040&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4619040&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4619024" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4619040" data-ref="3_4619040" class="rating-label" name="RateItem_4619040"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4619040/Re-This-is-a-great-series-of-articles.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4619040"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4619040"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4627768_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx4627768xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4627768" parent="4619040" thread="4619024" href="https://www.codeproject.com/Messages/4627768/Re-This-is-a-great-series-of-articles.aspx">Re: This is a great series of articles!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Paul M Watt</span><span class="date">3-Aug-13  3:20</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-mentor-16.gif" title="mentor" alt="mentor" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=28002">Paul M Watt</a></span></td><td class="date"><span>3-Aug-13  3:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4627768_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="28002" msgid="4627768" votingtype="GoodOrBad" done="true"><a href="#xx4627768xx" onclick="return rateItem(5, 4627768,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',28002);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4627768xx" onclick="return rateItem(1, 4627768,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',28002);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4619040);" href="https://www.codeproject.com/Messages/4619040/Re-This-is-a-great-series-of-articles.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I assumed it was an oversight, or the possibility that you were not aware of it. <br>
<br>
I wanted to point out the greater relevancy of the MemDC article to 
double-buffering compared to all my other articles. If you only wanted 
to list one, the MemDC guide would be the one. I am grateful that you 
provided links to all of my GDI articles.<br>
<br>
After all, this article is your work and I do not want to take any focus away from it. <br>
<br>
This is a clear and complete article that describes the factors that 
must be considered when creating a custom control on Windows. <br>
I gave you a 5 for your work.<br>
<br>
I want to thank you again.<br>
<div class="signature">To know and not do, is not yet to know</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4627768&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4627768&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4619024" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4627768" data-ref="3_4627768" class="rating-label" name="RateItem_4627768"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4627768/Re-This-is-a-great-series-of-articles.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4627768"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="28002" msgid="4627768"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618468_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4618468xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4618468" parent="0" thread="4618468" href="https://www.codeproject.com/Messages/4618468/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">gordon88</span><span class="date">22-Jul-13  21:56</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=870994">gordon88</a></span></td><td class="date"><span>22-Jul-13  21:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618468_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="870994" msgid="4618468" votingtype="GoodOrBad" done="true"><a href="#xx4618468xx" onclick="return rateItem(5, 4618468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',870994);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4618468xx" onclick="return rateItem(1, 4618468,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',870994);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Great! many things I guessed properly confirmed<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4618468&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4618468&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4618468" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4618468" data-ref="3_4618468" class="rating-label" name="RateItem_4618468"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4618468/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4618468"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="870994" msgid="4618468"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617615_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4617615xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4617615" parent="0" thread="4617615" href="https://www.codeproject.com/Messages/4617615/My-vote-of-5.aspx">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">imagiro</span><span class="date">22-Jul-13  4:19</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=195820">imagiro</a></span></td><td class="date"><span>22-Jul-13  4:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4617615_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="195820" msgid="4617615" votingtype="GoodOrBad" done="true"><a href="#xx4617615xx" onclick="return rateItem(5, 4617615,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',195820);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4617615xx" onclick="return rateItem(1, 4617615,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',195820);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Very good article, very useful information, nicely 
written! I wish I would have such an article when I fired up VS the 
first time!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4617615&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617615" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4617615" data-ref="3_4617615" class="rating-label" name="RateItem_4617615"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4617615/My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4617615"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="195820" msgid="4617615"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618192_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4618192xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4618192" parent="4617615" thread="4617615" href="https://www.codeproject.com/Messages/4618192/Re-My-vote-of-5.aspx">Re: My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">22-Jul-13  14:23</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>22-Jul-13  14:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4618192_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4618192" votingtype="GoodOrBad" done="true"><a href="#xx4618192xx" onclick="return rateItem(5, 4618192,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4618192xx" onclick="return rateItem(1, 4618192,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4617615);" href="https://www.codeproject.com/Messages/4617615/My-vote-of-5.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4618192&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4618192&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4617615" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4618192" data-ref="3_4618192" class="rating-label" name="RateItem_4618192"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4618192/Re-My-vote-of-5.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4618192"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4618192"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4614025_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4614025xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4614025" parent="0" thread="4614025" href="https://www.codeproject.com/Messages/4614025/Well-done.aspx">Well done</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Espen Harlinn</span><span class="date">17-Jul-13  6:56</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-mentor-16.gif" title="mentor" alt="mentor" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=22364">Espen Harlinn</a></span></td><td class="date"><span>17-Jul-13  6:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4614025_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="22364" msgid="4614025" votingtype="GoodOrBad" done="true"><a href="#xx4614025xx" onclick="return rateItem(5, 4614025,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',22364);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4614025xx" onclick="return rateItem(1, 4614025,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',22364);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Well done, I liked your presentation of the problem and how to solve it <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/thumbs_up.gif" alt="Thumbs Up | :thumbsup:" align="top"> <br>
<div class="signature"><a href="http://harlinn.com/" rel="nofollow noopener">Espen Harlinn</a><br>
Principal Architect, Software - <a href="http://goodtech.no/" rel="nofollow noopener">Goodtech Projects &amp; Services AS</a><br>
<em><br>
Projects promoting programming in "natural language" are intrinsically doomed to fail. <b>Edsger W.Dijkstra</b></em></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4614025&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4614025&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4614025" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4614025" data-ref="3_4614025" class="rating-label" name="RateItem_4614025"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4614025/Well-done.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4614025"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="22364" msgid="4614025"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4611856_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="20px"><a name="xx4611856xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4611856" parent="0" thread="4611856" href="https://www.codeproject.com/Messages/4611856/Many-Thx.aspx">Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">.dan.g.</span><span class="date">15-Jul-13  4:05</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=17355">.dan.g.</a></span></td><td class="date"><span>15-Jul-13  4:05&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4611856_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="17355" msgid="4611856" votingtype="GoodOrBad" done="true"><a href="#xx4611856xx" onclick="return rateItem(5, 4611856,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4611856xx" onclick="return rateItem(1, 4611856,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2">Hi Martin<br>
<br>
I'm very much looking forward to trying out your mCtrl Chart component in <a href="http://www.codeproject.com/Articles/5371/ToDoList-6-7-Feature-Release-An-effective-and-flex" rel="nofollow noopener">ToDoList</a>[<a href="http://www.codeproject.com/Articles/5371/ToDoList-6-7-Feature-Release-An-effective-and-flex" target="_blank" title="New Window" rel="nofollow noopener">^</a>].<br>
<div class="signature">.dan.g.<br>
<br>
<a href="http://www.abstractspoon.com/" rel="nofollow noopener"><b>Abstract</b><i>Spoon</i> Software</a><br>email: abstractspoon2(at)optusnet(dot)com(dot)au<br></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4611856&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4611856&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4611856" data-ref="3_4611856" class="rating-label" name="RateItem_4611856"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4611856/Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4611856"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="17355" msgid="4611856"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4611908_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="38px"><a name="xx4611908xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4611908" parent="4611856" thread="4611856" href="https://www.codeproject.com/Messages/4611908/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">15-Jul-13  5:00</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>15-Jul-13  5:00&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4611908_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5807385" msgid="4611908" votingtype="GoodOrBad" done="true"><a href="#xx4611908xx" onclick="return rateItem(5, 4611908,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4611908xx" onclick="return rateItem(1, 4611908,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4611856);" href="https://www.codeproject.com/Messages/4611856/Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Ok. Let me know if you encounter any problems with it.<br>
<br>
Martin<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4611908&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4611908&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4611908" data-ref="3_4611908" class="rating-label" name="RateItem_4611908"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4611908/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4611908"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4611908"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650271_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="56px"><a name="xx4650271xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4650271" parent="4611908" thread="4611856" href="https://www.codeproject.com/Messages/4650271/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">.dan.g.</span><span class="date">2-Sep-13  4:11</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=17355">.dan.g.</a></span></td><td class="date"><span>2-Sep-13  4:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650271_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="17355" msgid="4650271" votingtype="GoodOrBad" done="true"><a href="#xx4650271xx" onclick="return rateItem(5, 4650271,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4650271xx" onclick="return rateItem(1, 4650271,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4611908);" href="https://www.codeproject.com/Messages/4611908/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi Martin<br>
<br>
I'm trying to use the lib/dll combination in a VC6 dialog application 
because I want to write a class wrapper around the chart component.<br>
<br>
However, I'm running into this link error:<br>
<div class="pre-action-link" id="premain467809" style="width:100%;display:block;"><span id="prehide467809" onclick="processCodeBlocks.togglePre(467809);">Hide</span>  &nbsp; <span id="preShrink467809" onclick="processCodeBlocks.shrinkExpand(467809);">Shrink</span> <img id="preimg467809" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(467809);">  &nbsp; <span id="copycode467809" onclick="return processCodeBlocks.copyCode(467809);">Copy Code</span></div><pre id="pre467809" style="margin-top: 0px;" class="notranslate">--------------------Configuration: ChartWrapper - Win32 Debug--------------------
Linking...
ChartWrapper.obj : error LNK2001: unresolved external symbol _mcChart_Terminate@0
ChartWrapper.obj : error LNK2001: unresolved external symbol _mcChart_Initialize@0
Debug/ChartWrapper.exe : fatal error LNK1120: 2 unresolved externals
Error executing link.exe.

ChartWrapper.exe - 3 error(s), 0 warning(s)</pre><br>
which suggests to me that the <code>#ifdef __cplusplus ... extern "C" ...</code> macros are not working for me, but I can't see why.<br>
<br>
Any suggestions?<br>
<div class="signature">.dan.g.<br>
<br>
<a href="http://www.abstractspoon.com/" rel="nofollow noopener"><b>Abstract</b><i>Spoon</i> Software</a><br>email: abstractspoon2(at)optusnet(dot)com(dot)au<br></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650271&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650271&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4650271" data-ref="3_4650271" class="rating-label" name="RateItem_4650271"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4650271/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4650271"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="17355" msgid="4650271"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650340_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="74px"><a name="xx4650340xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4650340" parent="4650271" thread="4611856" href="https://www.codeproject.com/Messages/4650340/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">2-Sep-13  5:26</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>2-Sep-13  5:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650340_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="5807385" msgid="4650340" votingtype="GoodOrBad" done="true"><a href="#xx4650340xx" onclick="return rateItem(5, 4650340,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4650340xx" onclick="return rateItem(1, 4650340,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4650271);" href="https://www.codeproject.com/Messages/4650271/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>IMHO, it has nothing to do with C++ or the __cplusplus guards.<br>
<br>
First, small disclaimer, MSVC6 is kind of old, so I have not test with 
it. But if it behaves the same way as MSVC2010 in this regard, I can see
 two possible <br>
reasons of your issue:<br>
<br>
(1) You forgot to add the import lib (MCTRL.LIB) when linking your code. (much more likely)<br>
<br>
Solution: Ensure your project specifies MCTRL.LIB in its linker input and make sure it can find the lib on the disk.<br>
<br>
(2) You built MCTRL.DLL from sources in MSVC, and when linking your 
code, you are trying to use MCTRL.DLL from your build together with the 
import lib from the pre-built binary mCtrl release package. (much less 
likely)<br>
<br>
Solution: Use either both MCTRL.DLL and MCTRL.LIB from your build, or both from the pre-built package. Do not mix them.<br>
<br>
If neither is the culprit then, likely, it might be some compatibility 
issue with the old MSVC6 which I cannot solve as I do not have it. You 
might try to build MCTRL.DLL in the MSVC6 and see whether you will then 
have usable MCTRL.DLL and MCTRL.LIB, but that would likely require 
creating new project for it as I doubt MSVC6 can open MSVC2010 solution 
and project files present in the source mCtrl package.<br>
<br>
Hope this helps.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650340&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650340&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4650340" data-ref="3_4650340" class="rating-label" name="RateItem_4650340"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4650340/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4650340"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4650340"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650883_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx4650883xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4650883" parent="4650340" thread="4611856" href="https://www.codeproject.com/Messages/4650883/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">.dan.g.</span><span class="date">2-Sep-13  21:22</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=17355">.dan.g.</a></span></td><td class="date"><span>2-Sep-13  21:22&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650883_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="17355" msgid="4650883" votingtype="GoodOrBad" done="true"><a href="#xx4650883xx" onclick="return rateItem(5, 4650883,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4650883xx" onclick="return rateItem(1, 4650883,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4650340);" href="https://www.codeproject.com/Messages/4650340/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div><blockquote class="FQ"><div class="FQA">Martin Mitáš wrote:</div>But if it behaves the same way as MSVC2010 in this regard</blockquote>It does.<br>
<br>
<blockquote class="FQ"><div class="FQA">Martin Mitáš wrote:</div>You forgot to add the import lib (MCTRL.LIB) when linking your code. (much more likely)</blockquote>Double-checked, and it's set up correctly, because if I rename the lib then I get an error finding it.<br>
<br>
<blockquote class="FQ"><div class="FQA">Martin Mitáš wrote:</div>You built MCTRL.DLL from sources in MSVC</blockquote>I'm using the prebuilt version.<br>
<br>
ps. Did you ever specifically test the build system with MFC? Or do you know of anyone who did?<br>
pps. I also notice that you don't use <code>dllexport/dllimport</code> anywhere... which for me is unusual<br>
<div class="signature">.dan.g.<br>
<br>
<a href="http://www.abstractspoon.com/" rel="nofollow noopener"><b>Abstract</b><i>Spoon</i> Software</a><br>email: abstractspoon2(at)optusnet(dot)com(dot)au<br></div><br><br><div class="modified">modified  2-Sep-13 20:50pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650883&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650883&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4650883" data-ref="3_4650883" class="rating-label" name="RateItem_4650883"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4650883/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4650883"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="17355" msgid="4650883"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650905_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="92px"><a name="xx4650905xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4650905" parent="4650340" thread="4611856" href="https://www.codeproject.com/Messages/4650905/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">.dan.g.</span><span class="date">2-Sep-13  22:43</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-pro-16.png" title="professional" alt="professional" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=17355">.dan.g.</a></span></td><td class="date"><span>2-Sep-13  22:43&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4650905_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="17355" msgid="4650905" votingtype="GoodOrBad" done="true"><a href="#xx4650905xx" onclick="return rateItem(5, 4650905,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4650905xx" onclick="return rateItem(1, 4650905,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',17355);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4650340);" href="https://www.codeproject.com/Messages/4650340/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>All good Martin.<br>
<br>
I was able to fix it by removing the <code>MCTRL_API</code> from the function declaration.<br>
<div class="signature">.dan.g.<br>
<br>
<a href="http://www.abstractspoon.com/" rel="nofollow noopener"><b>Abstract</b><i>Spoon</i> Software</a><br>email: abstractspoon2(at)optusnet(dot)com(dot)au<br></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650905&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4650905&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4650905" data-ref="3_4650905" class="rating-label" name="RateItem_4650905"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4650905/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4650905"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="17355" msgid="4650905"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4651081_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="110px"><a name="xx4651081xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4651081" parent="4650905" thread="4611856" href="https://www.codeproject.com/Messages/4651081/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">3-Sep-13  4:54</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>3-Sep-13  4:54&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4651081_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:110px;"><span class="voteform vertical" ownerid="5807385" msgid="4651081" votingtype="GoodOrBad" done="true"><a href="#xx4651081xx" onclick="return rateItem(5, 4651081,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4651081xx" onclick="return rateItem(1, 4651081,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4650905);" href="https://www.codeproject.com/Messages/4650905/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div><blockquote class="FQ"><div class="FQA">.dan.g. wrote:</div>ps. Did you ever specifically test the build system with MFC? Or do you know of anyone who did?<br>
</blockquote> Never tested with MFC. <br>
<br>
<blockquote class="FQ"><div class="FQA">.dan.g. wrote:</div>pps. I also notice that you don't use <code>dllexport/dllimport</code> anywhere... which for me is unusual</blockquote> Instead of <code>dllexport</code>,
 I use *.def file. I do that to achieve exported symbols without the 
decorations (the underscore and @NN suffix). I do that for two reasons: 
(1) Std. API DLLs do that (e.g. USER32.DLL, COMCTL32.DLL etc.) and (2) 
it is easier in the run-time loading use case. Compare ugly <code>GetProcAddress(hModule, "_func@8")</code> and <code>GetProcAddress(hModule, "func")</code>. Furthermore, 64-bit builds never use decorations at all, so sources built both for 32 and 64bits would have to <code>#ifdef</code> that.<br>
<br>
AFAIK, <code>dllimport</code> is only syntactic sugar and does nothing (for functions, but MCTRL.DLL never exports data).<br>
<br>
<blockquote class="FQ"><div class="FQA">.dan.g. wrote:</div>I was able to fix it by removing the <code>MCTRL_API</code> from the function declaration.</blockquote> <code>MCTRL_API</code> just resolves to <code>__stdcall</code>. I don't think removing is correct fix as you now use cdecl calling convention. See <a href="http://stackoverflow.com/questions/3404372/stdcall-and-cdecl" rel="nofollow noopener">http://stackoverflow.com/questions/3404372/stdcall-and-cdecl</a>[<a href="http://stackoverflow.com/questions/3404372/stdcall-and-cdecl" target="_blank" title="New Window" rel="nofollow noopener">^</a>]. Here, it perhaps does not matter as the functions <code>mcChart_Initialize()</code> and <code>mcChart_Terminate()</code> do not take any arguments.<br>
<br>
I'm afraid the culprit will be in the way how I create import lib for 
the pre-built packages and (less tolerant) linker in MSVC6. I'll try to 
look at it.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4651081&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4651081&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4651081" data-ref="3_4651081" class="rating-label" name="RateItem_4651081"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4651081/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4651081"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4651081"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4652673_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td class="indent" width="120px"><a name="xx4652673xx"></a><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" title="General" width="16px" height="16px" align="top"></td><td class="subject hover-container"><a class="message-link" name="4652673" parent="4651081" thread="4611856" href="https://www.codeproject.com/Messages/4652673/Re-Many-Thx.aspx">Re: Many Thx</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/pin.png" alt="Pin" width="13px" height="13px" border="0" align="top"></a><div class="mobile-only">
	<span class="author">Martin Mitáš</span><span class="date">4-Sep-13  16:18</span>
</div></td><td class="icon"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px" border="0"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5807385">Martin Mitáš</a></span></td><td class="date"><span>4-Sep-13  16:18&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4652673_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr valign="top">
<td class="indent align-right" style="width:120px;"><span class="voteform vertical" ownerid="5807385" msgid="4652673" votingtype="GoodOrBad" done="true"><a href="#xx4652673xx" onclick="return rateItem(5, 4652673,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/upvote16.png" alt="upvote" title="upvote" width="16px" height="16px" border="0" align="absmiddle"></a>
<br><a href="#xx4652673xx" onclick="return rateItem(1, 4652673,3,0, false, true, 0, 'TextOnly', 'GoodOrBad',5807385);" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/downvote16.png" alt="downvote" title="downvote" width="16px" height="16px" border="0" align="absmiddle"></a>
</span></td><td class="text"><table width="100%" cellspacing="5px" cellpadding="0" border="0">
<tbody><tr>
<td><table width="100%" cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4651081);" href="https://www.codeproject.com/Messages/4651081/Re-Many-Thx.aspx"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Confirmed.<br>
<br>
The pre-built package is built with gcc (mingw-w64 project), and the 
import lib for MSVC is made with lib.exe from MS Visual Studio 2010 
Express. It does work with MSVC 2010 projects correctly but in MSVC 6 it
 fails with errors you said.<br>
<br>
As a workaround you may build mCtrl yourself in MS Visual Studio 2010 
Express (free, but 32-bit only though) and use the resulted mctrl.dll + 
mCtrl.lib. Just open mCtrl/contrib/msvc2010/mCtrl.sln in the source 
package, select config (debug or release) and build. According to my 
tests, the import lib created this way then works in MSVC 6. <br>
<br>
I will try a bit if I can create the import lib to be more compatible in
 next releases in the prebuilt package but honestly: I do not plan 
spending much effort on this due the old age of the MSVC6...<br>
<br>
<b>UPDATE</b>: mCtrl 0.9.5 has been released. I believe the import lib in the pre-built package is now compatible with VS6.<br><br><div class="modified">modified  6-Sep-13 11:51am.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a class="new-message" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4652673&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=r" title="Reply" rel="nofollow noopener">Reply</a>·<wbr><a class="nav-link" href="https://www.codeproject.com/script/Forums/Edit.aspx?fid=1836867&amp;select=4652673&amp;floc=/Articles/617212/Custom-Controls-in-Win-API-The-Painting&amp;action=e" title="Send the author a private email" rel="nofollow noopener">Email</a>·<wbr><a href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4611856" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span id="MVF4652673" data-ref="3_4652673" class="rating-label" name="RateItem_4652673"><span class="rating-result"><span></span></span></span><a href="https://www.codeproject.com/Messages/4652673/Re-Many-Thx.aspx" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span data-type="bookmark" data-size="small" data-ref="3_4652673"><span data-direction="up-right" title="" data-enabletooltip="true" data-tooltip="bookmark this" class="tooltip"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/bookmark32.png" style="width:16px;height:16px;border:none;cursor:pointer;"><div class="speech-bubble-container-up-right" style="width:150px">  <div class="speech-bubble-up-right" style="text-align:center"> bookmark this</div>  <div class="speech-bubble-pointer-up-right">    <div class="speech-bubble-pointer-up-right-inner"></div>  </div></div></span></span>&nbsp;<span class="reportform" ownerid="5807385" msgid="4652673"></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellspacing="0" cellpadding="2px">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 3-Dec-19  18:57 &nbsp; &nbsp; Last Update: 3-Dec-19  19:03</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/617212/Custom-Controls-in-Win-API-The-Painting?fid=1836867&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=25"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_general.gif" alt="General" width="16px" height="16px" align="top"> General &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_news.gif" alt="News" width="16px" height="16px" align="top"> News &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" width="16px" height="16px" align="top"> Suggestion &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_question.gif" alt="Question" width="16px" height="16px" align="top"> Question &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_bug.gif" alt="Bug" width="16px" height="16px" align="top"> Bug &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_answer.gif" alt="Answer" width="16px" height="16px" align="top"> Answer &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_joke.gif" alt="Joke" width="16px" height="16px" align="top"> Joke &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" width="16px" height="16px" align="top"> Praise &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_rant.gif" alt="Rant" width="16px" height="16px" align="top"> Rant &nbsp;&nbsp; <img src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/msg_admin.gif" alt="Admin" width="16px" height="16px" align="top"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=617212">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=617212">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=617212">Revisions (25)</a></div>
<div><a href="#_comments">Comments (24)</a></div>
<div>Posted 14 Jul 2013</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win32" data-id="99">Win32</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Win64" data-id="100">Win64</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/VS2010" data-id="314">VS2010</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div><div class="t tooltip" data-followinit="true" data-enabletooltip="true" data-tooltip="Click the star to follow this tag" data-width="125px" title=""><img class="follow" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/follow.png" width="12px" height="12px"><a rel="tag" href="https://www.codeproject.com/Tags/custom-controls" data-id="781">custom-controls</a><div class="speech-bubble-container-up" style="width:125px">  <div class="speech-bubble-up" style="text-align:center"> Click the star to follow this tag</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>76.7K views</div><div>2.6K downloads</div><div>106 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

                <div id="RHSticky" class="container-article-info-sticky">
        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-showindicator="true" data-tags="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=383021"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x200&c=383021"  width="160px" height="200px" target="_blank"/></a></noscript><div style="height: 0px; width: 0px; box-sizing: border-box; border: 0px none; font-size: 0px; display: none;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-4" data-google-query-id="CM-viKDLmuYCFQFTwQodU-MI6g"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_1__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Windows-API/General" data-country="US" data-tags="C, Windows, Win32, Win64, Visual-Studio, Dev, VS2010, custom-controls,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=383021"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General&sz=160x600&c=383021"  width="160px" height="600px" target="_blank"/></a></noscript><div style="height: 600px; width: 160px; box-sizing: border-box; border: 0px none; font-size: 0px;" id="div-gpt-ad-lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General-5" data-google-query-id="CNPPiKDLmuYCFYNqwQodU1sKzQ"><div id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Windows-API/General_2" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" data-google-container-id="3" data-load-complete="true" width="160" height="600" frameborder="0"></iframe></div></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/617212/Custom-Controls-in-Win-API-The-Painting?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2013 by Martin Mitáš<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2019 <br>
                <br>
				Web04 
				2.8.191122.1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="Custom%20Controls%20in%20Win32%20API%20%20The%20Painting%20-%20CodeProject_files/DFPAudiencePixel.gif" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

var readLaterList

var notificationAlert

var followService_ctl00_ActionLinks_ArticleFollow;

var bookmark_medium_true_false_ = null;

function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 617212,2,1,true,true,0,'LargeStars', null, 5807385);
}

function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                        if (!$('#' + containerId).attr('alreadyRequested')){
                            $.ajax({
                                url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId+'&wd=130',
                            })
                            .done(function (data) {
                                $('#' + containerId).html(data);
                                $('#' + loadingId).hide();
                            });

                            $('#' + containerId).attr('alreadyRequested', 'true');
                        }
                    }

document.addEventListener('DOMContentLoaded', function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(val) {
}

var followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1836867,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	processCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	readLaterList = new ReadLaterList('ReadLaterListIcon', 'ItemsToRead','/script/Bookmarks/WebServices/BookmarkService.aspx','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=small',true);
	readLaterList.initialise();
	
	notificationAlert = new NotificationAlert('ctl00_MemberBar_Messages_NotificationCount','Notifications','/script/Membership/Ajax/NotificationList.aspx');
	notificationAlert.initialise();
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	followService_ctl00_ActionLinks_ArticleFollow = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_ActionLinks_ArticleFollow.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 2,
	        objectId       : 617212
	    },
	    followButtonId   : 'ctl00_ActionLinks_ArticleFollow_FollowBtn',
	    unfollowButtonId : 'ctl00_ActionLinks_ArticleFollow_UnfollowBtn'
	}, false);
	
	bookmark_medium_true_false_ = new Bookmark('[data-type="bookmark"]','https://www.codeproject.com/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false,true);
	bookmark_medium_true_false_.Initialise();
	
	$('#clear-rate_ctl00_RateArticle_RCD').click(function () {    $('#ctl00_RateArticle_RCD').hide(); return false;});
	
	new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
	  $('#ctl00_RateArticle_VR').mouseenter(function() {     getVotesHistogram(617212,2   ,'ctl00_RateArticle_HistogramR','ctl00_RateArticle_LoadingR');
	  });
	
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	followService_ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember.initFollowObjectButtons({
	    item : { 
	        objectTypeId   : 1,
	        objectId       : 5807385
	    },
	    followButtonId   : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_FollowBtn',
	    unfollowButtonId : 'ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowMember_UnfollowBtn'
	}, false);
	
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : false,
	    allowReporting      : false,
	    allowRating         : true,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    getVoteFormMethod   : getVoteFormHtml,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
	    getRatingRefKey     : 'obrs',
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl(forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	var followService = new FollowService('/script/follow/webservices/followServices.aspx/', true);
	var followAttributeIds = [];
	followService.initAttributeUI(undefined, followAttributeIds);

})
</script>










<style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>